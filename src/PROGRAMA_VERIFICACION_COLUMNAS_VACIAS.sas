

PROC SQL;
CREATE TABLE REVISA AS SELECT CHIP, CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
PUNTAJE, EDAD, CODIGO_USOP, AREA_USO, MARCA_MANZANA, MODELO_0, VALOR_UNITARIO_&VIGENCIA., AREA_USO_TABLAS
FROM COMUN.PREDIO_Y_UM_FINAL_211112
WHERE MODELO_0 IN ("T01-1", "T01-2", "T01-3", "T01-4", "T01-5", "T01-6", "T01-7", "T01-8", "T03", "T04", "T06", "T19",
"T02-1", "T02-2", "T02-3", "T02-4", "T03", "T04", "T05-1", "T05-2", "T05-3", "T05-4") AND  VALOR_UNITARIO_&VIGENCIA. = .;
QUIT;


PROC SQL;
CREATE TABLE REVISA_COORDENADA_X AS SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, COORDENADA_X
FROM COMUN.PREDIO_Y_UM_FINAL_211112
WHERE MODELO_0 IN ("M01_1", "M01_2", "M01_3", "M02_4", "M02_5", "M02_6", "M03", "M04", "M05", "M06_123", "M06_456") 
AND COORDENADA_X = .;
QUIT;


PROC SQL;
CREATE TABLE REVISA_COORDENADA_Y AS SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, COORDENADA_Y
FROM COMUN.PREDIO_Y_UM_FINAL_211112
WHERE MODELO_0 IN ("M01_1", "M01_2", "M01_3", "M02_4", "M02_5", "M02_6", "M03", "M04", "M05", "M06_123", "M06_456") 
AND COORDENADA_Y = .;
QUIT;

DATA REVISA_3;
SET REVISA_2;
IF MODELO_0 = "M06_456";
KEEP &VARIABLE_M06_456;
RUN;

%PUT &VARIABLE_M02_4;

PROC EXPORT DATA = REVISA_COORDENADA_X
OUTFILE = "&RUTA.\output\LOTES_COORDENADAS_VACIAS.xlsx" 
DBMS = XLSX REPLACE;
SHEET = "LOTES_COORDENADA_X"; 
RUN;

PROC EXPORT DATA = REVISA_COORDENADA_Y
OUTFILE = "&RUTA.\output\LOTES_COORDENADAS_VACIAS.xlsx" 
DBMS = XLSX REPLACE;
SHEET = "LOTES_COORDENADA_Y"; 
RUN;
