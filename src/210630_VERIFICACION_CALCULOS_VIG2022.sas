*LIBNAME PRUEBA "\\prowin02\omartinezm\SASFILES\Verificacion Calculos";
*LIBNAME PRUEBA "\\prowin02\lcarrillo\SASFILES\Laura\VERIFICACION_CALCULOS";
*LIBNAME PRUEBA "\\prowin02\bcamargo\SASFILES\Verificacion_Calculos_2020";
*LIBNAME MUESTRA '\\prowin02\omartinezm\SASFILES\Puntos_Muestra_2017';
/*proc printto log="\\prowin02\dospina\SASFILES\SASLog\EG.log"; RUN;*/


/*CREACION DE LIBRERIAS NECESARIAS*/
%let _timer_start = %sysfunc(datetime());
%LET RUTA = \\prowin04\cavellaneda\EJERCICIOS\EJERCICIOS 2021\VERIFICACION_CALCULOS;
LIBNAME PRUEBA "\\prowin04\cavellaneda\EJERCICIOS\EJERCICIOS 2021\VERIFICACION_CALCULOS";
*%INCLUDE "//prowin04/cavellaneda/EJERCICIOS/EJERCICIOS 2021/VERIFICACION_CALCULOS/MACRO_USOP.SAS";

/*USO PREDOMINANTE*/
%MACRO USOP(VISTA_ANO, PREDIO_ANO,PREDIO_USO_ANO,CODIGO_USOP_ANO);/*VISTA_ANO=BASE CON VISTA CALIFICACION DEL AÑO CORRESPONDIETE,
 
/* EXTRACCIÓN DEL USO DE LA BASE VISTA_CALIFICACIÓN */
PROC SQL;
	CREATE TABLE USOS_VISTA AS
 	SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, 
		  CODIGO_CONSTRUCCION, CODIGO_RESTO, 
		  UNIDAD_CALIFICADA, CODIGO_USO, AREA_USO, CLASE_CONSTRUCCION, PUNTAJE
     FROM &VISTA_ANO;
QUIT; 

/* SE CREA UNA BASE CON LA SUMA DE AREA DE USO POR PREDIO-USO */
PROC SQL;
	CREATE TABLE PREDIOUSO AS SELECT *, ROUND(SUM(AREA_USO),0.01) AS SUM_USO
	FROM USOS_VISTA
	GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, 
		    CODIGO_CONSTRUCCION, CODIGO_RESTO, CODIGO_USO;
QUIT;
 
/* SE CREA TABLA CON LA MODA DEL USO A NIVEL DE PREDIOS 

  (en caso de empates se selecciona  en orden 
   CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO
   SUM_USO, UNIDAD_CALIFICADA, DESCENDING CLASE_CONSTRUCCION,  DESCENDING PUNTAJE, CODIGO_USO)
*/
PROC SQL;
     CREATE TABLE PREDIOSU AS
     SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, 
				 CODIGO_CONSTRUCCION, CODIGO_RESTO, CODIGO_USO, SUM_USO, UNIDAD_CALIFICADA, CLASE_CONSTRUCCION, PUNTAJE,
				 MAX(SUM_USO) AS MAX_PRED_USO
     FROM PREDIOUSO 
     GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, 
		    CODIGO_CONSTRUCCION, CODIGO_RESTO 
     HAVING SUM_USO = MAX_PRED_USO;
QUIT;


PROC SORT DATA = PREDIOSU OUT = PREDIOSU1;
by CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO
   SUM_USO UNIDAD_CALIFICADA DESCENDING CLASE_CONSTRUCCION  DESCENDING PUNTAJE CODIGO_USO;RUN;


/*******************************************************/
 

/*SE ELIMINAN DUPLICADOS POR PREDIO*/
PROC SORT DATA = PREDIOSU1 OUT = PREDIOS_UP NODUPKEY dupout=PREDIOSDUPLI1;
     BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO;
RUN; 
 
/* PEGADO DEL USO PREDOMINANTE A LA BASE DE PREDIOS */
PROC SQL;
	CREATE TABLE &PREDIO_USO_ANO AS 
	SELECT A.*, B.CODIGO_USO AS &CODIGO_USOP_ANO
	FROM &PREDIO_ANO AS A LEFT JOIN PREDIOS_UP AS B 
	ON A.CODIGO_BARRIO=B.CODIGO_BARRIO AND A.CODIGO_MANZANA=B.CODIGO_MANZANA AND
	   A.CODIGO_PREDIO=B.CODIGO_PREDIO AND A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION AND 
	   A.CODIGO_RESTO=B.CODIGO_RESTO;
QUIT;
 
PROC SQL; DROP TABLE USOS_VISTA; QUIT;
PROC SQL; DROP TABLE PREDIOUSO; QUIT;
PROC SQL; DROP TABLE PrediosU; QUIT;
/*PROC SQL; DROP TABLE Predios_UP; QUIT;*/
 
%MEND USOP;


%LET FECHA_CORTE = 211119;
%LET VIGENCIA = 2022;
%LET VIGENCIA_2 = 22;
%LET YEAR = &VIGENCIA. - 1;
%LET VIGENCIA_ANT = %sysevalf(&VIGENCIA.-1);
%LET VIGENCIA_ANT_2 = %sysevalf(&VIGENCIA_2.-1);
%LET VIGENCIA_ANT_ANT = %sysevalf(&VIGENCIA.-2);
%LET VIGENCIA_ANT_ANT_2 = %sysevalf(&VIGENCIA_2.-2);


DATA COMUN.PREDIO_&FECHA_CORTE.; 
SET ODBCLIB.PREDIO;
IF CODIGO_DESTINO = '99' THEN delete;
IF MARCA_FORMACION = 'S' THEN delete;
RUN;

PROC SQL;   CREATE TABLE COMUN.VISTA_CALIFICACION_&FECHA_CORTE. AS	
		SELECT A.*, B.CODIGO_DESTINO, B.MARCA_FORMACION
		FROM  ODBCLIB.VISTA_CALIFICACION AS A
		INNER JOIN (SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, 
		CODIGO_DESTINO, MARCA_FORMACION
         FROM COMUN.PREDIO_&FECHA_CORTE.) AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO;
QUIT;


/* Modicar edad de acuerdo a la vigencia en curso */
PROC SQL;   CREATE TABLE TEMP1_BASE_CALCULOS AS	
		SELECT B.*, A.*,
		CASE WHEN (&VIGENCIA. - A.VETUSTEZ) = 0 THEN 1 ELSE (&VIGENCIA. - A.VETUSTEZ) END AS EDAD
			FROM  COMUN.PREDIO_&FECHA_CORTE. AS B LEFT JOIN COMUN.VISTA_CALIFICACION_&FECHA_CORTE. AS A
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO
			ORDER BY A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, A.CODIGO_CONSTRUCCION, A.CODIGO_RESTO,
			A.CODIGO_USO, A.UNIDAD_CALIFICADA;
QUIT;



/*Cálculo del número de unidades calificadas por cada predio*/

/*Cálculo del número de usos por cada predio*/
PROC SQL;	CREATE TABLE TEMP1_NUM_USOS AS  /*Cálculo del número de usos por cada predio*/
		SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
		CODIGO_USO
			FROM COMUN.VISTA_CALIFICACION_&FECHA_CORTE.
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, CODIGO_USO;
QUIT;


/*Agrega información de número de unidades calificadas y número de usos distintos por predio*/
PROC SQL;	CREATE TABLE TEMP1_BASE_CALCULOS AS /*Agrega información de número de unidades calificadas y número de usos distintos por predio*/
		SELECT A.*, B.NUMERO_UNIDADES, B.SUMA_PUNTAJE, C.NUM_USOS, 
		D.CODIGO_LOCALIDAD, D.NOMBRE_BARRIO
			FROM TEMP1_BASE_CALCULOS AS A 
            LEFT JOIN 	
              (SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
			COUNT(*) AS NUMERO_UNIDADES, SUM(PUNTAJE) AS SUMA_PUNTAJE
			FROM COMUN.VISTA_CALIFICACION_&FECHA_CORTE.
				GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO) AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO
			LEFT JOIN 
			(SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
			COUNT(*) AS NUM_USOS FROM TEMP1_NUM_USOS
			GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO)
			AS C
				ON	A.CODIGO_BARRIO = C.CODIGO_BARRIO &
					A.CODIGO_MANZANA = C.CODIGO_MANZANA &
					A.CODIGO_PREDIO = C.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = C.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = C.CODIGO_RESTO
			LEFT JOIN ODBCLIB.BARRIO AS D 
				ON A.CODIGO_BARRIO = D.CODIGO_BARRIO;
QUIT;


/*
proc import datafile = "&RUTA.\Verificacion_calculos\input\PUNTOS_MUESTRA_ASIGNACION_INCORRECTA_MODELO.xlsx"
 out  =  PM_ESTRATO_INCORRECTO
 dbms  =  xlsx
 replace;
 sheet  =  "Hoja2";
run;


PROC SQL;
CREATE TABLE TEMP1_BASE_CALCULOS AS SELECT
A.*, D.PM_ESTRATO_INCORRECTO
FROM TEMP1_BASE_CALCULOS AS A 
LEFT JOIN 
(SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO,
CODIGO_CONSTRUCCION, CODIGO_RESTO, 1 AS PM_ESTRATO_INCORRECTO FROM PM_ESTRATO_INCORRECTO) AS D
ON A.CODIGO_BARRIO = D.CODIGO_BARRIO AND
A.CODIGO_MANZANA = D.CODIGO_MANZANA AND
A.CODIGO_PREDIO = D.CODIGO_PREDIO AND 
A.CODIGO_CONSTRUCCION = D.CODIGO_CONSTRUCCION AND 
A.CODIGO_RESTO = D.CODIGO_RESTO;
QUIT;


DATA TEMP1_BASE_CALCULOS;
SET TEMP1_BASE_CALCULOS;
IF PM_ESTRATO_INCORRECTO = 1 THEN CODIGO_ESTRATO = 5;
RUN;
*/
/*************************************************************************************************/
/* SE IMPUTA EL ESTRATO PARA PREDIOS RESIDENCIALES POR ESTRATO MODAL POR MANZANA, SECTOR O LOCALIDAD A PARTIR DE COMUN.PREDIO_&FECHA_CORTE.*/
/*************************************************************************************************/

/*Se crea una base de predios con la información de localidad, barrio, manzana, predio y estrato*/

PROC SQL;	CREATE TABLE TEMP1_ESTRATO AS  /*Genera base de moda del estrato (manzana, barrio, localidad) a partir de la base COMUN.PREDIO_&FECHA_CORTE.*/
		SELECT B.CODIGO_LOCALIDAD, A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, A.CODIGO_ESTRATO,
		A.MARCA_FORMACION, A.CODIGO_DESTINO
			FROM COMUN.PREDIO_&FECHA_CORTE. AS A LEFT JOIN ODBCLIB.BARRIO AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO
			WHERE	SUBSTR(A.CODIGO_BARRIO,1,1) = '0' & 
					A.CODIGO_ESTRATO IN (1,2,3,4,5,6) &
					(A.MARCA_FORMACION IN ('A','B','C','D','E','F','G','N') | A.MARCA_FORMACION IS NULL) &
					A.CODIGO_DESTINO NOT IN ('99')
			ORDER BY CODIGO_LOCALIDAD, A.CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_ESTRATO;
QUIT;


/*Se crea una tabla con el conteo de predios por estrato a nivel de manzana*/
PROC SQL;	CREATE TABLE TEMP2_ESTRATO AS
		SELECT DISTINCT CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_ESTRATO,
		COUNT(*) AS PREDIOS_ESTRATO_MANZANA
			FROM TEMP1_ESTRATO
			GROUP BY CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_ESTRATO
			ORDER BY CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_ESTRATO;
QUIT;


/*Se crea una tabla con el conteo de predios por estrato a nivel de barrio*/
PROC SQL;	CREATE TABLE TEMP3_ESTRATO AS
		SELECT DISTINCT CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_ESTRATO, COUNT(*) AS PREDIOS_ESTRATO_BARRIO
			FROM TEMP1_ESTRATO
			GROUP BY CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_ESTRATO
			ORDER BY CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_ESTRATO;
QUIT;


/*Se crea una tabla con el conteo de predios por estrato a nivel de localidad*/
PROC SQL;	CREATE TABLE TEMP4_ESTRATO AS
		SELECT DISTINCT CODIGO_LOCALIDAD, CODIGO_ESTRATO, COUNT(*) AS PREDIOS_ESTRATO_LOCALIDAD
			FROM TEMP1_ESTRATO
			GROUP BY CODIGO_LOCALIDAD, CODIGO_ESTRATO
			ORDER BY CODIGO_LOCALIDAD, CODIGO_ESTRATO;
QUIT;


/*Se crea una tabla con la moda del estrato a nivel de manzana (en caso de empates se selecciona el menor estrato)*/
PROC SQL;	CREATE TABLE PRUEBA.MODA_ESTRATO_MANZANA AS
		SELECT DISTINCT CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_ESTRATO,
		MAX(PREDIOS_ESTRATO_MANZANA) AS MAX_PRED_ESTRATO_MANZANA
			FROM TEMP2_ESTRATO
			GROUP BY CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_MANZANA
			HAVING PREDIOS_ESTRATO_MANZANA = MAX_PRED_ESTRATO_MANZANA
			ORDER BY CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_ESTRATO;
QUIT;


PROC SORT
	DATA = PRUEBA.MODA_ESTRATO_MANZANA
	OUT = PRUEBA.MODA_ESTRATO_MANZANA NODUPKEY;
	BY CODIGO_LOCALIDAD CODIGO_BARRIO CODIGO_MANZANA;
RUN;

/*Se crea una tabla con la moda del estrato a nivel de barrio (en caso de empates se selecciona el menor estrato)*/
PROC SQL;	CREATE TABLE PRUEBA.MODA_ESTRATO_BARRIO AS
		SELECT DISTINCT CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_ESTRATO, MAX(PREDIOS_ESTRATO_BARRIO) AS
		MAX_PRED_ESTRATO_BARRIO
			FROM TEMP3_ESTRATO
			GROUP BY CODIGO_LOCALIDAD, CODIGO_BARRIO
			HAVING PREDIOS_ESTRATO_BARRIO = MAX_PRED_ESTRATO_BARRIO
			ORDER BY CODIGO_LOCALIDAD, CODIGO_BARRIO, CODIGO_ESTRATO;
QUIT;

PROC SORT
	DATA = PRUEBA.MODA_ESTRATO_BARRIO
	OUT = PRUEBA.MODA_ESTRATO_BARRIO NODUPKEY;
	BY CODIGO_LOCALIDAD CODIGO_BARRIO;
RUN;

/*Se crea una tabla con la moda del estrato a nivel de localidad (en caso de empates se selecciona el menor estrato)*/
PROC SQL;	CREATE TABLE PRUEBA.MODA_ESTRATO_LOCALIDAD AS
		SELECT DISTINCT CODIGO_LOCALIDAD, CODIGO_ESTRATO, MAX(PREDIOS_ESTRATO_LOCALIDAD) AS
		MAX_PRED_ESTRATO_LOCALIDAD
			FROM TEMP4_ESTRATO
			GROUP BY CODIGO_LOCALIDAD
			HAVING PREDIOS_ESTRATO_LOCALIDAD = MAX_PRED_ESTRATO_LOCALIDAD
			ORDER BY CODIGO_LOCALIDAD, CODIGO_ESTRATO;
QUIT;

PROC SORT
	DATA = PRUEBA.MODA_ESTRATO_LOCALIDAD
	OUT = PRUEBA.MODA_ESTRATO_LOCALIDAD NODUPKEY;
	BY CODIGO_LOCALIDAD;
RUN;


/***********************************************************************/
/* Imputa el código de estrato a los usos residenciales que no lo tienen */
/***********************************************************************/

/***********************************************************************/
/*Pega la moda del estrato a nivel de manzana*/
/***********************************************************************/
DATA MODA_ESTRATO_MANZANA; SET PRUEBA.MODA_ESTRATO_MANZANA;
CODIGO_ESTRATO_MANZ = CODIGO_ESTRATO;
KEEP CODIGO_LOCALIDAD CODIGO_BARRIO CODIGO_MANZANA CODIGO_ESTRATO_MANZ; RUN;


PROC SORT DATA = TEMP1_BASE_CALCULOS; BY CODIGO_LOCALIDAD CODIGO_BARRIO CODIGO_MANZANA;
PROC SORT DATA = MODA_ESTRATO_MANZANA; BY CODIGO_LOCALIDAD CODIGO_BARRIO CODIGO_MANZANA;

DATA TEMP1_BASE_CALCULOS; MERGE TEMP1_BASE_CALCULOS (IN = A1) MODA_ESTRATO_MANZANA (IN = A2); 
BY CODIGO_LOCALIDAD CODIGO_BARRIO CODIGO_MANZANA; IF A1; RUN;

/***********************************************************************/
/*Pega la moda del estrato a nivel de BARRIO*/
/***********************************************************************/

DATA MODA_ESTRATO_BARRIO; SET PRUEBA.MODA_ESTRATO_BARRIO;
CODIGO_ESTRATO_BARRIO = CODIGO_ESTRATO;
KEEP CODIGO_LOCALIDAD CODIGO_BARRIO CODIGO_ESTRATO_BARRIO; RUN;

PROC SORT DATA=MODA_ESTRATO_BARRIO; BY CODIGO_LOCALIDAD CODIGO_BARRIO;

DATA TEMP1_BASE_CALCULOS; MERGE TEMP1_BASE_CALCULOS (IN = A1) MODA_ESTRATO_BARRIO (IN = A2); 
BY CODIGO_LOCALIDAD CODIGO_BARRIO; IF A1; RUN;

/***********************************************************************/
/*Pega la moda del estrato a nivel de LOCALIDAD*/
/***********************************************************************/

DATA MODA_ESTRATO_LOCALIDAD; SET PRUEBA.MODA_ESTRATO_LOCALIDAD;
CODIGO_ESTRATO_LOCAL = CODIGO_ESTRATO;
KEEP CODIGO_LOCALIDAD CODIGO_ESTRATO_LOCAL; RUN;

PROC SORT DATA = MODA_ESTRATO_LOCALIDAD; BY CODIGO_LOCALIDAD;

DATA TEMP1_BASE_CALCULOS; MERGE TEMP1_BASE_CALCULOS (IN = A1) MODA_ESTRATO_LOCALIDAD (IN = A2); 
BY CODIGO_LOCALIDAD; IF A1; 
COD_ESTR_ORIG = CODIGO_ESTRATO;
RUN;


DATA TEMP1_BASE_CALCULOS; 
SET TEMP1_BASE_CALCULOS; /*Imputación del estrato*/

IF ((CODIGO_USO IN ('001','002','009','019','037','038')) OR
(CODIGO_USO IN ('020','022') AND CLASE_PREDIO ='P')) AND COD_ESTR_ORIG IN (.,0) THEN 
 CODIGO_ESTRATO = CODIGO_ESTRATO_MANZ; ELSE CODIGO_ESTRATO = COD_ESTR_ORIG; 

IF ((CODIGO_USO IN ('001','002','009','019','037','038')) OR
(CODIGO_USO IN ('020','022') AND CLASE_PREDIO ='P')) AND COD_ESTR_ORIG IN (.,0) AND CODIGO_ESTRATO_MANZ IN (.,0)
       THEN CODIGO_ESTRATO = CODIGO_ESTRATO_BARRIO; else CODIGO_ESTRATO = CODIGO_ESTRATO;

IF ((CODIGO_USO IN ('001','002','009','019','037','038')) OR
(CODIGO_USO IN ('020','022') AND CLASE_PREDIO ='P')) AND COD_ESTR_ORIG IN (.,0) AND CODIGO_ESTRATO_MANZ IN (.,0) AND CODIGO_ESTRATO_BARRIO IN (.,0)
       THEN CODIGO_ESTRATO = CODIGO_ESTRATO_LOCAL; ELSE CODIGO_ESTRATO = CODIGO_ESTRATO;

LLAVE = COMPRESS(CODIGO_BARRIO||CODIGO_MANZANA||CODIGO_PREDIO||CODIGO_CONSTRUCCION||CODIGO_RESTO);
LOTE_ID = COMPRESS(CODIGO_BARRIO||"0"||CODIGO_MANZANA||"0"||CODIGO_PREDIO);
RUN;



/************************************************************************************************************/
/****************** EMPIEZA LA RUTINA PARA ARMAR LA BASE CREANDO TODAS LAS VARIABLES DUMMY ******************/
/************************************************************************************************************/

/************************************************************************************************************/
/* CREACIÓN DE VARIABLES DUMMY PARA LOS USOS */
/************************************************************************************************************/

PROC SQL; 	CREATE TABLE PREDIO_VISTA_PRODUCCION AS /* CREACIÓN DE VARIABLES DUMMY PARA LOS USOS */
		SELECT *, 
CASE WHEN CODIGO_USO = '001' THEN 1 ELSE 0 END AS D_USO_001,
CASE WHEN CODIGO_USO = '002' THEN 1 ELSE 0 END AS D_USO_002,
CASE WHEN CODIGO_USO = '003' THEN 1 ELSE 0 END AS D_USO_003,
CASE WHEN CODIGO_USO = '004' THEN 1 ELSE 0 END AS D_USO_004,
CASE WHEN CODIGO_USO = '005' THEN 1 ELSE 0 END AS D_USO_005,
CASE WHEN CODIGO_USO = '006' THEN 1 ELSE 0 END AS D_USO_006,
CASE WHEN CODIGO_USO = '007' THEN 1 ELSE 0 END AS D_USO_007,
CASE WHEN CODIGO_USO = '008' THEN 1 ELSE 0 END AS D_USO_008,
CASE WHEN CODIGO_USO = '009' THEN 1 ELSE 0 END AS D_USO_009,
CASE WHEN CODIGO_USO = '010' THEN 1 ELSE 0 END AS D_USO_010,
CASE WHEN CODIGO_USO = '011' THEN 1 ELSE 0 END AS D_USO_011,
CASE WHEN CODIGO_USO = '012' THEN 1 ELSE 0 END AS D_USO_012,
CASE WHEN CODIGO_USO = '013' THEN 1 ELSE 0 END AS D_USO_013,
CASE WHEN CODIGO_USO = '014' THEN 1 ELSE 0 END AS D_USO_014,
CASE WHEN CODIGO_USO = '015' THEN 1 ELSE 0 END AS D_USO_015,
CASE WHEN CODIGO_USO = '016' THEN 1 ELSE 0 END AS D_USO_016,
CASE WHEN CODIGO_USO = '017' THEN 1 ELSE 0 END AS D_USO_017,
CASE WHEN CODIGO_USO = '018' THEN 1 ELSE 0 END AS D_USO_018,
CASE WHEN CODIGO_USO = '019' THEN 1 ELSE 0 END AS D_USO_019,
CASE WHEN CODIGO_USO = '020' THEN 1 ELSE 0 END AS D_USO_020,
CASE WHEN CODIGO_USO = '021' THEN 1 ELSE 0 END AS D_USO_021,
CASE WHEN CODIGO_USO = '022' THEN 1 ELSE 0 END AS D_USO_022,
CASE WHEN CODIGO_USO = '023' THEN 1 ELSE 0 END AS D_USO_023,
CASE WHEN CODIGO_USO = '024' THEN 1 ELSE 0 END AS D_USO_024,
CASE WHEN CODIGO_USO = '025' THEN 1 ELSE 0 END AS D_USO_025,
CASE WHEN CODIGO_USO = '026' THEN 1 ELSE 0 END AS D_USO_026,
CASE WHEN CODIGO_USO = '027' THEN 1 ELSE 0 END AS D_USO_027,
CASE WHEN CODIGO_USO = '028' THEN 1 ELSE 0 END AS D_USO_028,
CASE WHEN CODIGO_USO = '029' THEN 1 ELSE 0 END AS D_USO_029,
CASE WHEN CODIGO_USO = '030' THEN 1 ELSE 0 END AS D_USO_030,
CASE WHEN CODIGO_USO = '031' THEN 1 ELSE 0 END AS D_USO_031,
CASE WHEN CODIGO_USO = '032' THEN 1 ELSE 0 END AS D_USO_032,
CASE WHEN CODIGO_USO = '033' THEN 1 ELSE 0 END AS D_USO_033,
CASE WHEN CODIGO_USO = '034' THEN 1 ELSE 0 END AS D_USO_034,
CASE WHEN CODIGO_USO = '035' THEN 1 ELSE 0 END AS D_USO_035,
CASE WHEN CODIGO_USO = '036' THEN 1 ELSE 0 END AS D_USO_036,
CASE WHEN CODIGO_USO = '037' THEN 1 ELSE 0 END AS D_USO_037,
CASE WHEN CODIGO_USO = '038' THEN 1 ELSE 0 END AS D_USO_038,
CASE WHEN CODIGO_USO = '039' THEN 1 ELSE 0 END AS D_USO_039,
CASE WHEN CODIGO_USO = '040' THEN 1 ELSE 0 END AS D_USO_040,
CASE WHEN CODIGO_USO = '041' THEN 1 ELSE 0 END AS D_USO_041,
CASE WHEN CODIGO_USO = '042' THEN 1 ELSE 0 END AS D_USO_042,
CASE WHEN CODIGO_USO = '043' THEN 1 ELSE 0 END AS D_USO_043,
CASE WHEN CODIGO_USO = '044' THEN 1 ELSE 0 END AS D_USO_044,
CASE WHEN CODIGO_USO = '045' THEN 1 ELSE 0 END AS D_USO_045,
CASE WHEN CODIGO_USO = '046' THEN 1 ELSE 0 END AS D_USO_046,
CASE WHEN CODIGO_USO = '047' THEN 1 ELSE 0 END AS D_USO_047,
CASE WHEN CODIGO_USO = '048' THEN 1 ELSE 0 END AS D_USO_048,
CASE WHEN CODIGO_USO = '049' THEN 1 ELSE 0 END AS D_USO_049,
CASE WHEN CODIGO_USO = '050' THEN 1 ELSE 0 END AS D_USO_050,
CASE WHEN CODIGO_USO = '051' THEN 1 ELSE 0 END AS D_USO_051,
CASE WHEN CODIGO_USO = '052' THEN 1 ELSE 0 END AS D_USO_052,
CASE WHEN CODIGO_USO = '053' THEN 1 ELSE 0 END AS D_USO_053,
CASE WHEN CODIGO_USO = '055' THEN 1 ELSE 0 END AS D_USO_055,
CASE WHEN CODIGO_USO = '056' THEN 1 ELSE 0 END AS D_USO_056,
CASE WHEN CODIGO_USO = '058' THEN 1 ELSE 0 END AS D_USO_058,
CASE WHEN CODIGO_USO = '059' THEN 1 ELSE 0 END AS D_USO_059,
CASE WHEN CODIGO_USO = '060' THEN 1 ELSE 0 END AS D_USO_060,
CASE WHEN CODIGO_USO = '062' THEN 1 ELSE 0 END AS D_USO_062,
CASE WHEN CODIGO_USO = '064' THEN 1 ELSE 0 END AS D_USO_064,
CASE WHEN CODIGO_USO = '065' THEN 1 ELSE 0 END AS D_USO_065,
CASE WHEN CODIGO_USO = '066' THEN 1 ELSE 0 END AS D_USO_066,
CASE WHEN CODIGO_USO = '067' THEN 1 ELSE 0 END AS D_USO_067,
CASE WHEN CODIGO_USO = '070' THEN 1 ELSE 0 END AS D_USO_070,
CASE WHEN CODIGO_USO = '071' THEN 1 ELSE 0 END AS D_USO_071,
CASE WHEN CODIGO_USO = '072' THEN 1 ELSE 0 END AS D_USO_072,
CASE WHEN CODIGO_USO = '073' THEN 1 ELSE 0 END AS D_USO_073,
CASE WHEN CODIGO_USO = '074' THEN 1 ELSE 0 END AS D_USO_074,
CASE WHEN CODIGO_USO = '075' THEN 1 ELSE 0 END AS D_USO_075,
CASE WHEN CODIGO_USO = '076' THEN 1 ELSE 0 END AS D_USO_076,
CASE WHEN CODIGO_USO = '077' THEN 1 ELSE 0 END AS D_USO_077,
CASE WHEN CODIGO_USO = '080' THEN 1 ELSE 0 END AS D_USO_080,
CASE WHEN CODIGO_USO = '081' THEN 1 ELSE 0 END AS D_USO_081,
CASE WHEN CODIGO_USO = '082' THEN 1 ELSE 0 END AS D_USO_082,
CASE WHEN CODIGO_USO = '090' THEN 1 ELSE 0 END AS D_USO_090,
CASE WHEN CODIGO_USO = '091' THEN 1 ELSE 0 END AS D_USO_091,
CASE WHEN CODIGO_USO = '092' THEN 1 ELSE 0 END AS D_USO_092,
CASE WHEN CODIGO_USO = '093' THEN 1 ELSE 0 END AS D_USO_093,
CASE WHEN CODIGO_USO = '094' THEN 1 ELSE 0 END AS D_USO_094,
CASE WHEN CODIGO_USO = '095' THEN 1 ELSE 0 END AS D_USO_095,
CASE WHEN CODIGO_USO = '096' THEN 1 ELSE 0 END AS D_USO_096,
CASE WHEN CODIGO_USO = '097' THEN 1 ELSE 0 END AS D_USO_097,
CASE WHEN CODIGO_USO = '098' THEN 1 ELSE 0 END AS D_USO_098
FROM TEMP1_BASE_CALCULOS
ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, CODIGO_USO, UNIDAD_CALIFICADA;
QUIT;


PROC SQL; 	CREATE TABLE USO_T AS		
SELECT 		CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
MAX(D_USO_001) AS USO_001,	MAX(D_USO_002) AS USO_002,	MAX(D_USO_003) AS USO_003,
MAX(D_USO_004) AS USO_004,	MAX(D_USO_005) AS USO_005,	MAX(D_USO_006) AS USO_006,
MAX(D_USO_007) AS USO_007,	MAX(D_USO_008) AS USO_008,	MAX(D_USO_009) AS USO_009,
MAX(D_USO_010) AS USO_010,	MAX(D_USO_011) AS USO_011,	MAX(D_USO_012) AS USO_012,
MAX(D_USO_013) AS USO_013,	MAX(D_USO_014) AS USO_014,	MAX(D_USO_015) AS USO_015,
MAX(D_USO_016) AS USO_016,	MAX(D_USO_017) AS USO_017,	MAX(D_USO_018) AS USO_018,
MAX(D_USO_019) AS USO_019,	MAX(D_USO_020) AS USO_020,	MAX(D_USO_021) AS USO_021,
MAX(D_USO_022) AS USO_022,	MAX(D_USO_023) AS USO_023,	MAX(D_USO_024) AS USO_024,
MAX(D_USO_025) AS USO_025,	MAX(D_USO_026) AS USO_026,	MAX(D_USO_027) AS USO_027,
MAX(D_USO_028) AS USO_028,	MAX(D_USO_029) AS USO_029,	MAX(D_USO_030) AS USO_030,
MAX(D_USO_031) AS USO_031,	MAX(D_USO_032) AS USO_032,	MAX(D_USO_033) AS USO_033,
MAX(D_USO_034) AS USO_034,	MAX(D_USO_035) AS USO_035,	MAX(D_USO_036) AS USO_036,
MAX(D_USO_037) AS USO_037,	MAX(D_USO_038) AS USO_038,	MAX(D_USO_039) AS USO_039,
MAX(D_USO_040) AS USO_040,	MAX(D_USO_041) AS USO_041,	MAX(D_USO_042) AS USO_042,
MAX(D_USO_043) AS USO_043,	MAX(D_USO_044) AS USO_044,	MAX(D_USO_045) AS USO_045,
MAX(D_USO_046) AS USO_046,	MAX(D_USO_047) AS USO_047,	MAX(D_USO_048) AS USO_048,
MAX(D_USO_049) AS USO_049,	MAX(D_USO_050) AS USO_050,	MAX(D_USO_051) AS USO_051,
MAX(D_USO_052) AS USO_052,	MAX(D_USO_053) AS USO_053,	MAX(D_USO_055) AS USO_055,
MAX(D_USO_056) AS USO_056,	MAX(D_USO_058) AS USO_058,	MAX(D_USO_059) AS USO_059, 
MAX(D_USO_060) AS USO_060,  MAX(D_USO_062) AS USO_062,	MAX(D_USO_064) AS USO_064,	
MAX(D_USO_065) AS USO_065,	MAX(D_USO_066) AS USO_066,	MAX(D_USO_067) AS USO_067,	
MAX(D_USO_070) AS USO_070,  MAX(D_USO_071) AS USO_071,	MAX(D_USO_072) AS USO_072,	
MAX(D_USO_073) AS USO_073,  MAX(D_USO_074) AS USO_074,	MAX(D_USO_075) AS USO_075,	
MAX(D_USO_076) AS USO_076,  MAX(D_USO_077) AS USO_077,  MAX(D_USO_080) AS USO_080,	
MAX(D_USO_081) AS USO_081,  MAX(D_USO_082) AS USO_082,	MAX(D_USO_090) AS USO_090,	
MAX(D_USO_091) AS USO_091,  MAX(D_USO_092) AS USO_092,	MAX(D_USO_093) AS USO_093,	
MAX(D_USO_094) AS USO_094,  MAX(D_USO_095) AS USO_095,	MAX(D_USO_096) AS USO_096,	
MAX(D_USO_097) AS USO_097,  MAX(D_USO_098) AS USO_098
				FROM PREDIO_VISTA_PRODUCCION 
				GROUP BY 	CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO/* &
                    A.CODIGO_USO = B.CODIGO_USO*/;
QUIT;

DATA PREDIO_VISTA_PRODUCCION; SET PREDIO_VISTA_PRODUCCION;
DROP 
D_USO_001	D_USO_002	D_USO_003	D_USO_004	D_USO_005	D_USO_006	D_USO_007	D_USO_008	D_USO_009	D_USO_010
D_USO_011	D_USO_012	D_USO_013	D_USO_014	D_USO_015	D_USO_016	D_USO_017	D_USO_018	D_USO_019	D_USO_020
D_USO_021	D_USO_022	D_USO_023	D_USO_024	D_USO_025	D_USO_026	D_USO_027	D_USO_028	D_USO_029	D_USO_030
D_USO_031	D_USO_032	D_USO_033	D_USO_034	D_USO_035	D_USO_036	D_USO_037	D_USO_038	D_USO_039	D_USO_040
D_USO_041	D_USO_042	D_USO_043	D_USO_044	D_USO_045	D_USO_046	D_USO_047	D_USO_048	D_USO_049	D_USO_050
D_USO_051	D_USO_052	D_USO_053	D_USO_055	D_USO_056	D_USO_058	D_USO_059	D_USO_060	D_USO_062	D_USO_064
D_USO_065	D_USO_066	D_USO_067	D_USO_070	D_USO_071	D_USO_072	D_USO_073	D_USO_074	D_USO_075	D_USO_076
D_USO_077	D_USO_080	D_USO_081	D_USO_082	D_USO_090	D_USO_091	D_USO_092	D_USO_093	D_USO_094	D_USO_095
D_USO_096	D_USO_097	D_USO_098;
RUN;

/************************************************************************************************************/
/* A LA BASE PREDIO_VISTA_PRODUCCION SE LE PEGAN LAS VARIABLES DUMMY DE TODOS LOS USOS */
/************************************************************************************************************/

PROC SQL; 	CREATE TABLE PREDIO_VISTA_PRODUC_USOP_A AS	/* A LA BASE PREDIO_VISTA_PRODUCCION SE LE PEGAN LAS VARIABLES DUMMY DE TODOS LOS USOS */
		SELECT A.*, B.*
				FROM PREDIO_VISTA_PRODUCCION AS A LEFT JOIN USO_T AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO;
QUIT;


/*--------------------------------------------------------------------------------------------------------------------------
AQUI EMPIEZA LA CONSTRUCCION PARA OBTENER LA INFO A NIVEL PREDIO
--------------------------------------------------------------------------------------------------------------------------*/

%USOP(PREDIO_VISTA_PRODUC_USOP_A, PREDIO_VISTA_PRODUC_USOP_A, PRUEBA.PREDIO_VISTA_PRODUC_USOP, CODIGO_USOP);


/************************************************************************************************************/
/* CREACIÓN DE VARIABLES DE URBANO Y RURAL, MEJORA Y LOTES. */
/* PEGADO DE LA MARCA MANZANA, LAS ZHF DE LAS DOS VIGENCIAS Y LA VARIABLE DE LOTES_CIEGOS */
/************************************************************************************************************/

DATA TIPO_CARACTERIZACION_MANZ; set ODBCLIB.TIPO_CARACTERIZACION_MANZ; /* MARCA MANZANA */
MANMANZ_ID = CAT(CODIGO_BARRIO, 0, CODIGO_MANZANA);
MARCA_MANZANA = TIPO_RES_ASOC;
IF VIGENCIA = &VIGENCIA.;
RUN; 

PROC SORT  DATA = TIPO_CARACTERIZACION_MANZ NODUPKEY;  
BY  CODIGO_BARRIO CODIGO_MANZANA; RUN;

PROC SQL; 	CREATE TABLE PRUEBA.RES_FORM_PRED_SIIC AS /* Informacion de ZHF de vigencia en curso*/
		SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, VIGENCIA_RESOLUCION, CODIGO_ZONA_FISICA
			FROM ODBCLIB.RESOLUCION_PREDIO_DIG
			WHERE VIGENCIA_RESOLUCION = &VIGENCIA.
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO;
QUIT;

PROC SORT 	DATA=PRUEBA.RES_FORM_PRED_SIIC NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO; RUN;


PROC SQL; 	CREATE TABLE PRUEBA.RES_FORM_PRED_SIIC_2020 AS  
		SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, VIGENCIA_RESOLUCION, CODIGO_ZONA_FISICA
			FROM ODBCLIB.RESOLUCION_PREDIO_DIG_2020
			WHERE VIGENCIA_RESOLUCION = 2020
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO;
QUIT;

PROC SORT 	DATA=PRUEBA.RES_FORM_PRED_SIIC_2020 NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO; RUN;


PROC SQL;  	CREATE TABLE PRUEBA.PREDIO_VISTA_USOP_MZ_ZHF AS  
		SELECT A.*, 
		SUBSTR(A.CODIGO_BARRIO, 1, 1) AS ID_UR_RU,
		CASE WHEN (SUBSTR(A.CODIGO_BARRIO, 1, 1) = "0") THEN 1 ELSE 0 END  AS PRED_URB,
		CASE WHEN (SUBSTR(A.CODIGO_BARRIO, 1, 1) NE "0") THEN 1 ELSE 0 END  AS PRED_RUR,
		CASE WHEN ((A.CODIGO_USO IN (' ','090')) OR (A.AREA_CONSTRUIDA IN (0,.))) THEN 1 ELSE 0 END AS LOTE,
		CASE WHEN ((A.AREA_CONSTRUIDA > 0 AND A.AREA_TERRENO = 0) OR (A.CODIGO_CONSTRUCCION NE '000' AND A.CODIGO_RESTO = '00000')) THEN 1 ELSE 0 END AS MEJORA,
		B.CODIGO_ZONA_FISICA AS ZHF_&VIGENCIA.,
		B.CODIGO_ZONA_FISICA AS ZHF, SUBSTR(B.CODIGO_ZONA_FISICA,12,1) AS ZHF12,		
		SUBSTR(B.CODIGO_ZONA_FISICA,13,1) AS ZHF13, C.CODIGO_ZONA_FISICA AS ZHF_2020,
		D.MARCA_MANZANA
			FROM PRUEBA.PREDIO_VISTA_PRODUC_USOP AS A
 			LEFT JOIN PRUEBA.RES_FORM_PRED_SIIC AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO
			LEFT JOIN PRUEBA.RES_FORM_PRED_SIIC_2020 AS C
				ON A.CODIGO_BARRIO = C.CODIGO_BARRIO &
				   A.CODIGO_MANZANA = C.CODIGO_MANZANA &
				   A.CODIGO_PREDIO = C.CODIGO_PREDIO
			LEFT JOIN TIPO_CARACTERIZACION_MANZ AS D
				ON	CAT(A.CODIGO_BARRIO, 0, A.CODIGO_MANZANA) = D.MANMANZ_ID
			LEFT JOIN (SELECT DISTINCT * FROM COMUN.LOTES_CIEGOS_BANDERA_180305) AS E
				ON A.LOTE_ID = E.LOTE_ID
			ORDER BY A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
			CODIGO_USO, UNIDAD_CALIFICADA;
QUIT;


/************************************************************************************************************/
/* SE CREA UNA BASE A NIVEL DE PREDIO, POR USO PREDOMINANTE */
/************************************************************************************************************/
/*WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('001','002','009') & CLASE_PREDIO = 'N' & ARMAZON_ESTRUCTURA = '111' & MUROS_ESTRUCTURA = '121') THEN 'T24'
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('001','002','009') & CLASE_PREDIO = 'N' & ARMAZON_ESTRUCTURA = '112' & MUROS_ESTRUCTURA = '124') THEN 'T25'*/

PROC SQL;
CREATE TABLE MARCA_DESECHOS AS SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
1 AS MARCA_DESECHO
FROM PRUEBA.PREDIO_VISTA_USOP_MZ_ZHF 
WHERE (((USO_001 = 1) | (USO_002 = 1) | (USO_009 = 1)) AND (ARMAZON_ESTRUCTURA = '111' & MUROS_ESTRUCTURA = '121') AND CLASE_PREDIO = "N") | 
(((USO_001 = 1) | (USO_002 = 1) | (USO_009 = 1)) AND (ARMAZON_ESTRUCTURA = '112' & MUROS_ESTRUCTURA = '124') AND CLASE_PREDIO = "N") ;
QUIT;

PROC SQL;
CREATE TABLE PRUEBA.PREDIO_VISTA_USOP_MZ_ZHF AS SELECT DISTINCT A.*, B.MARCA_DESECHO 
FROM PRUEBA.PREDIO_VISTA_USOP_MZ_ZHF AS A 
LEFT JOIN MARCA_DESECHOS AS B 
ON A.CODIGO_BARRIO = B.CODIGO_BARRIO AND 
A.CODIGO_MANZANA = B.CODIGO_MANZANA AND
A.CODIGO_PREDIO = B.CODIGO_PREDIO AND 
A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION AND 
A.CODIGO_RESTO = B.CODIGO_RESTO
ORDER BY A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, A.CODIGO_CONSTRUCCION, A.CODIGO_RESTO;
QUIT;


DATA PREDIO_VISTA_PRODUC_USOP3; SET PRUEBA.PREDIO_VISTA_USOP_MZ_ZHF; IF CODIGO_USOP = CODIGO_USO; RUN;

	
PROC SORT DATA=PREDIO_VISTA_PRODUC_USOP3 OUT = PRUEBA.PREDIO_VISTA_PRODUC_USOP4  NODUPKEY;
BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO; RUN;


/********************************************************************************************/
/* REGLAS DE LIQUIDACIÓN A NIVEL DE PREDIO */
/*********************************************************************************************/


PROC SQL; CREATE TABLE PREDIOS_MODELO AS	/* REGLAS DE LIQUIDACIÓN A NIVEL DE PREDIO */
		SELECT *,
	
CASE
WHEN ((CODIGO_USO IN (' ','090') AND CLASE_PREDIO ='P') OR (AREA_CONSTRUIDA IN (0,.) AND CLASE_PREDIO ='P')) THEN 'LOTES_PH'
WHEN ((CODIGO_USO IN (' ') AND CLASE_PREDIO ='N') OR (AREA_CONSTRUIDA IN (0,.) AND CLASE_PREDIO ='N')) THEN 'LOTES_NPH'
/*WHEN ((AREA_CONSTRUIDA / AREA_TERRENO) < 0.3 & CLASE_PREDIO = 'N' & AREA_TERRENO > 0) THEN 'LOTES_30'*/
				
/*WHEN (CONSERVACION_HISTORICA  NE ('N') & CLASE_PREDIO = 'N' & CODIGO_USO IN ('001','002','009','019','020','022')) THEN 'AVESP_BIC'
WHEN (CONSERVACION_HISTORICA  NE ('N') & CODIGO_USO IN ('003','004','005','006','007','008','010','011','012','013','014','015',
'016','017','018','021','023','024','025','026','029','030','031','032','033','055','056','058',
'062','064','065','066','067','070','071','072','073','074','075','076','077','080','094','096') ) THEN 'AVESP_BIC' */

WHEN (CONSERVACION_HISTORICA  NE ('N') & CLASE_PREDIO = 'N' ) THEN 'AV_ESP_BIC'


/*WHEN ( LLAVE IN(
'005624010700000000','005624010800000000','005624010900000000','005624011000000000','005624011100000000',
'005624011200000000','005624011300000009','005624012300000000','005624012400000000','005624012500000000',
'005624012600000000','005624012700000000','005624012800000000','005624012900000000','005624013000000000',
'005624013100000000','005624013200000000','005624013300000000','005624013400000000','005624013500000000',
'005624013600000000','005624013700000000','005624013800000000','005624014000000000','005624014100000000',
'005624014200000000','005624014300000000','005624014600000000','005672010100000000','005672010200000000',
'005673010100000000','002511801100000000'))THEN 'PRED_CESP'   mismos del CIB2018 son los entregados el 180302*/


/*1.1 Modelos PH*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (1) ) THEN 'M01_1' /*Residencial PH, estrato 1*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (2) ) THEN 'M01_2' /*Residencial PH, estrato 2*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (3) ) THEN 'M01_3' /*Residencial PH, estrato 3*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (4) ) THEN 'M02_4' /*Residencial PH, estrato 4*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (5) ) THEN 'M02_5' /*Residencial PH, estrato 5*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (6) ) THEN 'M02_6' /*Residencial PH, estrato 6*/
WHEN (CODIGO_USO IN ('035', '036','043','044','045','046','059','081', '082','092') ) THEN 'M03' /*Oficinas PH*/
WHEN (CODIGO_USO IN ('039','040','060')) THEN 'M04' /*Comercio PH*/
WHEN (CODIGO_USO IN ('028','034','053','091','093','097')) THEN 'M05' /*Bodegas + Industria PH*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (1) & CLASE_PREDIO = 'P')  THEN 'M06_1' /*Bifamiliar estrato 1*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (2) & CLASE_PREDIO = 'P')  THEN 'M06_2' /*Bifamiliar estrato 2*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (3) & CLASE_PREDIO = 'P')  THEN 'M06_3' /*Bifamiliar estrato 3*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (4) & CLASE_PREDIO = 'P')  THEN 'M06_4' /*Bifamiliar estrato 4*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (5) & CLASE_PREDIO = 'P')  THEN 'M06_5' /*Bifamiliar estrato 5*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (6) & CLASE_PREDIO = 'P')  THEN 'M06_6' /*Bifamiliar estrato 6*/

/*Tablas de Valor NPH*/

WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('001','002','009') & CLASE_PREDIO = 'N' & ARMAZON_ESTRUCTURA = '111' & MUROS_ESTRUCTURA = '121' ) THEN 'T24' /*Construcciones en material de desecho*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('001','002','009') & CLASE_PREDIO = 'N' & ARMAZON_ESTRUCTURA = '112' & MUROS_ESTRUCTURA = '124' ) THEN 'T25' /*Construcciones en Prefabricado*/


/*T01 Residencial */ 
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('001','002','009') & CLASE_PREDIO = 'N' & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('012') & AREA_CONSTRUIDA <= 350 & MAX_NUM_PISO <= 4) THEN 'T01' /*Residencial*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('020') & CLASE_PREDIO = 'N' & CLASE_CONSTRUCCION = "R") THEN 'T01' /*Residencial*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('058') & CLASE_PREDIO = 'N' & CLASE_CONSTRUCCION = "R") THEN 'T01' /*Residencial*/
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('001','002') & (USO_003 + USO_004 + USO_009 + USO_012 + USO_014 + USO_020 +
USO_022 + USO_026 + USO_056 + USO_058 + USO_080) > 0 & CLASE_PREDIO = 'N'  & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 &  CODIGO_USO IN ('009') & (USO_001 + USO_002 + USO_003 + USO_004 + USO_012 + USO_014 +
USO_020 + USO_022 + USO_026 + USO_056 + USO_058 + USO_080) > 0 & CLASE_PREDIO = 'N' & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 &  CODIGO_USO IN ('012') & (USO_001 + USO_002 + USO_003 + USO_004 + USO_009 +
USO_020 + USO_022 + USO_056) > 0 & AREA_CONSTRUIDA <= 350 & MAX_NUM_PISO <= 4 & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 &  CODIGO_USO IN ('020') & (USO_001 + USO_002 + USO_003 + USO_004 + USO_009 +
USO_012 + USO_022 + USO_056) > 0 & CLASE_CONSTRUCCION = 'R' & CLASE_PREDIO = 'N' & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/

WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('001','002') & (USO_003 > 0 & USO_022 > 0 ) & CLASE_PREDIO = 'N' & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('001','002') & (USO_004 > 0 & USO_022 > 0 ) & CLASE_PREDIO = 'N' & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('001','002') & (USO_004 > 0 & USO_020 > 0 ) & CLASE_PREDIO = 'N' & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('001','002') & (USO_004 > 0 & USO_009 > 0 ) & CLASE_PREDIO = 'N' & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('012') & (USO_001 > 0 & USO_003 > 0 ) & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('012') & (USO_001 > 0 & USO_004 > 0 ) & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('012') & (USO_001 > 0 & USO_009 > 0 ) & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('012') & (USO_001 > 0 & USO_020 > 0 ) & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('012') & (USO_001 > 0 & USO_022 > 0 ) & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/

/*T01 Residencial  - uso complementario*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('003','004','012','058') & (USO_001 > 0 | USO_002 > 0 ) & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('020') & (USO_001 > 0 | USO_002 > 0 ) & CLASE_CONSTRUCCION = "R" & CLASE_PREDIO = 'N'  & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('003') & (USO_001 > 0 & USO_022 > 0 ) & MARCA_DESECHO = .) THEN 'T01' /*Residencial - uso complementario*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('020') & (USO_001 > 0 & USO_022 > 0 )  & CLASE_CONSTRUCCION = "R" & CLASE_PREDIO = 'N'  & MARCA_DESECHO = .) THEN 'T01' /*Residencial*/


/*T02 Adecuación Comercial*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('003', '004', '056')) THEN 'T02' /*Adecuación Comercial*/
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('003', '004', '056') &(USO_009 + USO_020 + USO_022)> 0 ) THEN 'T02' /*Adecuación Comercial*/
WHEN (NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('004') & (USO_001 > 0 & USO_022 > 0 )) THEN 'T02' /*Adecuación Comercial*/

/*T03 Bodegas e Industria*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('010', '011', '025', '080')) THEN 'T03' /*Bodegas e Industria*/
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('010', '011') & 
(USO_001 + USO_002 + USO_003 + USO_004 + USO_009 + USO_012 +  USO_022 + USO_080 + USO_056) > 0) THEN 'T03' /*Bodegas e Industria*/
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('025') & 
(USO_001 + USO_002 + USO_003 + USO_004 + USO_009 + USO_012 + USO_020 + USO_022 + USO_080 + USO_056) > 0) THEN 'T03' /*Bodegas e Industria*/
WHEN (NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('010','011','025') & (USO_022 > 0 & USO_080 > 0 )) THEN 'T03' /*Bodegas e Industria*/
WHEN (NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('010','011','025') & (USO_004 > 0 & USO_080 > 0 )) THEN 'T03' /*Bodegas e Industria*/

/*T04 Bodega Económica */
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('033')) THEN 'T04' /*Bodega Económica*/

/*T05 Oficinas*/
WHEN (CLASE_CONSTRUCCION = "C" & NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('020')& CLASE_PREDIO = 'N') THEN 'T05' /*Oficinas*/
WHEN (CLASE_CONSTRUCCION = "C" & NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('058')& CLASE_PREDIO = 'N') THEN 'T05' /*Oficinas*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('015', '018', '029', '030', '058', '065', '067')) THEN 'T05' /*Oficinas*/
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & 
CODIGO_USO IN ('020') & (USO_003 + USO_004 + USO_009 + USO_012 + USO_022 + USO_056)> 0 & CLASE_PREDIO = 'N') THEN 'T05' /*Oficinas*/

/*T06 Institucional*/
WHEN (((MAX_NUM_PISO >= 5) | (AREA_CONSTRUIDA > 350)) & 
 NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('012')) THEN 'T06' /*Institucional*/
WHEN (((MAX_NUM_PISO >= 5) | (AREA_CONSTRUIDA > 350)) & 
 NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('012') & (USO_003 + USO_004 + USO_009 + USO_020 + USO_022 + USO_056)> 0) THEN 'T06' /*Institucional*/

/*T07 Depósitos*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('022') & CLASE_PREDIO = 'N') THEN 'T07' /*Depósitos*/
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('022') & 
(USO_003 + USO_004 + USO_009 + USO_020 + USO_056) > 0 & CLASE_PREDIO = 'N') THEN 'T07' /*Depósitos*/

/*T08 Colegios y Universidades 1-3 pisos*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('013')) THEN 'T08' /*Colegios y Universidades 1-3 pisos*/

/*T09 Clínicas y Hospitales*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('017')) THEN 'T09' /*Clínicas y Hospitales*/

/*T10 Aulas de Clase*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('064')) THEN 'T10' /*Aulas de Clase*/

/*T11 Hoteles*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('021')) THEN 'T11' /*Hoteles*/

/*T12 Edificio de Parqueo*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('024')) THEN 'T12' /*Edificio de Parqueo*/

/*T13 Parqueadero NPH*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('096')) THEN 'T13' /*Parqueadero NPH*/

/*T14 Oficinas Operativas*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('005')) THEN 'T14' /*Oficinas Operativas*/

/*T15 Enramadas*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('070')) THEN 'T15' /*Enramadas*/

/*T16 Anexos constructivos*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('071','072','073','076','077')) THEN 'T16' /*Anexos constructivos*/

/*T17 Piscinas*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('031')) THEN 'T17' /*Piscinas*/

/*T18 Coliseos*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('032')) THEN 'T18' /*Coliseos*/

/*T19 Bodegas con Adecuación Comercial*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('008', '014', '023')) THEN 'T19' /*Bodegas con Adecuación Comercial*/
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('008', '023') &
 (USO_001 + USO_002 + USO_003 + USO_004 + USO_009 + USO_012 + USO_020 + USO_022 + USO_080 + USO_056)> 0) THEN 'T19' /*Bodegas con Adecuación Comercial*/
WHEN (NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('008') & (USO_022 > 0 & USO_080 > 0 )) THEN 'T19' /*Bodegas con Adecuación Comercial*/
WHEN (NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('008') & (USO_004 > 0 & USO_080 > 0 )) THEN 'T19' /*Bodegas con Adecuación Comercial*/

/*T20 Moteles, amoblados, residencias*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('026')) THEN 'T20' /*Moteles, amoblados, residencias*/


/*T26 Colegios y Universidades 4 o mas pisos*/
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('016')) THEN 'T26' /*Colegios y Universidades 4 o mas pisos*/


WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('047', '055', '057', '062', '066', '074', '075', '098')) THEN 'AV_ESP_USO' 
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('006','007','041','042','094','095')) THEN 'AV_ESP_CC' 

/*1.2 Tablas de Valor PH*/

WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('048') ) THEN 'T21' /*Parqueo libre  PH */
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('048') & (USO_049)> 0) THEN 'T21' 
WHEN (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & CODIGO_USO IN ('049') ) THEN 'T22' /*Parqueo libre  PH  último cambio*/
WHEN (NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('049') & (USO_048)> 0) THEN 'T22' 


WHEN (CODIGO_USO IN ('050') & NUMERO_UNIDADES = 1 & NUM_USOS = 1 ) THEN 'T12' /* Edificio de parqueo PH */
WHEN (CODIGO_USO IN ('051') & NUMERO_UNIDADES = 1 & NUM_USOS = 1 ) THEN 'T23' /* Depósito (Lockers) PH */ 
WHEN (CODIGO_USO IN ('052') & NUMERO_UNIDADES = 1 & NUM_USOS = 1 ) THEN 'T17' /*Piscinas PH */
WHEN (CODIGO_USO IN ('027') & NUMERO_UNIDADES = 1 & NUM_USOS = 1 ) THEN 'T20' /*Moteles, amoblados, residencias*/




ELSE 'USOS MULTIPLES'
		END AS MODELO_0,
1 AS UNIDCAL_PRED,
/*T01 Residencial  - uso complementario*/
CASE
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('003','004','012','058') & (USO_001 > 0 | USO_002 > 0 )) THEN 1 /*Residencial*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('020') & (USO_001 > 0 | USO_002 > 0 ) & CLASE_CONSTRUCCION = "R" & CLASE_PREDIO = 'N' ) THEN 1 /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('003') & (USO_001 > 0 & USO_022 > 0 )) THEN 1 /*Residencial - uso complementario*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('020') & (USO_001 > 0 & USO_022 > 0 ) & CLASE_CONSTRUCCION = "R" & CLASE_PREDIO = 'N' ) THEN 1 /*Residencial*/



ELSE 0 END AS RES_NPH_CASODOS

			FROM PRUEBA.PREDIO_VISTA_PRODUC_USOP4
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, CODIGO_USO,
			UNIDAD_CALIFICADA;
QUIT;

/* *******************************************************************************************************/
/* SE ASIGNAN LOS MODELOS DE AVALÚOS ESPECIALES POR TOPES A NIVEL DE PREDIO */
/* *******************************************************************************************************/

DATA PREDIOS_MODELO_1; SET PREDIOS_MODELO;
IF MODELO_0 = 'T01' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T02' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T03' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T04' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T05' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T06' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T07' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T08' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T09' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T10' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T11' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T12' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T13' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T14' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T15' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T16' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T17' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T18' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T19' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T20' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 5000) THEN MODELO_0 = 'AV_ESP_TOP';

IF MODELO_0 = 'T21' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T21' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_CONSTRUIDA > 1000) THEN MODELO_0 = 'AV_ESP_TOP';

IF MODELO_0 = 'T22' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T22' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_CONSTRUIDA > 1000) THEN MODELO_0 = 'AV_ESP_TOP';

IF MODELO_0 = 'T23' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T24' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T25' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'AV_ESP_TOP';
IF MODELO_0 = 'T26' AND NUM_USOS = 1 & NUMERO_UNIDADES = 1 AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'AV_ESP_TOP';

IF MODELO_0 = 'T01' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T02' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T03' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T04' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T05' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T06' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T07' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T08' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T09' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T10' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T11' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T12' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T13' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T14' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T15' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T16' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T17' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T18' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T19' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T20' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 5000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T21' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T22' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T23' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T24' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T25' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_0 = 'USOS MULTIPLES';
IF MODELO_0 = 'T26' AND (NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_0 = 'USOS MULTIPLES';
RUN;

/* *******************************************************************************************************/
/*VISTA:  PEGADO IDENTIFICADOR UNIDAD CALIFICADA PREDOMINANTE*/
/* *******************************************************************************************************/

PROC SQL; CREATE TABLE VISTA_NUEVO_MODELO_A AS	 /*VISTA:  MODELO (Primera Asignación)*/
		SELECT A.*,  B.MODELO_0,  B.RES_NPH_CASODOS, 
		CASE WHEN (C.UNIDCAL_PRED=1) THEN 1 ELSE 0 END  AS UNIDCAL_PRED
				FROM PRUEBA.PREDIO_VISTA_USOP_MZ_ZHF AS A
 				LEFT JOIN PREDIOS_MODELO_1 AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO
				LEFT JOIN PREDIOS_MODELO_1 AS C 
					ON	A.CODIGO_BARRIO = C.CODIGO_BARRIO &
					A.CODIGO_MANZANA = C.CODIGO_MANZANA &
					A.CODIGO_PREDIO = C.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = C.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = C.CODIGO_RESTO &
					A.CODIGO_USO = C.CODIGO_USO	&
					A.UNIDAD_CALIFICADA = C.UNIDAD_CALIFICADA &
					A.AREA_USO = C.AREA_USO &
					A.CLASE_CONSTRUCCION = C.CLASE_CONSTRUCCION &
					A.PUNTAJE = C.PUNTAJE &
                    A.RESTO_IRRADIADOR = C.RESTO_IRRADIADOR	 
WHERE	(A.MARCA_FORMACION IN ('A','B','C','D','E','F','G','N') | A.MARCA_FORMACION IS NULL) AND 	A.CODIGO_DESTINO NOT IN ('99');
QUIT;

/* *******************************************************************************************************
/* EN ESTA PARTE SE TRABAJAN LAS TABLAS DE MATERIALES DE DESECHO Y USOS COMPLEMENTARIOS. */
/* *******************************************************************************************************/


/* Se comentó el contenido del siguiente DATA - Set debido a que la definición de la T24 y T25 cambió*/
DATA MATERIAL_DESECHO1; SET VISTA_NUEVO_MODELO_A; /*T24 Construcciones en material de desecho O  T25 Construcciones en Prefabricado*/

/*IF (ARMAZON_ESTRUCTURA = '111' AND MUROS_ESTRUCTURA IN ('121')) OR (ARMAZON_ESTRUCTURA = '112' AND MUROS_ESTRUCTURA IN ('124')) ;*/
/*
IF RES_NPH_CASODOS=1 AND MODELO_0 IN ('T01') AND ARMAZON_ESTRUCTURA IN ('111') AND MUROS_ESTRUCTURA IN ('121') THEN MODELO_0='USOS MULTIPLES'; 
IF RES_NPH_CASODOS=1 AND MODELO_0 IN ('T01') AND ARMAZON_ESTRUCTURA IN ('112') AND MUROS_ESTRUCTURA IN ('124') THEN MODELO_0='USOS MULTIPLES'; 

IF (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & ARMAZON_ESTRUCTURA IN ('111') AND MUROS_ESTRUCTURA IN ('121') 
AND MODELO_0 IN ('T01', 'T02', 'T03', 
'T04', 'T05', 'T06', 'T07', 'T08', 'T09', 'T10', 'T11', 'T12', 'T13', 'T14', 'T15', 'T16', 
'T17', 'T18', 'T19', 'T20', 'T21', 'T22', 'T23',  'T26')) THEN MODELO_0='T24'; 

IF (NUM_USOS = 1 & NUMERO_UNIDADES = 1 & ARMAZON_ESTRUCTURA IN ('112') AND MUROS_ESTRUCTURA IN ('124')
AND MODELO_0 IN ('T01', 'T02', 'T03', 'T04', 'T05', 'T06', 'T07', 'T08', 'T09', 'T10', 
'T11', 'T12', 'T13', 'T14', 'T15', 'T16', 'T17', 'T18', 'T19', 'T20', 'T21', 'T22', 
'T23', 'T26')) THEN MODELO_0='T25'; 

IF ((NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND RES_NPH_CASODOS NE 1 & ARMAZON_ESTRUCTURA IN ('111')  AND MUROS_ESTRUCTURA IN ('121') 
AND MODELO_0 IN ('T01', 'T02', 'T03', 
'T04', 'T05', 'T06', 'T07', 'T08', 'T09', 'T10', 'T11', 'T12', 'T13', 'T14', 'T15', 'T16', 
'T17', 'T18', 'T19', 'T20', 'T21', 'T22', 'T23', 'T26')) THEN MODELO_0='USOS MULTIPLES'; 

IF ((NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND RES_NPH_CASODOS NE 1  &  ARMAZON_ESTRUCTURA IN ('112') AND MUROS_ESTRUCTURA IN ('124')
AND MODELO_0 IN ('T01', 'T02', 'T03', 'T04', 'T05', 'T06', 'T07', 'T08', 'T09', 'T10', 
'T11', 'T12', 'T13', 'T14', 'T15', 'T16', 'T17', 'T18', 'T19', 'T20', 'T21', 'T22', 
'T23', 'T26')) THEN MODELO_0='USOS MULTIPLES'; 
*/
RUN;

DATA MATERIAL_DESECHO2; SET MATERIAL_DESECHO1;
/*
IF RES_NPH_CASODOS=1 AND MODELO_0='USOS MULTIPLES' THEN DESECHO_CASO2=1;
IF ((NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND RES_NPH_CASODOS NE 1  &  ARMAZON_ESTRUCTURA IN ('111') AND MUROS_ESTRUCTURA IN ('121') AND MODELO_0='USOS MULTIPLES') THEN USO_DESECHO =1; 
IF ((NUM_USOS NE 1 OR NUMERO_UNIDADES NE 1) AND RES_NPH_CASODOS NE 1  & ARMAZON_ESTRUCTURA IN ('112') AND MUROS_ESTRUCTURA IN ('124') AND MODELO_0='USOS MULTIPLES') THEN USO_DESECHO =1; 
/*KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO LLAVE DESECHO_CASO2;*/
RUN;

/*
DATA MATERIAL_DESECHO3; SET MATERIAL_DESECHO2; 
IF DESECHO_CASO2=1 OR USO_DESECHO =1;
PREDIO_DESECHO=1;
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO LLAVE PREDIO_DESECHO;
RUN;

PROC SORT DATA=MATERIAL_DESECHO3 NODUPKEY;
BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO; RUN;


PROC SQL; CREATE TABLE MATERIAL_DESECHO4 AS	 /*VISTA:  PEGADO IDENTIFICADOR PREDIO QUE TIENE UNIDAD CALIFICADA COMPLEMENTARIA*/
/*		SELECT A.*, 
CASE WHEN (B.PREDIO_DESECHO=1) THEN 1 ELSE 0 END  AS PREDIO_DESECHO

				FROM MATERIAL_DESECHO2 AS A LEFT JOIN MATERIAL_DESECHO3 AS B
				ON	A.LLAVE = B.LLAVE; /*IDENTIFICADOR PREDIO*/
*QUIT;


DATA MATERIAL_DESECHO; SET MATERIAL_DESECHO2;
*IF PREDIO_DESECHO = 1 THEN MODELO_0 = 'USOS MULTIPLES'; 
RUN;

 
/*SE PROGRAMAN LOS CASOS QUE SE LIQUIDAN POR LA UNIDAD DEL USO COMPLEMENTARIO*/
DATA VISTA_CASODOS; SET MATERIAL_DESECHO; /*SE PROGRAMAN LOS CASOS QUE SE LIQUIDAN POR LA UNIDAD DEL USO COMPLEMENTARIO*/
IF RES_NPH_CASODOS = 1 AND MODELO_0='T01'; RUN; 

PROC SQL; CREATE TABLE VISTA_CASODOS_A AS	/*MODELO (Asignación Caso Dos)*/
		SELECT *,
CASE
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('003','004','012','058') & (USO_001 > 0)) THEN '001' /*Residencial*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('003','004','012','058') & (USO_002 > 0 )) THEN '002' /*Residencial*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('020'/*,'022'*/) & (USO_001 > 0 ) & CLASE_PREDIO = 'N' ) THEN '001' /*Residencial*/
WHEN ( NUM_USOS = 2 & NUMERO_UNIDADES = 2 & CODIGO_USO IN ('020'/*,'022'*/) & (USO_002 > 0 ) & CLASE_PREDIO = 'N' ) THEN '002' /*Residencial*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('003'/*,'004'*/) & (USO_001 > 0 & USO_022 > 0 )) THEN '001' /*Residencial - uso complementario*/
WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('020') & (USO_001 > 0 & USO_022 > 0 ) & CLASE_PREDIO = 'N' ) THEN '001' /*Residencial*/
/*WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('022') & (USO_001 > 0 & USO_004 > 0 ) & CLASE_PREDIO = 'N' ) THEN '001' *//*Residencial*/
/*WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('022') & (USO_001 > 0 & USO_003 > 0 ) & CLASE_PREDIO = 'N' ) THEN '001' *//*Residencial*/
/*WHEN ( NUM_USOS = 3 & NUMERO_UNIDADES = 3 & CODIGO_USO IN ('022') & (USO_001 > 0 & USO_020 > 0 ) & CLASE_PREDIO = 'N' ) THEN '001' *//*Residencial*/
WHEN ( CODIGO_USO IN ('001')) THEN '001' /*Residencial*/
WHEN ( CODIGO_USO IN ('002')) THEN '002' /*Residencial*/
ELSE ' ' END AS CODIGO_USO_COMPL
			FROM VISTA_CASODOS
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, CODIGO_USO,
			UNIDAD_CALIFICADA;
QUIT;


/*VISTA_CODIGO_USO_COMPL*/
DATA VISTA_CASODOS_B; SET VISTA_CASODOS_A;  /*VISTA_CODIGO_USO_COMPL*/
IF CODIGO_USO = CODIGO_USO_COMPL; 
UNIDCAL_COMPL = 1;
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO CODIGO_USO UNIDAD_CALIFICADA AREA_USO CLASE_CONSTRUCCION PUNTAJE NUM_USOS CODIGO_USO CODIGO_USOP CODIGO_USO_COMPL UNIDCAL_COMPL llave;
RUN; 



PROC SORT DATA=VISTA_CASODOS_B; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO DESCENDING AREA_USO  UNIDAD_CALIFICADA DESCENDING CLASE_CONSTRUCCION DESCENDING PUNTAJE;
PROC SORT DATA=VISTA_CASODOS_B OUT = VISTA_UNIDAD_USO_COMPL  NODUPKEY;
BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO; RUN;


PROC SQL; CREATE TABLE VISTA_NUEVO_MODELO_B AS	 /*VISTA:  PEGADO IDENTIFICADOR UNIDAD CALIFICADA COMPLEMENTARIA*/
		SELECT A.*, 
CASE WHEN (B.UNIDCAL_COMPL=1) THEN 1 ELSE 0 END  AS UNIDCAL_COMPL

				FROM MATERIAL_DESECHO AS A LEFT JOIN VISTA_UNIDAD_USO_COMPL AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO &
					A.CODIGO_USO = B.CODIGO_USO	&
					A.UNIDAD_CALIFICADA = B.UNIDAD_CALIFICADA &
					A.AREA_USO=B.AREA_USO &
					A.CLASE_CONSTRUCCION=B.CLASE_CONSTRUCCION ;
QUIT;

DATA VISTA_NUEVO_MODELO_B1; SET VISTA_NUEVO_MODELO_B;
IF UNIDCAL_COMPL=1 AND (CODIGO_USO IN ('001','002','009','019','020','022')  & CLASE_PREDIO = 'P' & CODIGO_ESTRATO IN (1,2,3))  THEN MODELO_0 ='M06_123'; 
IF UNIDCAL_COMPL=1 AND (CODIGO_USO IN ('001','002','009','019','020','022')  & CLASE_PREDIO = 'P' & CODIGO_ESTRATO IN (4,5,6))  THEN MODELO_0 ='M06_456';
RUN;

PROC SQL; CREATE TABLE VISTA_NUEVO_MODELO_C AS	 /*VISTA:  PEGADO IDENTIFICADOR PREDIO QUE TIENE UNIDAD CALIFICADA COMPLEMENTARIA*/
		SELECT A.*, 
CASE WHEN (B.UNIDCAL_COMPL=1) THEN 1 ELSE 0 END  AS PREDIO_UNIDCAL_COMPL

				FROM VISTA_NUEVO_MODELO_B1 AS A LEFT JOIN VISTA_UNIDAD_USO_COMPL AS B
				ON	A.LLAVE = B.LLAVE; /*IDENTIFICADOR PREDIO*/
QUIT;

/* *******************************************************************************************************
/* SE CREA LA BASE Y LA VARIABLE DE LA UNIDAD DE LIQUIDACIÓN (UNIDAD COMPLEMENTARIA EN CASOS PARTICULARES). */
/* *******************************************************************************************************/

DATA UNIDAD_LIQUIDACION; SET VISTA_NUEVO_MODELO_C ; /* SE CREA LA BASE Y LA VARIABLE DE LA UNIDAD DE LIQUIDACIÓN (UNIDAD COMPLEMENTARIA EN CASOS PARTICULARES). */
IF PREDIO_UNIDCAL_COMPL = 1 THEN UNIDAD_LIQUIDACION = UNIDCAL_COMPL;
ELSE UNIDAD_LIQUIDACION = UNIDCAL_PRED; 
RUN; 

/* *******************************************************************************************************
/* SE SELECCIONA PREDIOS CON USOS MÚLTIPLES. */
/* *******************************************************************************************************/

DATA VISTA_USOS_MULTIPLES; SET UNIDAD_LIQUIDACION; /* SE SELECCIONA PREDIOS CON USOS MÚLTIPLES */
IF MODELO_0 IN ('USOS MULTIPLES') OR EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000;
RUN; 

/* *******************************************************************************************************/
/*SE ASIGNA LA VARIABLE MODELO POR USO PARA LOS USOS MÚLTIPLES. */
/* *******************************************************************************************************/

PROC SQL; 	CREATE TABLE VISTA_USOS_MULTIPLES_1  /*SE ASIGNA LA TABLA POR USO*/
AS	SELECT *,
	
CASE 
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (1) ) THEN 'M01_1' /*Residencial PH, estrato 1*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (2) ) THEN 'M01_2' /*Residencial PH, estrato 2*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (3) ) THEN 'M01_3' /*Residencial PH, estrato 3*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (4) ) THEN 'M02_4' /*Residencial PH, estrato 4*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (5) ) THEN 'M02_5' /*Residencial PH, estrato 5*/
WHEN (CODIGO_USO IN ('037','038') & CODIGO_ESTRATO IN (6) ) THEN 'M02_6' /*Residencial PH, estrato 6*/
WHEN (CODIGO_USO IN ('035','043','044','045','046','059','081','092') ) THEN 'M03' /*Oficinas PH*/
WHEN (CODIGO_USO IN ('039','040','060')) THEN 'M04' /*Comercio PH*/
WHEN (CODIGO_USO IN ('028','034','047','053','091','093','097')) THEN 'M05' /*Bodegas + Industria PH*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (1) & CLASE_PREDIO = 'P')  THEN 'M06_1' /*Bifamiliar estrato 1*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (2) & CLASE_PREDIO = 'P')  THEN 'M06_2' /*Bifamiliar estrato 2*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (3) & CLASE_PREDIO = 'P')  THEN 'M06_3' /*Bifamiliar estrato 3*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (4) & CLASE_PREDIO = 'P')  THEN 'M06_4' /*Bifamiliar estrato 4*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (5) & CLASE_PREDIO = 'P')  THEN 'M06_5' /*Bifamiliar estrato 5*/
WHEN (CODIGO_USO IN ('001','002','009','019','020','022') & CODIGO_ESTRATO IN (6) & CLASE_PREDIO = 'P')  THEN 'M06_6' /*Bifamiliar estrato 6*/

/*Tablas de Valor NPH*/

WHEN (CODIGO_USO IN ('001','002','009') & CLASE_PREDIO = 'N' & ARMAZON_ESTRUCTURA = '111' & MUROS_ESTRUCTURA = '121' ) THEN 'T24' /*Construcciones en material de desecho*/
WHEN (CODIGO_USO IN ('001','002','009') & CLASE_PREDIO = 'N' & ARMAZON_ESTRUCTURA = '112' & MUROS_ESTRUCTURA = '124' ) THEN 'T25' /*Construcciones en Prefabricado*/

/*T01 Residencial */ 
WHEN (CODIGO_USO IN ('001','002','009') & CLASE_PREDIO = 'N') THEN 'T01' /*Residencial*/
WHEN (CODIGO_USO IN ('012') & AREA_USO <= 350 & MAX_NUM_PISO <= 4) THEN 'T01' /*Residencial*/
WHEN (CODIGO_USO IN ('020') & CLASE_PREDIO = 'N' & CLASE_CONSTRUCCION = "R") THEN 'T01' /*Residencial*/
WHEN (CODIGO_USO IN ('058') & CLASE_PREDIO = 'N' & CLASE_CONSTRUCCION = "R") THEN 'T01' /*Residencial*/

/*T02 Adecuación Comercial*/
WHEN (CODIGO_USO IN ('003','004','056')) THEN 'T02' /*Adecuación Comercial*/

/*T03 Bodegas e Industria*/
WHEN (CODIGO_USO IN ('010','011','025','080')) THEN 'T03' /*Bodegas e Industria*/

/*T04 Bodega Económica */
WHEN (CODIGO_USO IN ('033')) THEN 'T04' /*Bodega Económica*/

/*T05 Oficinas*/
WHEN (CODIGO_USO IN ('020')& CLASE_PREDIO = 'N') THEN 'T05' /*Oficinas*/
WHEN (CODIGO_USO IN ('015','058')) THEN 'T05' /*Oficinas*/
WHEN (CLASE_CONSTRUCCION = "C" & CODIGO_USO IN ('020')& CLASE_PREDIO = 'N') THEN 'T05' /*Oficinas*/
WHEN (CLASE_CONSTRUCCION = "C" & CODIGO_USO IN ('015', '018', '029', '030', '058', '065', '067')) THEN 'T05' /*Oficinas*/


/*T06 Institucional*/
WHEN (((AREA_USO < 350 & MAX_NUM_PISO > 5) | (AREA_USO > 350)) & 
  CODIGO_USO IN ('012')) THEN 'T06' /*Institucional*/

/*T07 Depósitos*/
WHEN (CODIGO_USO IN ('022')& CLASE_PREDIO = 'N') THEN 'T07' /*Depósitos*/

/*T08 Colegios y Universidades 1-3 pisos*/
WHEN (CODIGO_USO IN ('013')) THEN 'T08' /*Colegios y Universidades 1-3 pisos*/

/*T09 Clínicas y Hospitales*/
WHEN (CODIGO_USO IN ('017')) THEN 'T09' /*Clínicas y Hospitales*/

/*T10 Aulas de Clase*/
WHEN (CODIGO_USO IN ('064')) THEN 'T10' /*Aulas de Clase*/

/*T11 Hoteles*/
WHEN (CODIGO_USO IN ('021')) THEN 'T11' /*Hoteles*/

/*T12 Edificio de Parqueo*/
WHEN (CODIGO_USO IN ('024')) THEN 'T12' /*Edificio de Parqueo*/

/*T13 Parqueadero NPH*/
WHEN (CODIGO_USO IN ('096')) THEN 'T13' /*Parqueadero NPH*/

/*T14 Oficinas Operativas*/
WHEN (CODIGO_USO IN ('005')) THEN 'T14' /*Oficinas Operativas*/

/*T15 Enramadas*/
WHEN (CODIGO_USO IN ('070')) THEN 'T15' /*Enramadas*/

/*T16 Anexos constructivos*/
WHEN (CODIGO_USO IN ('071','072','073','076','077')) THEN 'T16' /*Anexos constructivos*/

/*T17 Piscinas*/
WHEN (CODIGO_USO IN ('031')) THEN 'T17' /*Piscinas*/

/*T18 Coliseos*/
WHEN (CODIGO_USO IN ('032')) THEN 'T18' /*Coliseos*/

/*T19 Bodegas con Adecuación Comercial*/
WHEN (CODIGO_USO IN ('008','014','023')) THEN 'T19' /*Bodegas con Adecuación Comercial*/

/*T20 Moteles, amoblados, residencias*/
WHEN (CODIGO_USO IN ('026')) THEN 'T20' /*Moteles, amoblados, residencias*/

/*T26 Colegios y Universidades 4 o mas pisos*/
WHEN (CODIGO_USO IN ('016')) THEN 'T26' /*Colegios y Universidades 4 o mas pisos*/

WHEN (CODIGO_USO IN ('047','055','057','062','066','074','075','098')) THEN 'AV_ESP_USO' 
WHEN (CODIGO_USO IN ('006','007','041','042','094','095')) THEN 'AV_ESP_CC' 


/*1.2 Tablas de Valor PH*/

WHEN (CODIGO_USO IN ('048') ) THEN 'T21' /*Parqueo libre  PH */
WHEN (CODIGO_USO IN ('049')) THEN 'T22' /*Parqueo cubierto PH */
WHEN (CODIGO_USO IN ('050')) THEN 'T12' /* Edificio de parqueo PH */
WHEN (CODIGO_USO IN ('051')) THEN 'T23' /* Depósito (Lockers) PH */ 
WHEN (CODIGO_USO IN ('052')) THEN 'T17' /*Piscinas PH */
WHEN (CODIGO_USO IN ('082')) THEN 'T14' /*Oficinas operativas PH*/
WHEN (CODIGO_USO IN ('027')) THEN 'T20' /*Moteles, amoblados, residencias*/



ELSE 'M0'
		END AS MODELO_USO1

			FROM VISTA_USOS_MULTIPLES
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, CODIGO_USO,UNIDAD_CALIFICADA;
QUIT;

/**************************************************************************************************************/
/* AVALÚOS ESPECIALES "AV_ESP_TOP" POR UNIDAD CALIFICADA */
/**************************************************************************************************************/

DATA VISTA_USOS_MULTIPLES_2; SET VISTA_USOS_MULTIPLES_1; /* AVALÚOS ESPECIALES "AV_ESP_TOP" POR UNIDAD CALIFICADA */
IF MODELO_USO1 = 'T01' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T02' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T03' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T04' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T05' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T06' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T07' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T08' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T09' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T10' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T11' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T12' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T13' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T14' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T15' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T16' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T17' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T18' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T19' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T20' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 5000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T21' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T22' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 1000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T23' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T24' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T25' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 100000) THEN MODELO_USO1 = 'AV_ESP_TOP';
IF MODELO_USO1 = 'T26' AND (EDAD > 100 OR PUNTAJE > 100 OR AREA_USO > 10000) THEN MODELO_USO1 = 'AV_ESP_TOP';
RUN;


/**************************************************************************************************************/
/*PREDIOS QUE LIQUITARON POR USO MULTIPLE COMBINADO CON MODELO */
/**************************************************************************************************************/

DATA M0; SET VISTA_USOS_MULTIPLES_2;  /*PREDIOS QUE LIQUITARON POR USO MULTIPLE COMBINADO CON MODELO */
IF MODELO_USO1 IN 
('M01_1','M01_2','M01_3','M02_4','M02_5','M02_6','M03','M04','M05','M06_1','M06_2','M06_3','M06_4','M06_5','M06_6');
MODELO_PH = 1;
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO MODELO_PH;
RUN;

PROC SORT DATA=M0 NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO; RUN;

/**************************************************************************************************************/
/*PREDIOS QUE LIQUITARON POR USO MULTIPLE COMBINADO CON AVESP */
/**************************************************************************************************************/

DATA AV_ESP; SET VISTA_USOS_MULTIPLES_2; /*PREDIOS QUE LIQUITARON POR USO MULTIPLE COMBINADO CON AVESP */
IF MODELO_USO1 IN ('AV_ESP_USO','AV_ESP_CC','AV_ESP_TOP'); 
MODELO_AVES = 1;
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO MODELO_AVES; RUN;

PROC SORT DATA=AV_ESP NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO; RUN;

/**************************************************************************************************************/
/* SE PEGAN A LA BASE DE USOS MÚLTIPLES LAS VARIABLES CORRESPONDIENTES A PREDIOS DE USOS MÚLTIPLES QUE SE MEZCLAN CON MODELOS Y AVALÚOS ESPECIALES */
/*AV_ESP_MUL - Combinacion Model-Tabla*/
/**************************************************************************************************************/

PROC SQL; 
CREATE TABLE VISTA_USOS_MULTIPLES_DEF AS /* SE PEGAN A LA BASE DE USOS MÚLTIPLES LAS VARIABLES CORRESPONDIENTES A PREDIOS DE USOS MÚLTIPLES QUE SE MEZCLAN CON MODELOS Y AVALÚOS ESPECIALES */	
SELECT A.*, B.MODELO_PH,
CASE 
WHEN (B.MODELO_PH = 1) THEN 'AV_ESP_MUL'  /*AV_ESP_MUL - Combinacion Model-Tabla*/
ELSE MODELO_USO1 END AS MODELO_USO2,
C.MODELO_AVES
FROM VISTA_USOS_MULTIPLES_2 AS A LEFT JOIN M0 AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO
LEFT JOIN AV_ESP AS C
				ON	A.CODIGO_BARRIO = C.CODIGO_BARRIO &
					A.CODIGO_MANZANA = C.CODIGO_MANZANA &
					A.CODIGO_PREDIO = C.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = C.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = C.CODIGO_RESTO;
QUIT;



/**************************************************************************************************************/
/* SE PEGAN A LA BASE TOTAL DE PREDIOS LAS VARIABLES CORRESPONDIENTES A PREDIOS DE USOS MÚLTIPLES QUE SE MEZCLAN CON MODELOS Y AVALÚOS ESPECIALES */
/**************************************************************************************************************/

PROC SQL; 
CREATE TABLE VISTA_NUEVO_MODELO_D AS	 /* SE PEGAN A LA BASE TOTAL DE PREDIOS LAS VARIABLES CORRESPONDIENTES A PREDIOS DE USOS MÚLTIPLES QUE SE MEZCLAN CON MODELOS Y AVALÚOS ESPECIALES */
SELECT A.*,  B.MODELO_USO1 AS MODELO_USO_0,
B.MODELO_PH AS UM_MODELO_PH,
B.MODELO_AVES AS UM_MODELO_AVES, /*UM == USO MÚLTIPLE*/
CASE 
WHEN (B.MODELO_USO2 NE " ") THEN B.MODELO_USO2
ELSE A.MODELO_0
END AS MODELO_USO 
FROM UNIDAD_LIQUIDACION AS A 
LEFT JOIN VISTA_USOS_MULTIPLES_DEF AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO &
					A.CODIGO_USO = B.CODIGO_USO	&
					A.UNIDAD_CALIFICADA = B.UNIDAD_CALIFICADA &
					A.AREA_USO = B.AREA_USO &
					A.CLASE_CONSTRUCCION = B.CLASE_CONSTRUCCION ;
QUIT;


/**************************************************************************************************************/
/* SE CREA UNA VARIABLE AVESP_USOM CORRESPONDIENTE A LOS USOS CUYOS MODELOS SON "AV_ESP_MUL" Y "AV_ESP_USO" */
/**************************************************************************************************************/


DATA AVESP_USOM; SET VISTA_NUEVO_MODELO_D; /*PREDIOS QUE SE LIQUIDARON POR AVALUO ESPECIAL EN USO MULTIPLE --COMBINACIONES CON AVESP */
IF MODELO_USO IN ('AV_ESP_MUL', 'AV_ESP_USO'); 
IF MODELO_USO IN ('AV_ESP_MUL') THEN AVESP_USOM = 1;
IF MODELO_USO IN ('AV_ESP_USO') THEN AVESP_USOM = 2;
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO AVESP_USOM; 
RUN;

PROC SORT DATA = AVESP_USOM NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO; RUN;

PROC SQL; CREATE TABLE VISTA_NUEVO_MODELO_E AS	
		SELECT A.*, 
CASE WHEN (B.AVESP_USOM = .) THEN 0 ELSE B.AVESP_USOM END AS AVESP_USOM,
A.MODELO_0 AS MODELO_OR, A.MODELO_USO AS MODELO_USO_OR,
/*CASE WHEN (AVESP_USOM = 1) THEN "AV_ESP_MUL" ELSE A.MODELO_0 END AS MODELO_0,*/
ROUND(A.AREA_TERRENO, .01) AS AREA_TERRENO
			FROM VISTA_NUEVO_MODELO_D AS A LEFT JOIN AVESP_USOM AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO;
QUIT;

DATA VISTA_NUEVO_MODELO_E;
SET VISTA_NUEVO_MODELO_E;
IF AVESP_USOM = 1 THEN MODELO_0 = 'AV_ESP_MUL';
RUN;


/**************************************************************************************************************/
/* EL SIGUIENTE BLOQUE NO SE BORRA PORQUE RAÚL TIENE MIEDO Y DUDAS EXISTENCIALES */
/**************************************************************************************************************/

/*
DATA VISTA_NUEVO_MODELO_E;SET VISTA_NUEVO_MODELO_E0;
MODELO_OR = MODELO_0;
MODELO_USO_OR = MODELO_USO;
IF AVESP_USOM = 1 THEN MODELO_0 = 'AV_ESP_MUL';*/
/*IF AVESP_USOM=2 THEN MODELO_0='AV_ESP_USO'; este lo modifico segun documento version 5*/
/*IF (MODELO_USO='T01' AND AREA_TERRENO <49 AND MARCA_MANZANA=3) THEN MARCA_MANZANA=4; esta condición se supone que ya la tienen en cuenta en la tabla no hay necesidad de programarla*/
/*IF (MODELO_USO='T06' AND AREA_USO <350) THEN MODELO_USO='T01';
IF (MODELO_USO ='T05' AND CLASE_CONSTRUCCION = 'R')  THEN MODELO_USO='T01';
IF  (MODELO_0 ='T05' AND CLASE_CONSTRUCCION = 'R')  THEN MODELO_0='T01';
IF (MODELO_0='T06' AND AREA_USO <350) THEN MODELO_0='T01'; /*SE CAMBIO PORQUE INDICARON QUE ERA EL AREA DEL USO PREDOMINNANTE*/
/*AREA_TERRENO = ROUND(AREA_TERRENO, .01);
RUN;*/

/**************************************************************************************************************/
/* ATIPICOS DE COMERCIO Y OFICINAS. */
/**************************************************************************************************************/

PROC SQL;CREATE TABLE VISTA_NUEVO_MODELO_E1 AS SELECT A.*,
CASE WHEN (B.ATIP_OF_COM=1) THEN 1 ELSE 0 END  AS ATIP_OFI_COM
				FROM VISTA_NUEVO_MODELO_E AS A LEFT JOIN COMUN.MARCO_ATIPICOS_OFIC_COMER AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO;
QUIT;

/**************************************************************************************************************/
/* ASIGNACIÓN DE MODELOS POR ESTRATOS Y TABLAS ESPECIFICAS POR ESTRATO Y MARCA MANZANA. */
/**************************************************************************************************************/



DATA VISTA_NUEVO_MODELO_F;SET VISTA_NUEVO_MODELO_E; /* ASIGNACIÓN DE MODELOS POR ESTRATOS Y TABLAS ESPECIFICAS POR ESTRATO Y MARCA MANZANA. */

IF MODELO_0 = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 1 THEN MODELO_0 = 'T01-1'; 
IF MODELO_0 = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 2 THEN MODELO_0 = 'T01-2'; 
IF MODELO_0 = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 3 THEN MODELO_0 = 'T01-3'; 
IF MODELO_0 = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 4 THEN MODELO_0 = 'T01-4'; 
IF MODELO_0 = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 5 THEN MODELO_0 = 'T01-5'; 
IF MODELO_0 = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 6 THEN MODELO_0 = 'T01-6';
IF MODELO_0 = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 7 THEN MODELO_0 = 'T01-7';
IF MODELO_0 = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 8 THEN MODELO_0 = 'T01-8';

IF MODELO_0 = 'T01' AND ZHF12 = '1'  AND ZHF13 = '1' THEN MODELO_0 = 'T01-1'; 
IF MODELO_0 = 'T01' AND ZHF12 = '1'  AND ZHF13 = '2' THEN MODELO_0 = 'T01-2'; 
IF MODELO_0 = 'T01' AND ZHF12 = '1'  AND ZHF13 = '3' THEN MODELO_0 = 'T01-3'; 
IF MODELO_0 = 'T01' AND ZHF12 = '1'  AND ZHF13 = '4' THEN MODELO_0 = 'T01-4'; 
IF MODELO_0 = 'T01' AND ZHF12 = '1'  AND ZHF13 = '5' THEN MODELO_0 = 'T01-5'; 
IF MODELO_0 = 'T01' AND ZHF12 = '1'  AND ZHF13 = '6' THEN MODELO_0 = 'T01-6';
IF MODELO_0 = 'T01' AND ZHF12 = '1'  AND ZHF13 = '7' THEN MODELO_0 = 'T01-7'; 
IF MODELO_0 = 'T01' AND ZHF12 = '1'  AND ZHF13 = '8' THEN MODELO_0 = 'T01-8';

IF MODELO_0 = 'T02' AND MARCA_MANZANA IN (1,2,3) THEN MODELO_0 = 'T02-1'; 
IF MODELO_0 = 'T02' AND MARCA_MANZANA IN (4,5,8) THEN MODELO_0 = 'T02-2';
IF MODELO_0 = 'T02' AND MARCA_MANZANA IN (6) THEN MODELO_0 = 'T02-3';
IF MODELO_0 = 'T02' AND MARCA_MANZANA IN (7) THEN MODELO_0 = 'T02-4';
IF MODELO_0 = 'T05' AND MARCA_MANZANA IN (1,2,3) THEN MODELO_0 = 'T05-1'; 
IF MODELO_0 = 'T05' AND MARCA_MANZANA IN (4,5,8) THEN MODELO_0 = 'T05-2';
IF MODELO_0 = 'T05' AND MARCA_MANZANA IN (6) THEN MODELO_0 = 'T05-3';
IF MODELO_0 = 'T05' AND MARCA_MANZANA IN (7) THEN MODELO_0 = 'T05-4';

IF MODELO_USO = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 1 THEN MODELO_USO = 'T01-1'; 
IF MODELO_USO = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 2 THEN MODELO_USO = 'T01-2'; 
IF MODELO_USO = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 3 THEN MODELO_USO = 'T01-3'; 
IF MODELO_USO = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 4 THEN MODELO_USO = 'T01-4'; 
IF MODELO_USO = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 5 THEN MODELO_USO = 'T01-5'; 
IF MODELO_USO = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 6 THEN MODELO_USO = 'T01-6';
IF MODELO_USO = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 7 THEN MODELO_USO = 'T01-7';
IF MODELO_USO = 'T01' AND ZHF12 NE '1' AND MARCA_MANZANA = 8 THEN MODELO_USO = 'T01-8';

IF MODELO_USO = 'T01' AND ZHF12 = '1'  AND ZHF13 = '1' THEN MODELO_USO = 'T01-1'; 
IF MODELO_USO = 'T01' AND ZHF12 = '1'  AND ZHF13 = '2' THEN MODELO_USO = 'T01-2'; 
IF MODELO_USO = 'T01' AND ZHF12 = '1'  AND ZHF13 = '3' THEN MODELO_USO = 'T01-3'; 
IF MODELO_USO = 'T01' AND ZHF12 = '1'  AND ZHF13 = '4' THEN MODELO_USO = 'T01-4'; 
IF MODELO_USO = 'T01' AND ZHF12 = '1'  AND ZHF13 = '5' THEN MODELO_USO = 'T01-5'; 
IF MODELO_USO = 'T01' AND ZHF12 = '1'  AND ZHF13 = '6' THEN MODELO_USO = 'T01-6';
IF MODELO_USO = 'T01' AND ZHF12 = '1'  AND ZHF13 = '7' THEN MODELO_USO = 'T01-7'; 
IF MODELO_USO = 'T01' AND ZHF12 = '1'  AND ZHF13 = '8' THEN MODELO_USO = 'T01-8';

IF MODELO_USO = 'T02' AND MARCA_MANZANA IN (1,2,3) THEN MODELO_USO = 'T02-1'; 
IF MODELO_USO = 'T02' AND MARCA_MANZANA IN (4,5,8) THEN MODELO_USO = 'T02-2';
IF MODELO_USO = 'T02' AND MARCA_MANZANA =6 THEN MODELO_USO = 'T02-3';
IF MODELO_USO = 'T02' AND MARCA_MANZANA =7 THEN MODELO_USO = 'T02-4';
IF MODELO_USO = 'T05' AND MARCA_MANZANA IN (1,2,3) THEN MODELO_USO = 'T05-1'; 
IF MODELO_USO = 'T05' AND MARCA_MANZANA IN (4,5,8) THEN MODELO_USO = 'T05-2';
IF MODELO_USO = 'T05' AND MARCA_MANZANA IN (6) THEN MODELO_USO = 'T05-3';
IF MODELO_USO = 'T05' AND MARCA_MANZANA IN (7) THEN MODELO_USO = 'T05-4';

IF MODELO_0 IN ('M06_1','M06_2','M06_3') THEN MODELO_0 = 'M06_123';
IF MODELO_0 IN ('M06_4','M06_5','M06_6') THEN MODELO_0 = 'M06_456';
IF MODELO_USO IN ('M06_1','M06_2','M06_3') THEN MODELO_USO = 'M06_123';
IF MODELO_USO IN ('M06_4','M06_5','M06_6') THEN MODELO_USO = 'M06_456';
RUN;

/**************************************************************************************************************/
/* ASIGNACIÓN DE LOS NOMBRES DE LOS MODELOS. */
/**************************************************************************************************************/

PROC SQL; CREATE TABLE VISTA_MODELO_UNID_LIQ AS /* ASIGNACIÓN DE LOS NOMBRES DE LOS MODELOS. */
 SELECT A.*,
CASE
WHEN (A.MODELO_0 IN ('M01_1') )THEN "M01. Residencial PH, estrato 1"
WHEN (A.MODELO_0 IN ('M01_2') )THEN "M01. Residencial PH, estrato 2"
WHEN (A.MODELO_0 IN ('M01_3') )THEN "M01. Residencial PH, estrato 3"
WHEN (A.MODELO_0 IN ('M02_4') )THEN "M02. Residencial PH, estrato 4"
WHEN (A.MODELO_0 IN ('M02_5') )THEN "M02. Residencial PH, estrato 5"
WHEN (A.MODELO_0 IN ('M02_6') )THEN "M02. Residencial PH, estrato 6"
WHEN (A.MODELO_0 IN ('M03') )THEN "M03. Oficinas PH"
WHEN (A.MODELO_0 IN ('M04') )THEN "M04. Comercio PH"
WHEN (A.MODELO_0 IN ('M05') )THEN "M05. Bodegas + Industria PH"
WHEN (A.MODELO_0 IN ('M06_123') )THEN "M06. Bifamiliar, estrato 1, 2 y 3"
WHEN (A.MODELO_0 IN ('M06_456') )THEN "M06. Bifamiliar, estrato 4, 5 y 6"
WHEN (A.MODELO_0 IN ('T01-1') )THEN "T01_1. Residencial Tipo 1"
WHEN (A.MODELO_0 IN ('T01-2') )THEN "T01_2. Residencial Tipo 2"
WHEN (A.MODELO_0 IN ('T01-3') )THEN "T01_3. Residencial Tipo 3"
WHEN (A.MODELO_0 IN ('T01-4') )THEN "T01_4. Residencial Tipo 4"
WHEN (A.MODELO_0 IN ('T01-5') )THEN "T01_5. Residencial Tipo 5"
WHEN (A.MODELO_0 IN ('T01-6') )THEN "T01_6. Residencial Tipo 6"
WHEN (A.MODELO_0 IN ('T01-7') )THEN "T01_7. Residencial Tipo 7"
WHEN (A.MODELO_0 IN ('T01-8') )THEN "T01_8. Residencial Tipo 8"
WHEN (A.MODELO_0 IN ('T02-1') )THEN "T02_1. Adecuación Comercial Res Tipo 1"
WHEN (A.MODELO_0 IN ('T02-2') )THEN "T02_2. Adecuación Comercial Res Tipo 2"
WHEN (A.MODELO_0 IN ('T02-3') )THEN "T02_3. Adecuación Comercial Res Tipo 3"
WHEN (A.MODELO_0 IN ('T02-4') )THEN "T02_3. Adecuación Comercial Res Tipo 4"
WHEN (A.MODELO_0 IN ('T03') )THEN "T03. Bodegas e Industria"
WHEN (A.MODELO_0 IN ('T04') )THEN "T04. Bodega Económica"
WHEN (A.MODELO_0 IN ('T05-1') )THEN "T05_1. Oficinas Res Tipo 1"
WHEN (A.MODELO_0 IN ('T05-2') )THEN "T05_2. Oficinas Res Tipo 2"
WHEN (A.MODELO_0 IN ('T05-3') )THEN "T05_3. Oficinas Res Tipo 3"
WHEN (A.MODELO_0 IN ('T05-4') )THEN "T05_4. Oficinas Res Tipo 4"
WHEN (A.MODELO_0 IN ('T06') )THEN "T06. Institucional"
WHEN (A.MODELO_0 IN ('T07') )THEN "T07. Depósitos"
WHEN (A.MODELO_0 IN ('T08') )THEN "T08. Colegios y Universidades 1-3 Pisos"
WHEN (A.MODELO_0 IN ('T09') )THEN "T09. Clínicas y Hospitales"
WHEN (A.MODELO_0 IN ('T10') )THEN "T10. Aulas de Clase"
WHEN (A.MODELO_0 IN ('T11') )THEN "T11. Hoteles"
WHEN (A.MODELO_0 IN ('T12') )THEN "T12. Edificio de parqueo PH"
WHEN (A.MODELO_0 IN ('T13') )THEN "T13. Parqueadero NPH"
WHEN (A.MODELO_0 IN ('T14') )THEN "T14. Oficinas operativas PH"
WHEN (A.MODELO_0 IN ('T15') )THEN "T15. Enramadas"
WHEN (A.MODELO_0 IN ('T16') )THEN "T16. Anexos constructivos"
WHEN (A.MODELO_0 IN ('T17') )THEN "T17. Piscinas"
WHEN (A.MODELO_0 IN ('T18') )THEN "T18. Coliseos"
WHEN (A.MODELO_0 IN ('T19') )THEN "T19. Bodegas con Adecuación Comercial"
WHEN (A.MODELO_0 IN ('T20') )THEN "T20. Moteles, amoblados, residencias"
WHEN (A.MODELO_0 IN ('T21') )THEN "T21. Parqueo libre PH"
WHEN (A.MODELO_0 IN ('T22') )THEN "T22. Parqueo cubierto PH"
WHEN (A.MODELO_0 IN ('T23') )THEN "T23. Depósito (Lockers) PH"
WHEN (A.MODELO_0 IN ('T24') )THEN "T24. Complemento Residencial Material Desecho" 
WHEN (A.MODELO_0 IN ('T25') )THEN "T25. Complemento Residencial Material Prefabricado" 
WHEN (A.MODELO_0 IN ('T26') )THEN "T26. Colegios y Universidades 4 Pisos o más"
WHEN (A.MODELO_0 IN ('LOTES_PH')) THEN "LOTES_PH"
WHEN (A.MODELO_0 IN ('LOTES_NPH')) THEN "LOTES_NPH"
/*WHEN (A.MODELO_0 IN ('LOTES_30')) THEN "LOTES_30"*/
WHEN (A.MODELO_0 IN ('AV_ESP_BIC')) THEN "AV_ESP_BIC - Bienes Interés Cultural"
WHEN (A.MODELO_0 IN ('AV_ESP_USO')) THEN "AV_ESP_USO - Usos Especiales"
WHEN (A.MODELO_0 IN ('AV_ESP_CC')) THEN  "AV_ESP_CC - Centro Comercial"
WHEN (A.MODELO_0 IN ('PRED_CESP')) THEN  "PRED_CESP - Predios Especiales"
WHEN (A.MODELO_0 IN ('AV_ESP_TOP')) THEN  "AV_ESP_TOP - Predios Especiales"
WHEN (A.MODELO_0 IN ('AV_ESP_MUL')) THEN "AV_ESP_MUL - Combinacion Model-Tabla"
WHEN (A.MODELO_0 IN ('USOS MULTIPLES')) THEN "Usos Múltiples"

ELSE 'M0'
		END AS NOMBRE_MODELO_0 
		  FROM VISTA_NUEVO_MODELO_F AS A;
QUIT;


/**************************************************************************************************************/
/* VARIABLE DE ACTUALIZADO. */
/**************************************************************************************************************/

PROC SQL; 	CREATE TABLE PRUEBA.VISTA_MODELO_UNID_LIQ AS/* VARIABLE DE ACTUALIZADO. */
SELECT A.*, 
CASE WHEN (B.FASE2=1) THEN 1 ELSE 0 END  AS ACTUALIZADO
				FROM  VISTA_MODELO_UNID_LIQ  AS A
 				LEFT JOIN (SELECT *, 1 AS FASE2 FROM ODBCLIB.ACT_DEPENDENCIA_BARRIOS) AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO  ;
QUIT;



/**************************************************************************************************************/
/* SE SELECCIONAN LOS PREDIOS A LIQUIDAR POR UNIDAD CALIFICADA. */
/**************************************************************************************************************/

/* Esta linea está sujeta a cambios. */
/* SE COMENTÓ LA LINEA PORQUE LA ASIGNACIÓN DE VALORES UNITARIOS SE VA A REALIZAR POR UNIDAD CALIFICADA*/
DATA PRUEBA.BD_PREDIOS_MAS_USOMU; SET PRUEBA.VISTA_MODELO_UNID_LIQ; /* SE SELECCIONAN LOS PREDIOS A LIQUIDAR POR UNIDAD CALIFICADA. */
/*IF MODELO_0 IN ('USOS MULTIPLES') OR (MODELO_0 NOT IN ('USOS MULTIPLES') AND UNIDAD_LIQUIDACION =1); */
RUN; 



/**************************************************************************************************************/
								/* PROGRAMACION TABLAS NPH */
/**************************************************************************************************************/

/**************************************************************************************************************/
/* ASIGNACIÓN DE CORRELATIVA TABLAS NPH SISTEMAS */
/**************************************************************************************************************/



DATA PRUEBA.BD_PREDIOS_MAS_USOMU_V2 ;SET PRUEBA.BD_PREDIOS_MAS_USOMU; /*CORRELATIVA TABLAS NPH SISTEMAS*/

AREA_CONSTRUIDA = ROUND(AREA_CONSTRUIDA, .01);
AREA_USO = ROUND(AREA_USO, .01);
AREA_TERRENO = ROUND(AREA_TERRENO, .01);

IF MODELO_USO = 'T01-1' THEN  EC_MO_ID = 388 ;
IF MODELO_USO = 'T01-2' THEN  EC_MO_ID = 389 ;
IF MODELO_USO = 'T01-3' THEN  EC_MO_ID = 390 ;
IF MODELO_USO = 'T01-4' THEN  EC_MO_ID = 391 ;
IF MODELO_USO = 'T01-5' THEN  EC_MO_ID = 392 ;
IF MODELO_USO = 'T01-6' THEN  EC_MO_ID = 393 ;
IF MODELO_USO = 'T01-7' THEN  EC_MO_ID = 394 ;
IF MODELO_USO = 'T01-8' THEN  EC_MO_ID = 483 ;

IF MODELO_USO = 'T02-1' THEN  EC_MO_ID = 395 ;
IF MODELO_USO = 'T02-2' THEN  EC_MO_ID = 396 ;
IF MODELO_USO = 'T02-3' THEN  EC_MO_ID = 397 ;
IF MODELO_USO = 'T02-4' THEN  EC_MO_ID = 503 ;

IF MODELO_USO = 'T05-1' THEN  EC_MO_ID = 398 ;
IF MODELO_USO = 'T05-2' THEN  EC_MO_ID = 399 ;
IF MODELO_USO = 'T05-3' THEN  EC_MO_ID = 400 ;
IF MODELO_USO = 'T05-4' THEN  EC_MO_ID = 523 ;

IF MODELO_USO = 'T03' THEN  EC_MO_ID = 283;
IF MODELO_USO = 'T04' THEN  EC_MO_ID = 284;
IF MODELO_USO = 'T06' THEN  EC_MO_ID = 286;
IF MODELO_USO = 'T07' THEN  EC_MO_ID = 287;
IF MODELO_USO = 'T08' THEN  EC_MO_ID = 288;
IF MODELO_USO = 'T09' THEN  EC_MO_ID = 289;
IF MODELO_USO = 'T10' THEN  EC_MO_ID = 290;
IF MODELO_USO = 'T11' THEN  EC_MO_ID = 291;
IF MODELO_USO = 'T12' THEN  EC_MO_ID = 292;
IF MODELO_USO = 'T13' THEN  EC_MO_ID = 6;
IF MODELO_USO = 'T14' THEN  EC_MO_ID = 7;
IF MODELO_USO = 'T15' THEN  EC_MO_ID = 8;
IF MODELO_USO = 'T16' THEN  EC_MO_ID = 9;
IF MODELO_USO = 'T17' THEN  EC_MO_ID = 42;
IF MODELO_USO = 'T18' THEN  EC_MO_ID = 11;
IF MODELO_USO = 'T19' THEN  EC_MO_ID = 12;
IF MODELO_USO = 'T20' THEN  EC_MO_ID = 13;
IF MODELO_USO = 'T21' THEN  EC_MO_ID = 14;
IF MODELO_USO = 'T22' THEN  EC_MO_ID = 15;
IF MODELO_USO = 'T23' THEN  EC_MO_ID = 16;
IF MODELO_USO = 'T24' THEN  EC_MO_ID = 17;
IF MODELO_USO = 'T25' THEN  EC_MO_ID = 50;
IF MODELO_USO = 'T26' THEN  EC_MO_ID = 51;
IF MODELO_USO = 'T27' THEN  EC_MO_ID = 52;
IF MODELO_USO = 'T28' THEN  EC_MO_ID = 221;

IF MODELO_0 IN ('T01-1', 'T01-2', 'T01-3', 'T01-4', 'T01-5', 'T01-6', 'T01-7','T01-8', 'T02-1', 'T02-2', 'T02-3', 'T03', 
'T04', 'T05-1', 'T05-2', 'T05-3', 'T06', 'T07', 'T08', 'T09', 'T10', 'T11', 'T12', 'T13', 'T14', 'T15', 'T16', 
'T17', 'T18', 'T19', 'T20', 'T21', 'T22', 'T23', 'T24', 'T25', 'T26', 'USOS MULTIPLES') THEN LIQUIDACION='TABLA';
IF MODELO_0 IN ('AV_ESP_USO', 'AV_ESP_CC', 'AV_ESP_BIC', 'PRED_CESP', 'AV_ESP_TOP','AV_ESP_MUL', 'AV_COMER','AV_ESP_TAB','AV_ESP_MOD', 'AV_ESP_IND', 'REVIS_CAT','AUTO_AV_CAT') THEN LIQUIDACION='AVESP';
IF MODELO_0 IN ('LOTES_NPH','LOTES_PH') THEN LIQUIDACION='LOTES';
IF MODELO_0 IN ('M01_1', 'M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6', 'M03', 'M04','M05','M06_123','M06_456') THEN LIQUIDACION='MODEL';
RUN;
/*
proc import datafile = "\\prowin04\cavellaneda\EJERCICIOS\EJERCICIOS 2021\VERIFICACION_CALCULOS\210923_CONSTRUCCION_INSUMO_SIE_TABLAS_VALOR\output\210924_ARCHIVO_CARGUE_VR_UNIT_ESTADISTICA.xlsx"
 out  =  CONSOLIDADO_TABLAS_VALORES
 dbms  =  xlsx
 replace;
 sheet  =  "Consolidado_est";
run;
*/
proc import file="\\prowin04\cavellaneda\EJERCICIOS\EJERCICIOS 2021\VERIFICACION_CALCULOS\210923_CONSTRUCCION_INSUMO_SIE_TABLAS_VALOR\output\211112_RESULTADO_BASE_VALORES_NPH_TABLAS_SAS.csv"
    out = CONSOLIDADO_TABLAS_VALORES
    dbms = csv;
run;
 

PROC SQL;
CREATE TABLE PRUEBA.BD_PREDIOS_MAS_USOMU_V3 AS SELECT *,
CASE WHEN MODELO_USO IN ("T01-1", "T01-2", "T01-3", "T01-4", "T01-5", "T01-6", "T01-7", "T01-8") THEN ""
WHEN MODELO_USO IN ("T02-1", "T02-2", "T02-3", "T02-4", "T03", "T04", "T05-1", "T05-2", "T05-3", "T05-4", "T06", "T07", "T19") THEN CODIGO_USOP
END AS CODIGO_USO_TABLAS,
CASE WHEN MODELO_USO IN ("T01-1", "T01-2", "T01-3", "T01-4", "T01-5", "T01-6", "T01-7", "T01-8", "T03", "T04", "T06", "T07", "T19") THEN .
WHEN MODELO_USO IN ("T02-1", "T02-2", "T02-3", "T02-4", "T03", "T04", "T05-1", "T05-2", "T05-3", "T05-4") THEN MARCA_MANZANA
END AS MARCA_MANZANA_TABLAS,
CASE WHEN (MODELO_USO = "T01-2") AND (AREA_TERRENO >= 0 AND AREA_TERRENO <= 48.99) THEN "0,01-48,99"
WHEN (MODELO_USO = "T01-2") AND (AREA_TERRENO >= 49 AND AREA_TERRENO <= 100000000) THEN "49-100000000"
ELSE "            " END AS AREA_TERRENO_TABLAS,
CASE WHEN (MODELO_USO = "T03") AND (AREA_USO >= 0 AND AREA_USO <= 350) THEN "0-350"
WHEN (MODELO_USO = "T03") AND (AREA_USO >= 350.01 AND AREA_USO <= 1000) THEN "350,01-1000"
WHEN (MODELO_USO = "T03") AND (AREA_USO >= 1000 AND AREA_USO <= 6000) THEN "1000,01-6000" 
WHEN (MODELO_USO = "T03") AND (AREA_USO >= 6000 AND AREA_USO <= 1000000) THEN "6000,01-1000000"
WHEN (MODELO_USO = "T06") AND (AREA_USO >= 350 AND AREA_USO <= 500) THEN "350-500"
WHEN (MODELO_USO = "T06") AND (AREA_USO >= 500.01 AND AREA_USO <= 750) THEN "500,01-750"
WHEN (MODELO_USO = "T06") AND (AREA_USO >= 750.01 AND AREA_USO <= 2000) THEN "750,01-2000"
WHEN (MODELO_USO = "T06") AND (AREA_USO >= 2000.01 AND AREA_USO <= 5000) THEN "2000,01-5000"
WHEN (MODELO_USO = "T06") AND (AREA_USO >= 5000.01 AND AREA_USO <= 10000) THEN "5000,01-10000"
WHEN (MODELO_USO = "T19") AND (AREA_USO >= 0 AND AREA_USO <= 350) THEN "0-350"
WHEN (MODELO_USO = "T19") AND (AREA_USO >= 350.01 AND AREA_USO <= 1000) THEN "350,01-1000"
WHEN (MODELO_USO = "T19") AND (AREA_USO >= 1000.01 AND AREA_USO <= 6000) THEN "1000,01-6000"
WHEN (MODELO_USO = "T19") AND (AREA_USO >= 6000.01 AND AREA_USO <= 100000) THEN "6000,01-100000"
WHEN (MODELO_USO = "T07") AND (AREA_USO >= 0 AND AREA_USO <= 100) THEN "0-100"
WHEN (MODELO_USO = "T07") AND (AREA_USO >= 100.01 AND AREA_USO <= 350) THEN "100,01-350"
WHEN (MODELO_USO = "T07") AND (AREA_USO >= 350.01 AND AREA_USO <= 100000) THEN "350,01-100000"
ELSE "" END AS AREA_USO_TABLAS
FROM PRUEBA.BD_PREDIOS_MAS_USOMU_V2;
QUIT;

proc sql;
CREATE TABLE PRUEBA.PREDIOS_VALORES_TABLAS_NPH AS SELECT A.*, B.VAL_METRO_CUAD AS VALOR_UNITARIO_&VIGENCIA.
FROM PRUEBA.BD_PREDIOS_MAS_USOMU_V3 AS A 
LEFT JOIN CONSOLIDADO_TABLAS_VALORES AS B
ON A.MODELO_USO = B.tabla AND
A.PUNTAJE = B.PUNTAJE1 AND 
A.EDAD = B.EDAD_PREDIO1 AND 
A.CODIGO_USO_TABLAS = B.CODIGO_USO AND 
A.MARCA_MANZANA_TABLAS = B.TIPO_CARACT_RES AND 
A.AREA_TERRENO_TABLAS = B.AREA_TERRENO AND 
A.AREA_USO_TABLAS = B.AREA_USO;
QUIT;



DATA PRUEBA.PREDIOS_VALORES_TABLAS_NPH;
SET PRUEBA.PREDIOS_VALORES_TABLAS_NPH;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (0<=EDAD<=10) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 860000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (11<=EDAD<=30) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 750000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (31<=EDAD<=50) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 510000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (51<=EDAD<=100) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 330000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (0<=EDAD<=10) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1010000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (11<=EDAD<=30) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 890000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (31<=EDAD<=50) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 600000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (51<=EDAD<=100) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 390000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1530000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1350000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 750000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 590000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (0<=EDAD<=10) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1760000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (11<=EDAD<=30) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1550000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (31<=EDAD<=50) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1050000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (51<=EDAD<=100) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 680000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1900000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1670000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1140000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (0<=AREA_USO<=299.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 730000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (0<=EDAD<=10) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1070000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (11<=EDAD<=30) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 940000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (31<=EDAD<=50) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 640000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (51<=EDAD<=100) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 410000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (0<=EDAD<=10) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1160000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (11<=EDAD<=30) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1020000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (31<=EDAD<=50) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 690000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (51<=EDAD<=100) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 450000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1400000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1230000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 830000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 540000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (0<=EDAD<=10) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1950000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (11<=EDAD<=30) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1720000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (31<=EDAD<=50) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1160000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (51<=EDAD<=100) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 750000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2770000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2430000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1650000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (300<=AREA_USO<=749.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1060000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (0<=EDAD<=10) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1030000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (11<=EDAD<=30) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 910000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (31<=EDAD<=50) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 620000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (51<=EDAD<=100) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 400000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (0<=EDAD<=10) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1170000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (11<=EDAD<=30) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1030000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (31<=EDAD<=50) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 700000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (51<=EDAD<=100) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 450000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1400000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1230000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 880000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 540000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (0<=EDAD<=10) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2000000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (11<=EDAD<=30) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1760000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (31<=EDAD<=50) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1190000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (51<=EDAD<=100) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 770000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2490000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2190000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1490000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (750<=AREA_USO<=1999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 960000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (0<=EDAD<=10) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1100000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (11<=EDAD<=30) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 970000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (31<=EDAD<=50) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 660000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (51<=EDAD<=100) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 420000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (0<=EDAD<=10) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1180000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (11<=EDAD<=30) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1040000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (31<=EDAD<=50) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 710000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=45) AND (51<=EDAD<=100) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 460000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1410000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1240000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 840000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (46<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 540000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (0<=EDAD<=10) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1620000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (11<=EDAD<=30) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1420000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (31<=EDAD<=50) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 970000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=64) AND (51<=EDAD<=100) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 620000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1530000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1340000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 910000;
IF MODELO_USO = 'T08' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (2000<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 590000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2790000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2420000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (31<=EDAD<=100) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1710000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (0<=EDAD<=10) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2530000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (11<=EDAD<=30) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2190000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (31<=EDAD<=100) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1740000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2850000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2470000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (31<=EDAD<=100) AND (0<=AREA_USO<=999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1740000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2370000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2050000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (31<=EDAD<=100) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1620000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (0<=EDAD<=10) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2160000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (11<=EDAD<=30) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1870000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (31<=EDAD<=100) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1480000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2430000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2110000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (31<=EDAD<=100) AND (1000<=AREA_USO<=4999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1670000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3100000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2690000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (31<=EDAD<=100) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2130000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (0<=EDAD<=10) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2840000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (11<=EDAD<=30) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2450000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=75) AND (31<=EDAD<=100) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1730000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3190000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2770000;
IF MODELO_USO = 'T09' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (31<=EDAD<=100) AND (5000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2190000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (0<=EDAD<=10) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 610000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (11<=EDAD<=30) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 540000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (31<=EDAD<=100) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 370000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=64) AND (0<=EDAD<=10) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 730000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=64) AND (11<=EDAD<=30) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 650000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=64) AND (31<=EDAD<=100) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 500000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 920000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 810000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (31<=EDAD<=100) AND (0<=AREA_USO<=100) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 560000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (0<=EDAD<=10) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 840000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (11<=EDAD<=30) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 750000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=33) AND (31<=EDAD<=100) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 570000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=64) AND (0<=EDAD<=10) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 990000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=64) AND (11<=EDAD<=30) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 880000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (34<=PUNTAJE<=64) AND (31<=EDAD<=100) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 670000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1280000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1140000;
IF MODELO_USO = 'T10' AND (0<=MARCA_MANZANA<=8) AND (65<=PUNTAJE<=100) AND (31<=EDAD<=100) AND (100.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 870000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1910000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1650000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1170000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 950000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2670000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2310000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1830000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1490000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3020000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2610000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1840000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1490000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1260000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1090000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 870000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 700000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2110000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1820000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1450000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1170000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2380000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2060000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1630000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1320000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1620000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1400000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1110000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 900000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2700000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2340000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1650000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1340000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3050000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2640000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2090000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1700000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1670000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1470000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1150000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 930000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2790000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2420000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1710000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1380000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3150000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2730000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1930000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1560000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2240000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1940000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1370000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1110000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3730000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3230000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2280000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1850000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 4150000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3590000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2530000;
IF MODELO_USO = 'T11' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2050000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=30) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 610000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=30) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 530000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=30) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 380000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=30) AND (51<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 260000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=60) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 670000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=60) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 580000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=60) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 410000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=60) AND (51<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 280000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 690000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 600000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 430000;
IF MODELO_USO = 'T12' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 290000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=30) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 500000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=30) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 440000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=30) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 310000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=30) AND (51<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 160000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=60) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 690000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=60) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 630000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=60) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 490000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=60) AND (51<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 340000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 960000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 880000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 680000;
IF MODELO_USO = 'T13' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 470000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (0<=EDAD<=10) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 600000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (11<=EDAD<=20) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 540000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (21<=EDAD<=100) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 400000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (0<=EDAD<=10) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 610000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (11<=EDAD<=20) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 550000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (21<=EDAD<=100) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 400000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 720000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (11<=EDAD<=20) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 640000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (21<=EDAD<=100) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 470000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 810000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (11<=EDAD<=20) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 720000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (21<=EDAD<=100) AND (0<=AREA_USO<=24.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 530000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (0<=EDAD<=10) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 830000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (11<=EDAD<=20) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 740000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (21<=EDAD<=100) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 550000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (0<=EDAD<=10) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 820000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (11<=EDAD<=20) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 730000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (21<=EDAD<=100) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 540000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 930000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (11<=EDAD<=20) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 820000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (21<=EDAD<=100) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 610000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 990000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (11<=EDAD<=20) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 880000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (21<=EDAD<=100) AND (25<=AREA_USO<=44.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 650000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (0<=EDAD<=10) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1110000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (11<=EDAD<=20) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 980000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (21<=EDAD<=100) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 730000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (0<=EDAD<=10) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1150000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (11<=EDAD<=20) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1030000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (21<=EDAD<=100) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 760000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1130000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (11<=EDAD<=20) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1010000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (21<=EDAD<=100) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 750000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1250000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (11<=EDAD<=20) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1120000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (21<=EDAD<=100) AND (45<=AREA_USO<=99.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 830000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (0<=EDAD<=10) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 950000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (11<=EDAD<=20) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 850000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=17) AND (21<=EDAD<=100) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 630000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (0<=EDAD<=10) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1020000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (11<=EDAD<=20) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 910000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (18<=PUNTAJE<=25) AND (21<=EDAD<=100) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 670000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1120000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (11<=EDAD<=20) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 990000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (26<=PUNTAJE<=40) AND (21<=EDAD<=100) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 740000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1180000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (11<=EDAD<=20) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1050000;
IF MODELO_USO = 'T14' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=100) AND (21<=EDAD<=100) AND (100<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 780000;
IF MODELO_USO = 'T15' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=20) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 69000;
IF MODELO_USO = 'T15' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=35) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 147000;
IF MODELO_USO = 'T15' AND (0<=MARCA_MANZANA<=8) AND (36<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 283000;
IF MODELO_USO = 'T16' AND CODIGO_USO IN ('071','072','073') AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=15) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 44000;
IF MODELO_USO = 'T16' AND CODIGO_USO IN ('071','072','073') AND (0<=MARCA_MANZANA<=8) AND (16<=PUNTAJE<=32) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 59000;
IF MODELO_USO = 'T16' AND CODIGO_USO IN ('071','072','073') AND (0<=MARCA_MANZANA<=8) AND (33<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 77000;
IF MODELO_USO = 'T16' AND CODIGO_USO IN ('076') AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=20) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 90000;
IF MODELO_USO = 'T16' AND CODIGO_USO IN ('076') AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=42) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 235000;
IF MODELO_USO = 'T16' AND CODIGO_USO IN ('076') AND (0<=MARCA_MANZANA<=8) AND (43<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 740000;
IF MODELO_USO = 'T16' AND CODIGO_USO IN ('077') AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1180000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=48) AND (0<=EDAD<=100) AND (0<=AREA_USO<=349.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 780000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=48) AND (0<=EDAD<=100) AND (350<=AREA_USO<=1499.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1780000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=48) AND (0<=EDAD<=100) AND (1500<=AREA_USO<=7999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1338000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=48) AND (0<=EDAD<=100) AND (8000<=AREA_USO<=11999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1710000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=48) AND (0<=EDAD<=100) AND (12000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2440000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (49<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=349.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 970000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (49<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (350<=AREA_USO<=1499.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1390000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (49<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (1500<=AREA_USO<=7999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1520000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (49<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (8000<=AREA_USO<=11999.99) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1940000;
IF MODELO_USO = 'T18' AND (0<=MARCA_MANZANA<=8) AND (49<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (12000<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2880000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1290000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (11<=EDAD<=30) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1120000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (31<=EDAD<=50) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 790000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (51<=EDAD<=100) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 640000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1870000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1620000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1140000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 930000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2030000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1760000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1390000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1130000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2260000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1960000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1550000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (0<=AREA_USO<=500) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1260000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1400000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (11<=EDAD<=30) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1210000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (31<=EDAD<=50) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 960000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (51<=EDAD<=100) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 780000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1850000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1600000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1270000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1030000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2030000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1750000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1390000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1130000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2250000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1950000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1550000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (500.01<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1250000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1700000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1470000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1160000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (51<=EDAD<=100) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 940000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2240000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1940000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1540000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1240000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2450000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2120000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1680000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1360000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2720000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2360000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1870000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (1000.01<=AREA_USO<=2000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1520000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2040000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (11<=EDAD<=30) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1760000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (31<=EDAD<=50) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1400000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (51<=EDAD<=100) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1130000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (0<=EDAD<=10) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2690000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (11<=EDAD<=30) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2330000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (31<=EDAD<=50) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1780000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=55) AND (51<=EDAD<=100) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1420000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (0<=EDAD<=10) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2940000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (11<=EDAD<=30) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2550000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (31<=EDAD<=50) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1840000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (56<=PUNTAJE<=65) AND (51<=EDAD<=100) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1460000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 3270000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2830000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1930000;
IF MODELO_USO = 'T20' AND (0<=MARCA_MANZANA<=8) AND (66<=PUNTAJE<=100) AND (51<=EDAD<=100) AND (2000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1680000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 3100000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 3400000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 3800000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 4100000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 4600000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 5000000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 5000000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 3200000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 3500000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 3900000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 4400000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 4800000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 6100000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 6100000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 7000000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 7500000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 9700000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 13400000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 17200000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 22400000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 22400000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 10200000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 10900000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 14100000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 19400000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 24900000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 32500000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 32500000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 15400000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 17100000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 23300000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 32200000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 39900000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 54700000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 54700000;
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*7400000);
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*7800000);
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*11200000);
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*14700000);
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*18800000);
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*23500000);
IF MODELO_USO = 'T21' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*23500000);
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 4100000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 4500000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 5000000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 5500000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 6100000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 6700000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (0<=AREA_CONSTRUIDA<=1.3) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 6700000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 4200000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 4700000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 5200000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 5800000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 6426000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 8169000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (1.31<=AREA_CONSTRUIDA<=2.5) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 8169000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 11500000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 10800000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 16000000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 16800000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 21600000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 27000000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (2.51<=AREA_CONSTRUIDA<=12.5) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 27000000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 16600000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 15600000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 23200000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 24400000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 31300000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 39200000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (12.51<=AREA_CONSTRUIDA<=20) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 39200000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = 24800000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = 24700000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = 34100000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = 42600000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = 52400000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = 65200000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (20.01<=AREA_CONSTRUIDA<=35) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = 65200000;
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (1<=CODIGO_ESTRATO<=1) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*11500000);
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (2<=CODIGO_ESTRATO<=2) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*11800000);
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (3<=CODIGO_ESTRATO<=3) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*15500000);
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (4<=CODIGO_ESTRATO<=4) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*16600000);
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (5<=CODIGO_ESTRATO<=5) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*22000000);
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (6<=CODIGO_ESTRATO<=6) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*26800000);
IF MODELO_USO = 'T22' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=1000) AND (0<=EDAD<=1000) AND (35.01<=AREA_CONSTRUIDA<=100000) AND (0<=CODIGO_ESTRATO<=0) THEN PRODUCTO_2022 = (((AREA_USO)/17.5)*26800000);
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=3) AND (1<=CODIGO_ESTRATO<=1) THEN VALOR_UNITARIO_2022 = 1800000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (3.01<=AREA_USO<=5) AND (1<=CODIGO_ESTRATO<=1) THEN VALOR_UNITARIO_2022 = 1700000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (5.01<=AREA_USO<=10) AND (1<=CODIGO_ESTRATO<=1) THEN VALOR_UNITARIO_2022 = 1000000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (10.01<=AREA_USO<=1000000) AND (1<=CODIGO_ESTRATO<=1) THEN VALOR_UNITARIO_2022 = 600000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=3) AND (2<=CODIGO_ESTRATO<=2) THEN VALOR_UNITARIO_2022 = 1300000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (3.01<=AREA_USO<=5) AND (2<=CODIGO_ESTRATO<=2) THEN VALOR_UNITARIO_2022 = 1200000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (5.01<=AREA_USO<=10) AND (2<=CODIGO_ESTRATO<=2) THEN VALOR_UNITARIO_2022 = 800000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (10.01<=AREA_USO<=1000000) AND (2<=CODIGO_ESTRATO<=2) THEN VALOR_UNITARIO_2022 = 400000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=3) AND (3<=CODIGO_ESTRATO<=3) THEN VALOR_UNITARIO_2022 = 1300000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (3.01<=AREA_USO<=5) AND (3<=CODIGO_ESTRATO<=3) THEN VALOR_UNITARIO_2022 = 1200000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (5.01<=AREA_USO<=10) AND (3<=CODIGO_ESTRATO<=3) THEN VALOR_UNITARIO_2022 = 800000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (10.01<=AREA_USO<=1000000) AND (3<=CODIGO_ESTRATO<=3) THEN VALOR_UNITARIO_2022 = 400000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=3) AND (4<=CODIGO_ESTRATO<=4) THEN VALOR_UNITARIO_2022 = 2000000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (3.01<=AREA_USO<=5) AND (4<=CODIGO_ESTRATO<=4) THEN VALOR_UNITARIO_2022 = 1800000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (5.01<=AREA_USO<=10) AND (4<=CODIGO_ESTRATO<=4) THEN VALOR_UNITARIO_2022 = 1100000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (10.01<=AREA_USO<=1000000) AND (4<=CODIGO_ESTRATO<=4) THEN VALOR_UNITARIO_2022 = 700000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=3) AND (5<=CODIGO_ESTRATO<=5) THEN VALOR_UNITARIO_2022 = 2100000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (3.01<=AREA_USO<=5) AND (5<=CODIGO_ESTRATO<=5) THEN VALOR_UNITARIO_2022 = 1800000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (5.01<=AREA_USO<=10) AND (5<=CODIGO_ESTRATO<=5) THEN VALOR_UNITARIO_2022 = 1100000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (10.01<=AREA_USO<=1000000) AND (5<=CODIGO_ESTRATO<=5) THEN VALOR_UNITARIO_2022 = 800000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=3) AND (6<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2500000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (3.01<=AREA_USO<=5) AND (6<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2200000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (5.01<=AREA_USO<=10) AND (6<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1300000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (10.01<=AREA_USO<=1000000) AND (6<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 800000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=3) AND (0<=CODIGO_ESTRATO<=0) THEN VALOR_UNITARIO_2022 = 2500000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (3.01<=AREA_USO<=5) AND (0<=CODIGO_ESTRATO<=0) THEN VALOR_UNITARIO_2022 = 2200000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (5.01<=AREA_USO<=10) AND (0<=CODIGO_ESTRATO<=0) THEN VALOR_UNITARIO_2022 = 1300000;
IF MODELO_USO = 'T23' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (10.01<=AREA_USO<=1000000) AND (0<=CODIGO_ESTRATO<=0) THEN VALOR_UNITARIO_2022 = 800000;
IF MODELO_USO = 'T24' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (0<=EDAD<=100) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 39000;
IF MODELO_USO = 'T24' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (0<=EDAD<=100) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 56000;
IF MODELO_USO = 'T24' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=100) AND (0<=EDAD<=100) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 78000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (0<=EDAD<=5) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 283000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (0<=EDAD<=5) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 414000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=30) AND (0<=EDAD<=5) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 545000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=100) AND (0<=EDAD<=5) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 676000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (6<=EDAD<=10) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 244000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (6<=EDAD<=10) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 356000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=30) AND (6<=EDAD<=10) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 468000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=100) AND (6<=EDAD<=10) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 581000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (11<=EDAD<=15) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 205000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (11<=EDAD<=15) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 300000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=30) AND (11<=EDAD<=15) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 396000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=100) AND (11<=EDAD<=15) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 491000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (16<=EDAD<=20) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 168000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (16<=EDAD<=20) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 247000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=30) AND (16<=EDAD<=20) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 325000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=100) AND (16<=EDAD<=20) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 402000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (21<=EDAD<=25) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 119000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (21<=EDAD<=25) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 175000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=30) AND (21<=EDAD<=25) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 228000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=100) AND (21<=EDAD<=25) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 283000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (26<=EDAD<=30) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 73000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (26<=EDAD<=30) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 108000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=30) AND (26<=EDAD<=30) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 141000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=100) AND (26<=EDAD<=30) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 175000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (31<=EDAD<=35) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 41000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (31<=EDAD<=35) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 41000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=30) AND (31<=EDAD<=35) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 41000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=100) AND (31<=EDAD<=35) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 47000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=10) AND (36<=EDAD<=100) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 41000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (11<=PUNTAJE<=20) AND (36<=EDAD<=100) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 41000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (21<=PUNTAJE<=30) AND (36<=EDAD<=100) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 41000;
IF MODELO_USO = 'T25' AND (0<=MARCA_MANZANA<=8) AND (31<=PUNTAJE<=100) AND (36<=EDAD<=100) AND (0<=AREA_USO<=100000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 41000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1090000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 920000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 810000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (51<=EDAD<=75) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 520000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (76<=EDAD<=100) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 310000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1080000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 910000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 800000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (51<=EDAD<=75) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 520000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (76<=EDAD<=100) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 300000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (0<=EDAD<=10) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1340000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (11<=EDAD<=30) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1130000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (31<=EDAD<=50) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1000000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (51<=EDAD<=75) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 640000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (0<=PUNTAJE<=40) AND (76<=EDAD<=100) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 380000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1280000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1080000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 950000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (51<=EDAD<=75) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 610000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (76<=EDAD<=100) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 360000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1240000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1050000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 930000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (51<=EDAD<=75) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 590000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (76<=EDAD<=100) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 350000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (0<=EDAD<=10) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1600000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (11<=EDAD<=30) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1350000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (31<=EDAD<=50) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1190000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (51<=EDAD<=75) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 770000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (41<=PUNTAJE<=60) AND (76<=EDAD<=100) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 450000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1280000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1080000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 950000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (51<=EDAD<=75) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 610000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (76<=EDAD<=100) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 360000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1470000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1240000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1100000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (51<=EDAD<=75) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 700000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (76<=EDAD<=100) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 410000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (0<=EDAD<=10) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2060000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (11<=EDAD<=30) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1740000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (31<=EDAD<=50) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1540000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (51<=EDAD<=75) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 990000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (61<=PUNTAJE<=75) AND (76<=EDAD<=100) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 580000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2010000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1690000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1500000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (51<=EDAD<=75) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 960000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (76<=EDAD<=100) AND (0<=AREA_USO<=1000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 570000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1900000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1600000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1420000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (51<=EDAD<=75) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 910000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (76<=EDAD<=100) AND (1000.01<=AREA_USO<=5000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 540000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (0<=EDAD<=10) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2670000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (11<=EDAD<=30) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 2250000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (31<=EDAD<=50) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1990000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (51<=EDAD<=75) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 1280000;
IF MODELO_USO = 'T26' AND (0<=MARCA_MANZANA<=8) AND (76<=PUNTAJE<=100) AND (76<=EDAD<=100) AND (5000.01<=AREA_USO<=10000) AND (0<=CODIGO_ESTRATO<=6) THEN VALOR_UNITARIO_2022 = 750000;
RUN;
/*
DATA REVISA;
SET PRUEBA.PREDIOS_VALORES_TABLAS_NPH2;
IF MODELO_0 IN ("T01-1", "T01-2", "T01-3", "T01-4", "T01-5", "T01-6", "T01-7", "T01-8",
"T02-1", "T02-2", "T02-3", "T02-4", "T03", "T04", "T05-1", "T05-2", "T05-3", "T05-4", "T06", "T07", "T19") AND VALOR_UNITARIO_&VIGENCIA. = .;
KEEP MODELO_0 PUNTAJE EDAD CODIGO_USO_TABLAS MARCA_MANZANA_TABLAS AREA_TERRENO_TABLAS AREA_USO_TABLAS UNIDAD_LIQUIDACION;
RUN;

PROC SQL;
CREATE TABLE REVISA_2 AS SELECT MODELO_0, COUNT(*) AS N
FROM PRUEBA.PREDIOS_VALORES_TABLAS_NPH2
GROUP BY MODELO_0;
QUIT;

DATA REVISA_3;
SET CONSOLIDADO_TABLAS_VALORES;
IF tabla = "T03" AND PUNTAJE1 = 65 AND EDAD_PREDIO1 = 11;
RUN;
*/
/**************************************************************************************************************/
/* CALCULO VALORES_CONSTRUCCION USOS MULTIPLES*/
/**************************************************************************************************************/

DATA UMULT_VISTA_VUNITAR_X_AREA; SET  PRUEBA.PREDIOS_VALORES_TABLAS_NPH; /* CALCULO VALORES_CONSTRUCCION USOS MULTIPLES*/
IF  LIQUIDACION = 'TABLA'; 
VU_AREA = VALOR_UNITARIO_&VIGENCIA. * AREA_USO; RUN;

/**************************************************************************************************************/
/* SE CALCULA EL VALOR TOTAL DE LA CONSTRUCCIÓN DEL PREDIO (LA SUMA POR UNIDADES CALIFICADAS). */
/**************************************************************************************************************/

PROC SQL; CREATE TABLE UMULT_PRED_VCONST AS /* SE CALCULA EL VALOR TOTAL DE LA CONSTRUCCIÓN DEL PREDIO (LA SUMA POR UNIDADES CALIFICADAS). */
SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
SUM(VU_AREA) AS VALOR_CONSTRUCCION_COM_&VIGENCIA.
FROM UMULT_VISTA_VUNITAR_X_AREA
GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO;
QUIT;

PROC SQL;CREATE TABLE UMULT_PRED_VCONST2 AS SELECT A.*,
B.VALOR_CONSTRUCCION_COM_&VIGENCIA. AS VALOR_CONSTRUCCION_COM_&VIGENCIA._UM
FROM UMULT_VISTA_VUNITAR_X_AREA AS A LEFT JOIN UMULT_PRED_VCONST AS B ON 
A.CODIGO_BARRIO = B.CODIGO_BARRIO &
A.CODIGO_MANZANA = B.CODIGO_MANZANA &
A.CODIGO_PREDIO = B.CODIGO_PREDIO &
A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
A.CODIGO_RESTO = B.CODIGO_RESTO
ORDER BY A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, A.CODIGO_CONSTRUCCION, A.CODIGO_RESTO;
QUIT;

/**************************************************************************************************************/
/* SE CONCATENAN LAS DOS BASES CORRESPONDIENTES A TABLAS Y LIQUIDACIONES DIFERENTES A TABLAS. */
/**************************************************************************************************************/
					
DATA PREDIOS_VALORES_TABLA_UR; SET PRUEBA.PREDIOS_VALORES_TABLAS_NPH; /* SE CONCATENAN LAS DOS BASES CORRESPONDIENTES A TABLAS Y LIQUIDACIONES DIFERENTES A TABLAS. */
IF LIQUIDACION NOT IN ('TABLA'); RUN;

DATA PRUEBA.BD_PREDIOS_MAS_USOMU_V3; SET PREDIOS_VALORES_TABLA_UR UMULT_PRED_VCONST2; RUN;

DATA PRUEBA.VISTA_USOS_MULTIPLES_DEF; SET PRUEBA.BD_PREDIOS_MAS_USOMU_V3;
IF MODELO_0 IN ('USOS MULTIPLES'); RUN;


/*************************************************************************************************************************/
/****************** EMPIEZA LA RUTINA PARA ARMAR LA BASE PARA MODELOS CREANDO TODAS LAS VARIABLES DUMMY ******************/
/*************************************************************************************************************************/

/**************************************************************************************************************/
/*1. PEGADO CENTRALIDADES (PREDIOS + UM)*/
/**************************************************************************************************************/

PROC SORT DATA=ODBCLIB.CENTRALIDADES NODUPKEY OUT=PRUEBA.CENTRALIDADES; BY COD_BARRIO; RUN;

PROC SQL;	CREATE TABLE PREDIO_VISTA_PROD_1 AS /*CENTRALIDADES*/
		SELECT A.*, B.COD_ZONA_CIU AS CENTRALIDAD
			FROM PRUEBA.BD_PREDIOS_MAS_USOMU_V3 AS A LEFT JOIN PRUEBA.CENTRALIDADES AS B
				ON	A.CODIGO_BARRIO = B.COD_BARRIO
			ORDER BY CODIGO_LOCALIDAD, A.CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION,
			CODIGO_RESTO, CODIGO_USO, UNIDAD_CALIFICADA;
QUIT;


/**************************************************************************************************************/
/*2. CALCULO DE DENSIDAD (PREDIOS + UM)*/
/**************************************************************************************************************/

PROC SQL; CREATE TABLE BARMANPRED AS SELECT
CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, SUM(AREA_TERRENO) AS AREA_TERRENO_BMP, COUNT(*) AS NUMERO_UNIDADES,
 COUNT(*) AS NUMERO_UNIDADES_BMP, SUM(AREA_CONSTRUIDA) AS AREA_CONSTRUIDA_BMP
FROM COMUN.PREDIO_&FECHA_CORTE. GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO;
QUIT;

DATA DENSIDAD; SET BARMANPRED; 
IF AREA_TERRENO_BMP NE 0 THEN DENSIDAD = NUMERO_UNIDADES/AREA_TERRENO_BMP;ELSE DENSIDAD =0;
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO DENSIDAD  NUMERO_UNIDADES AREA_TERRENO_BMP DENSIDAD NUMERO_UNIDADES_BMP AREA_CONSTRUIDA_BMP;
RUN;

PROC SQL; 	CREATE TABLE PREDIO_VISTA_PROD_2 AS
		SELECT A.*, B.DENSIDAD
			FROM  PREDIO_VISTA_PROD_1 AS A LEFT JOIN DENSIDAD AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO;					
QUIT;

/**************************************************************************************************************/
/*3. PEGADO DISTANCIAS (PREDIOS + UM) Y NUMERO PISO*/
/**************************************************************************************************************/
/*
PROC IMPORT OUT=PRUEBA.DISTANCIAS_LOTE_0
            DATAFILE="\\prowin04\cavellaneda\EJERCICIOS\EJERCICIOS 2021\VERIFICACION_CALCULOS\Verificacion_calculos\input\Dist_Agos022021.dbf"
            DBMS=DBF REPLACE;
RUN;
*/


DATA PRUEBA.DISTANCIAS_LOTE_0; 
SET ODBCLIB.TABLA_DISTANCIAS_2009; 
IF VIGENCIAS = &VIGENCIA.; 
RUN;  /*DISTANCIAS*/


PROC SQL; 	CREATE TABLE DISTANCIAS_LOTE AS	
		SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO,
ROUND(COL_PUB,.000000001) AS COL_PUB, 
ROUND(COL_PRIV,.000000001) AS COL_PRIV,
ROUND(CARCEL,.000000001) AS CARCELES, 
ROUND(CAI,.000000001) AS CAI,
ROUND(UNIVERS,.000000001) AS UNIVERS,
ROUND(HOSPS123,.000000001) AS HOSP123,
ROUND(CLINIC123,.000000001) AS CLINIC123,
ROUND(D_I_MILITA,.000000001) AS IN_MIL_POL,
ROUND(URI_UPJ,.000000001) AS URI_UPJ,
ROUND(CENTCOMERC,.000000001) AS CENTCOMERC,
ROUND(D_PAR_METR,.000000001) AS PKMETROP,
ROUND(D_PAR_ZONA,.000000001) AS PKZONAL,
ROUND(D_PAR_VECI,.000000001) AS  PKVENCIN,
ROUND(PKBOLSIL,.000000001) AS PKBOLSIL,
ROUND(D_ESTAC_TRANSMILENIO,.000000001) AS  ESTACTM,
ROUND(D_PORTAL_TRANSMILENIO,.000000001) AS PORTALTM,
ROUND(DIST_AEROP,.000000001) AS  AEROPTO,
ROUND(ZOINFLRUID,.000000001) AS  ZOINFLRUID,
ROUND(RSDJ,.000000001) AS  RSDJ,
ROUND(RFREGION,.000000001) AS  RFREGION,
ROUND(RFNAL,.000000001) AS  RFNAL,
ROUND(ZMPA,.000000001) AS  ZMPA,
ROUND(D_ESTRATO_1,.000000001) AS  EST01,
ROUND(D_ESTRATO_2,.000000001) AS  EST02,
ROUND(D_ESTRATO_3,.000000001) AS  EST03,
ROUND(D_ESTRATO_4,.000000001) AS  EST04,
ROUND(D_ESTRATO_5,.000000001) AS  EST05,
ROUND(D_ESTRATO_6,.000000001) AS  EST06
FROM PRUEBA.DISTANCIAS_LOTE_0;
QUIT;
/*
PROC SQL; 	CREATE TABLE DISTANCIAS_LOTE AS	
		SELECT LOTLOTE_ID,
		SUBSTR(LOTLOTE_ID, 1, 6) AS CODIGO_BARRIO,
		SUBSTR(LOTLOTE_ID, 8, 2) AS CODIGO_MANZANA,
		SUBSTR(LOTLOTE_ID, 11, 2) AS CODIGO_PREDIO,
ROUND(COL_PUB,.000000001) AS COL_PUB, 
ROUND(COL_PRIV,.000000001) AS COL_PRIV,
ROUND(CARCELES,.000000001) AS CARCELES,
ROUND(CAI,.000000001) AS CAI,
ROUND(UNIVERS,.000000001) AS UNIVERS,
ROUND(HOSP123,.000000001) AS HOSP123,
ROUND(CLINIC123,.000000001) AS CLINIC123,
ROUND(IN_MIL_POL,.000000001) AS IN_MIL_POL,
ROUND(URI_UPJ,.000000001) AS URI_UPJ,
ROUND(CENTCOMERC,.000000001) AS CENTCOMERC,
ROUND(PKMETROP,.000000001) AS PKMETROP,
ROUND(PKZONAL,.000000001) AS PKZONAL,
ROUND(PKVECIN,.000000001) AS  PKVENCIN,
ROUND(PKBOLSIL,.000000001) AS PKBOLSIL,
ROUND(ESTACTM,.000000001) AS  ESTACTM,
ROUND(PORTALTM,.000000001) AS PORTALTM,
ROUND(AEROPTO,.000000001) AS  AEROPTO,
ROUND(ZOINFLRUID,.000000001) AS  ZOINFLRUID,
ROUND(RSDJ,.000000001) AS  RSDJ,
ROUND(RFREGION,.000000001) AS  RFREGION,
ROUND(RFNAL,.000000001) AS  RFNAL,
ROUND(ZMPA,.000000001) AS  ZMPA,
ROUND(EST01,.000000001) AS  EST01,
ROUND(EST02,.000000001) AS  EST02,
ROUND(EST03,.000000001) AS  EST03,
ROUND(EST04,.000000001) AS  EST04,
ROUND(EST05,.000000001) AS  EST05,
ROUND(EST06,.000000001) AS  EST06
FROM PRUEBA.DISTANCIAS_LOTE_0;
QUIT;*/

PROC SORT DATA=DISTANCIAS_LOTE NODUPKEY OUT=TABLA_DISTANCIAS; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO; RUN;

PROC SQL; CREATE TABLE PREDIO_VISTA_PROD_3 AS SELECT A.*, B.*,
CASE
			WHEN SUBSTR(CODIGO_RESTO,1,2) = '00' THEN 1
			WHEN SUBSTR(CODIGO_RESTO,1,1) = '9' THEN 1
			ELSE INPUT(SUBSTR(CODIGO_RESTO,1,2),BEST3.)
		END AS NUMERO_PISO
FROM PREDIO_VISTA_PROD_2 AS A LEFT JOIN TABLA_DISTANCIAS AS B 
ON	A.CODIGO_BARRIO  = B.CODIGO_BARRIO &
	A.CODIGO_MANZANA = B.CODIGO_MANZANA &
	A.CODIGO_PREDIO  = B.CODIGO_PREDIO;
QUIT;

/**************************************************************************************************************/
/*4. PEGADO CARGUE_CARTOGRAFIA (PREDIOS + UM) para la vigencia*/
/**************************************************************************************************************/

PROC SQL; 	CREATE TABLE PREDIO_VISTA_PROD_4 AS
		SELECT A.*, B.COORDENADA_X, B.COORDENADA_Y, B.MAX_NUM_PISOS
   		    FROM PREDIO_VISTA_PROD_3 AS A 
            LEFT JOIN          
			ODBCLIB.CARGUE_CARTOGRAFIA AS B /*COORDENADAS Y MAX_NUM_PISOS CARTOGRAFIA*/
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO
			ORDER BY A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
			CODIGO_USO, UNIDAD_CALIFICADA;
QUIT;

/**************************************************************************************************************/
/*5.  VALOR_M2_TERRENO_COM (VALORES REFERENCIA) de ODBCLIB.VALORES_REFERENCIA  DE 3 VIGENCIAS */
/**************************************************************************************************************/

PROC SQL; 	CREATE TABLE VALORES_REFERENCIA_&VIGENCIA_ANT_ANT. AS 
		SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, VIGENCIA, VALOR
			FROM ODBCLIB.VALORES_REFERENCIA_&VIGENCIA_ANT_ANT. 
			 WHERE VIGENCIA = &VIGENCIA_ANT_ANT.  /*OJO CAMBIAR A 2019*/
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO;
QUIT;

PROC SORT 	DATA = VALORES_REFERENCIA_&VIGENCIA_ANT_ANT. NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO; RUN;

PROC SQL; 	CREATE TABLE VALORES_REFERENCIA_&VIGENCIA_ANT. AS /*Valor de m2 de terreno comercial de ODBCLIB.VALORES_REFERENCIA para la vigencia 2019  OJOOO MODIFICAR A 2019*/
		SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, VIGENCIA, VALOR
			FROM ODBCLIB.VALORES_REFERENCIA_&VIGENCIA_ANT. /* OJO EN PRODUCCION ES = ODBCLIB.VALORES_REFERENCIA CAMBIO PORQUE SE DEBE TOMAR DE ACÁ, SIEMPRE COMPARA CON SISTEMAS EL NUMERO DE REGISTROS*/
			 WHERE VIGENCIA = &VIGENCIA_ANT.  /*OJO CAMBIAR A 2019*/
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO;
QUIT;

PROC SORT 	DATA = VALORES_REFERENCIA_&VIGENCIA_ANT. NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO; RUN;


PROC SQL; 	CREATE TABLE VALORES_REFERENCIA_&VIGENCIA. AS /*Valor de m2 de terreno comercial de ODBCLIB.VALORES_REFERENCIA para la vigencia 2019  OJOOO MODIFICAR A 2019*/
		SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, VIGENCIA, VALOR
			FROM ODBCLIB.VALORES_REFERENCIA /* OJO EN PRODUCCION ES = ODBCLIB.VALORES_REFERENCIA CAMBIO PORQUE SE DEBE TOMAR DE ACÁ, SIEMPRE COMPARA CON SISTEMAS EL NUMERO DE REGISTROS*/
			 WHERE VIGENCIA = &VIGENCIA.  /*OJO CAMBIAR A 2020*/
			ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO;
QUIT;

PROC SORT 	DATA = VALORES_REFERENCIA_&VIGENCIA. NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO; RUN;



PROC SQL;	CREATE TABLE PRUEBA.PREDIO_VISTA_PROD_7 AS
		SELECT A.*, B.VALOR AS VALOR_M2_TERRENO_COM_&VIGENCIA_ANT_ANT_2.,
		C.VALOR AS VALOR_M2_TERRENO_COM_&VIGENCIA_ANT_2.,
		D.VALOR AS VALOR_M2_TERRENO_COM_&VIGENCIA_2.,
		D.VALOR AS VALOR_REFERENCIA_&VIGENCIA.
		FROM PREDIO_VISTA_PROD_4 AS A 
        LEFT JOIN VALORES_REFERENCIA_&VIGENCIA_ANT_ANT. AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO
        LEFT JOIN VALORES_REFERENCIA_&VIGENCIA_ANT. AS C
				ON	A.CODIGO_BARRIO = C.CODIGO_BARRIO &
					A.CODIGO_MANZANA = C.CODIGO_MANZANA &
					A.CODIGO_PREDIO = C.CODIGO_PREDIO
		LEFT JOIN VALORES_REFERENCIA_&VIGENCIA. AS D
				ON	A.CODIGO_BARRIO = D.CODIGO_BARRIO &
					A.CODIGO_MANZANA = D.CODIGO_MANZANA &
					A.CODIGO_PREDIO = D.CODIGO_PREDIO
   ORDER BY A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
			CODIGO_USO, UNIDAD_CALIFICADA;
QUIT;


/**************************************************************************************************************/
/* 6. SE PEGA LA INFORMACIÓN DE VALORES DE TERRENO CORREGIDOS PARA LA VIGENCIA ANTERIOR */
/**************************************************************************************************************/


DATA VALORES_TERRENO; SET ODBCLIB.VALORES_TERRENO_&VIGENCIA_ANT.; /* 6. SE PEGA LA INFORMACIÓN DE VALORES DE TERRENO CORREGIDOS PARA LA VIGENCIA ANTERIOR */
IF VIGENCIA = &VIGENCIA_ANT.;
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO VALR_TERR_TRAN vigencia; RUN;

PROC SORT DATA = VALORES_TERRENO NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO; RUN;


PROC SQL;  	CREATE TABLE PRUEBA.PREDIO_VISTA_PROD_8 AS  /*VALOR_M2_TERRENO_COR_18 DE TABLA VALORES TERRENO VIGENCIA=2018 */
		SELECT A.*, B.VALR_TERR_TRAN AS VALOR_M2_TERRENO_COR_&VIGENCIA_ANT_2.
			FROM PRUEBA.PREDIO_VISTA_PROD_7 AS A LEFT JOIN VALORES_TERRENO AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
                    A.CODIGO_RESTO = B.CODIGO_RESTO;
QUIT;


/**************************************************************************************************************/
/* VARIABLES DE CAMBIO DE PROTEGIDO A NO PROTEGIDO Y VICEVERSA. */
/**************************************************************************************************************/

DATA PREDIO_VISTA_PROD_9; SET PRUEBA.PREDIO_VISTA_PROD_8; /*CAMBIO DE SUELO: PROTEGIDO A NO PORTEGIDO O VICEVERSA*/
ZHF_1_2020 = SUBSTR(ZHF_2020, 1, 1);
ZHF_1_&VIGENCIA. = SUBSTR(ZHF_&VIGENCIA., 1, 1);
MODELO_0_ORIGINAL = MODELO_0;
IF ZHF_1_2020 = 5 AND ZHF_1_&VIGENCIA. = 6 THEN ZHF_5_6 = 1;
IF ZHF_1_2020 = 6 AND ZHF_1_&VIGENCIA. = 5 THEN ZHF_6_5 = 1;
RUN;
 
/**************************************************************************************************************/
/*10. IDENTIFICADOR EDIFICIO-CONJUNTO*/
/**************************************************************************************************************/

PROC SQL; 	CREATE TABLE TORRE_CONJUNTO AS SELECT /*10 IDENTIFICADOR NUMERO DE EDIFICIOS (CONJUNTO)*/
	CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, COUNT(CODIGO_CONSTRUCCION) AS N_TORRES
	 FROM PREDIO_VISTA_PROD_9 
	 WHERE( UNIDAD_LIQUIDACION=1 AND CODIGO_CONSTRUCCION NOT IN ('000','901','999'))
GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO ;
QUIT;

DATA TORRE_CONJUNTO1;SET TORRE_CONJUNTO;
put @20 TIPO_PH $char17.;
IF N_TORRES=1 THEN TIPO_PH = '1 EDIFICIO';
IF N_TORRES=2 THEN TIPO_PH = '2 EDIFICIOS';
IF N_TORRES IN (3,4,5) THEN TIPO_PH = '3-5 EDIFICIOS';
IF N_TORRES>5 THEN TIPO_PH = 'MAYOR 5 EDIFICIOS'; RUN;

PROC SQL;	CREATE TABLE PREDIO_VISTA_PROD_10 AS
		SELECT A.*, B.N_TORRES, B.TIPO_PH
			FROM PREDIO_VISTA_PROD_9 AS A LEFT JOIN TORRE_CONJUNTO1 AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO=B.CODIGO_PREDIO;
QUIT;


/**************************************************************************************************************/
/*10. CREACION DE VARIABLES DUMMY 
/* RELACION_AREA, DUMMIES: (LOCALIDAD, ESTRATO, ZHF, EDAD, NUMERO_PISO DISTANCIAS, CENTRALIDADES)  */
/**************************************************************************************************************/


/*Creación de variables dummy*/
PROC SQL; 	CREATE TABLE PREDIO_VISTA_PROD_12 AS /* RELACION_AREA, DUMMIES: (LOCALIDAD, ESTRATO, ZHF, EDAD, NUMERO_PISO DISTANCIAS, CENTRALIDADES)  */
		SELECT *, 
		CASE WHEN AREA_TERRENO = 0 THEN 0 ELSE (AREA_CONSTRUIDA / AREA_TERRENO) END AS RELACION_AREA,	

		CASE WHEN CODIGO_LOCALIDAD = 1 THEN 1 ELSE 0 END AS USAQUEN,
		CASE WHEN CODIGO_LOCALIDAD = 2 THEN 1 ELSE 0 END AS CHAPINERO,
		CASE WHEN CODIGO_LOCALIDAD = 3 THEN 1 ELSE 0 END AS SANTAFE,
		CASE WHEN CODIGO_LOCALIDAD = 4 THEN 1 ELSE 0 END AS SAN_CRISTOBAL,
		CASE WHEN CODIGO_LOCALIDAD = 5 THEN 1 ELSE 0 END AS USME,
		CASE WHEN CODIGO_LOCALIDAD = 6 THEN 1 ELSE 0 END AS TUNJUELITO,
		CASE WHEN CODIGO_LOCALIDAD = 7 THEN 1 ELSE 0 END AS BOSA,
		CASE WHEN CODIGO_LOCALIDAD = 8 THEN 1 ELSE 0 END AS KENNEDY,
		CASE WHEN CODIGO_LOCALIDAD = 9 THEN 1 ELSE 0 END AS FONTIBON,
		CASE WHEN CODIGO_LOCALIDAD = 10 THEN 1 ELSE 0 END AS ENGATIVA,
		CASE WHEN CODIGO_LOCALIDAD = 11 THEN 1 ELSE 0 END AS SUBA,
		CASE WHEN CODIGO_LOCALIDAD = 12 THEN 1 ELSE 0 END AS B_UNIDOS,
		CASE WHEN CODIGO_LOCALIDAD = 13 THEN 1 ELSE 0 END AS TEUSAQUILLO,
		CASE WHEN CODIGO_LOCALIDAD = 14 THEN 1 ELSE 0 END AS MARTIRES,
		CASE WHEN CODIGO_LOCALIDAD = 15 THEN 1 ELSE 0 END AS A_NARINO,
		CASE WHEN CODIGO_LOCALIDAD = 16 THEN 1 ELSE 0 END AS P_ARANDA,
		CASE WHEN CODIGO_LOCALIDAD = 17 THEN 1 ELSE 0 END AS CANDELARIA,
		CASE WHEN CODIGO_LOCALIDAD = 18 THEN 1 ELSE 0 END AS RAFAEL_U_U,
		CASE WHEN CODIGO_LOCALIDAD = 19 THEN 1 ELSE 0 END AS C_BOLIVAR,

		CASE WHEN CODIGO_ESTRATO = 1 THEN 1 ELSE 0 END AS ESTRATO1,
		CASE WHEN CODIGO_ESTRATO = 2 THEN 1 ELSE 0 END AS ESTRATO2,
		CASE WHEN CODIGO_ESTRATO = 3 THEN 1 ELSE 0 END AS ESTRATO3,
		CASE WHEN CODIGO_ESTRATO = 4 THEN 1 ELSE 0 END AS ESTRATO4,
		CASE WHEN CODIGO_ESTRATO = 5 THEN 1 ELSE 0 END AS ESTRATO5,
		CASE WHEN CODIGO_ESTRATO = 6 THEN 1 ELSE 0 END AS ESTRATO6,

		CASE WHEN SUBSTR(ZHF,2,1) = '2' THEN 1 ELSE 0 END AS AREA_ACT2,
		CASE WHEN SUBSTR(ZHF,2,1) = '3' THEN 1 ELSE 0 END AS AREA_ACT3,
		CASE WHEN SUBSTR(ZHF,2,1) = '4' THEN 1 ELSE 0 END AS AREA_ACT4,
		CASE WHEN SUBSTR(ZHF,2,1) = '5' THEN 1 ELSE 0 END AS AREA_ACT5,
		CASE WHEN SUBSTR(ZHF,2,1) = '6' THEN 1 ELSE 0 END AS AREA_ACT6,
		CASE WHEN SUBSTR(ZHF,2,1) = '7' THEN 1 ELSE 0 END AS AREA_ACT7,
		CASE WHEN SUBSTR(ZHF,2,1) = '8' THEN 1 ELSE 0 END AS AREA_ACT8,

		CASE WHEN SUBSTR(ZHF,2,2) = '71' THEN 1 ELSE 0 END AS AREA_ACT71,
		CASE WHEN SUBSTR(ZHF,2,2) = '72' THEN 1 ELSE 0 END AS AREA_ACT72,
		CASE WHEN SUBSTR(ZHF,2,2) = '73' THEN 1 ELSE 0 END AS AREA_ACT73,
		CASE WHEN SUBSTR(ZHF,2,2) = '74' THEN 1 ELSE 0 END AS AREA_ACT74,
		CASE WHEN SUBSTR(ZHF,2,2) = '75' THEN 1 ELSE 0 END AS AREA_ACT75,

		CASE WHEN SUBSTR(ZHF,4,1) = '1' THEN 1 ELSE 0 END AS ZHF_4_TRAT_DESARR,
		CASE WHEN SUBSTR(ZHF,4,1) = '2' THEN 1 ELSE 0 END AS ZHF_4_TRAT_CONSOL,
		CASE WHEN SUBSTR(ZHF,4,1) = '3' THEN 1 ELSE 0 END AS ZHF_4_TRAT_RENOV,
		CASE WHEN SUBSTR(ZHF,4,1) = '4' THEN 1 ELSE 0 END AS ZHF_4_TRAT_CONSERV,
		CASE WHEN SUBSTR(ZHF,4,1) = '5' THEN 1 ELSE 0 END AS ZHF_4_TRAT_MEJ,
		CASE WHEN SUBSTR(ZHF,4,1) = '7' THEN 1 ELSE 0 END AS ZHF_4_TRAT_REDES,

		CASE WHEN SUBSTR(ZHF,6,1) = '1' THEN 1 ELSE 0 END AS ZHF_6_TOPOG_PLANA,
		CASE WHEN SUBSTR(ZHF,6,1) = '2' THEN 1 ELSE 0 END AS ZHF_6_TOPOG_INCL,
		CASE WHEN SUBSTR(ZHF,6,1) = '3' THEN 1 ELSE 0 END AS ZHF_6_TOPOG_EMP,

		CASE WHEN SUBSTR(ZHF,10,1) = '0' THEN 1 ELSE 0 END AS ZHF_10_EST_VIA_SIN_VIA,
		CASE WHEN SUBSTR(ZHF,10,1) = '1' THEN 1 ELSE 0 END AS ZHF_10_EST_VIA_MALO,
		CASE WHEN SUBSTR(ZHF,10,1) = '2' THEN 1 ELSE 0 END AS ZHF_10_EST_VIA_REG,
		CASE WHEN SUBSTR(ZHF,10,1) = '3' THEN 1 ELSE 0 END AS ZHF_10_EST_VIA_BUENO,
		CASE WHEN SUBSTR(ZHF,10,1) = '4' THEN 1 ELSE 0 END AS ZHF_10_EST_VIA_EXC,

		CASE WHEN SUBSTR(ZHF,11,1) = '0' THEN 1 ELSE 0 END AS ZHF_11_INF_VIA_SIN,
		CASE WHEN SUBSTR(ZHF,11,1) = '1' THEN 1 ELSE 0 END AS ZHF_11_INF_VIA_LOCAL,
		CASE WHEN SUBSTR(ZHF,11,1) = '2' THEN 1 ELSE 0 END AS ZHF_11_INF_VIA_ZO_INT,
		CASE WHEN SUBSTR(ZHF,11,1) = '3' THEN 1 ELSE 0 END AS ZHF_11_INF_VIA_ART_COM,
		CASE WHEN SUBSTR(ZHF,11,1) = '4' THEN 1 ELSE 0 END AS ZHF_11_INF_VIA_ART_BAS,

		CASE WHEN SUBSTR(ZHF,12,1) = '0' THEN 1 ELSE 0 END AS ZHF_12_ACT_ECON_NO_ED,
		CASE WHEN SUBSTR(ZHF,12,1) = '1' THEN 1 ELSE 0 END AS ZHF_12_ACT_ECON_RES,
		CASE WHEN SUBSTR(ZHF,12,1) = '2' THEN 1 ELSE 0 END AS ZHF_12_ACT_ECON_COM,
		CASE WHEN SUBSTR(ZHF,12,1) = '3' THEN 1 ELSE 0 END AS ZHF_12_ACT_ECON_IND,
		CASE WHEN SUBSTR(ZHF,12,1) = '4' THEN 1 ELSE 0 END AS ZHF_12_ACT_ECON_EQUIP,
		CASE WHEN SUBSTR(ZHF,12,1) = '5' THEN 1 ELSE 0 END AS ZHF_12_ACT_ECON_ESPPUB,
		CASE WHEN SUBSTR(ZHF,12,1) = '6' THEN 1 ELSE 0 END AS ZHF_12_ACT_ECON_REC_DEP,

		CASE WHEN SUBSTR(ZHF,12,2) = '11' THEN 1 ELSE 0 END AS ZHF_1213_11,
		CASE WHEN SUBSTR(ZHF,12,2) = '12' THEN 1 ELSE 0 END AS ZHF_1213_12,
		CASE WHEN SUBSTR(ZHF,12,2) = '13' THEN 1 ELSE 0 END AS ZHF_1213_13,
		CASE WHEN SUBSTR(ZHF,12,2) = '14' THEN 1 ELSE 0 END AS ZHF_1213_14,
		CASE WHEN SUBSTR(ZHF,12,2) = '15' THEN 1 ELSE 0 END AS ZHF_1213_15,
		CASE WHEN SUBSTR(ZHF,12,2) = '16' THEN 1 ELSE 0 END AS ZHF_1213_16,

		CASE WHEN SUBSTR(ZHF,12,2) = '17' THEN 1 ELSE 0 END AS ZHF_1213_17,
		CASE WHEN SUBSTR(ZHF,12,2) = '18' THEN 1 ELSE 0 END AS ZHF_1213_18,
		

		CASE WHEN SUBSTR(ZHF,12,2) = '21' THEN 1 ELSE 0 END AS ZHF_1213_21,
		CASE WHEN SUBSTR(ZHF,12,2) = '22' THEN 1 ELSE 0 END AS ZHF_1213_22,
		CASE WHEN SUBSTR(ZHF,12,2) = '23' THEN 1 ELSE 0 END AS ZHF_1213_23,
		CASE WHEN SUBSTR(ZHF,12,2) = '24' THEN 1 ELSE 0 END AS ZHF_1213_24,


		CASE WHEN SUBSTR(ZHF,12,2) = '31' THEN 1 ELSE 0 END AS ZHF_1213_31,
		CASE WHEN SUBSTR(ZHF,12,2) = '32' THEN 1 ELSE 0 END AS ZHF_1213_32,
		CASE WHEN SUBSTR(ZHF,12,2) = '33' THEN 1 ELSE 0 END AS ZHF_1213_33,
		CASE WHEN SUBSTR(ZHF,12,2) = '34' THEN 1 ELSE 0 END AS ZHF_1213_34,

		CASE WHEN SUBSTR(ZHF,12,2) = '40' THEN 1 ELSE 0 END AS ZHF_1213_40,
		CASE WHEN SUBSTR(ZHF,12,2) = '41' THEN 1 ELSE 0 END AS ZHF_1213_41,
		CASE WHEN SUBSTR(ZHF,12,2) = '42' THEN 1 ELSE 0 END AS ZHF_1213_42,
		CASE WHEN SUBSTR(ZHF,12,2) = '43' THEN 1 ELSE 0 END AS ZHF_1213_43,
		CASE WHEN SUBSTR(ZHF,12,2) = '44' THEN 1 ELSE 0 END AS ZHF_1213_44,
		CASE WHEN SUBSTR(ZHF,12,2) = '45' THEN 1 ELSE 0 END AS ZHF_1213_45,
		CASE WHEN SUBSTR(ZHF,12,2) = '46' THEN 1 ELSE 0 END AS ZHF_1213_46,
		CASE WHEN SUBSTR(ZHF,12,2) = '47' THEN 1 ELSE 0 END AS ZHF_1213_47,
		CASE WHEN SUBSTR(ZHF,12,2) = '48' THEN 1 ELSE 0 END AS ZHF_1213_48,
		CASE WHEN SUBSTR(ZHF,12,2) = '49' THEN 1 ELSE 0 END AS ZHF_1213_49,
		
		CASE WHEN COMPLEMENTO_INDUSTRIA = '511' THEN 1 ELSE 0 END AS CIND_MADERA,
		CASE WHEN COMPLEMENTO_INDUSTRIA = '512' THEN 1 ELSE 0 END AS CIND_MET_LIV,
		CASE WHEN COMPLEMENTO_INDUSTRIA = '513' THEN 1 ELSE 0 END AS CIND_MET_MED,
		CASE WHEN COMPLEMENTO_INDUSTRIA = '514' THEN 1 ELSE 0 END AS CIND_MET_PES,
		CASE WHEN COMPLEMENTO_INDUSTRIA = '515' THEN 1 ELSE 0 END AS CIND_ALT_MAY,

		CASE WHEN CONSERVACION_HISTORICA = 'I' THEN 1 ELSE 0 END AS CONSERVACION_I,
		CASE WHEN CONSERVACION_HISTORICA = 'T' THEN 1 ELSE 0 END AS CONSERVACION_T,
		CASE WHEN CONSERVACION_HISTORICA = 'M' THEN 1 ELSE 0 END AS CONSERVACION_M,
        CASE WHEN CONSERVACION_HISTORICA = 'N' THEN 1 ELSE 0 END AS CONSERVACION_N,

		CASE WHEN  (EDAD <= 5)         THEN 1 ELSE 0 END AS DUMMY_NUEVO,
		CASE WHEN  (5  < EDAD <= 20)  THEN 1 ELSE 0 END AS DUMMY_EDAD_6_20,
		CASE WHEN  (20 < EDAD <= 30)  THEN 1 ELSE 0 END AS DUMMY_EDAD_20_30,
		CASE WHEN  (EDAD > 30)        THEN 1 ELSE 0 END AS DUMMY_VIEJOS,

	
/*Dummys generadas del Análisis de reducción de Variables de los modelos son categorizaciones*/

		CASE WHEN TIPO_PH='1 EDIFICIO' THEN  1 ELSE 0 END AS EDIFICIO_1,
		CASE WHEN TIPO_PH='2 EDIFICIOS' THEN  1 ELSE 0 END AS EDIFICIOS_2,
		CASE WHEN TIPO_PH='3-5 EDIFICIOS' THEN  1 ELSE 0 END AS EDIFICIOS_3_5,
		CASE WHEN TIPO_PH='MAYOR 5 EDIFICIOS' THEN  1 ELSE 0 END AS EDIFICIOS_M_5,

		CASE    WHEN SUBSTR(CODIGO_RESTO,1,1) = '9' THEN  1 ELSE 0 END AS SOTANO,
		CASE	WHEN (1 <= NUMERO_PISO <= 3) THEN 1 ELSE 0   END AS PISO_1_3,
		CASE 	WHEN (4 <= NUMERO_PISO <= 5) THEN 1 ELSE 0    END AS PISO_4_5,
		CASE 	WHEN (6 <= NUMERO_PISO <=10) THEN 1 ELSE 0    END AS PISO_6_10,
		CASE 	WHEN (10 < NUMERO_PISO <=20) THEN 1 ELSE 0   END AS PISO_11_20,
		CASE 	WHEN (NUMERO_PISO > 20)      THEN 1 ELSE 0    END AS PISO_M_20,
		
		CASE	WHEN (0  <= CARCELES <= 100) THEN 1 ELSE 0    END AS CARCEL_0_100,
		CASE 	WHEN (100 < CARCELES <= 200) THEN 1 ELSE 0    END AS CARCEL_100_200,
		CASE 	WHEN (200 < CARCELES <= 500) THEN 1 ELSE 0    END AS CARCEL_200_500,
		CASE 	WHEN  (CARCELES > 500)       THEN 1 ELSE 0    END AS CARCEL_M_500,

        CASE	WHEN (0  <= ESTACTM <= 100)  THEN 1 ELSE 0    END AS ESTACTM_0_100,
		CASE 	WHEN (100 < ESTACTM <= 200)  THEN 1 ELSE 0    END AS ESTACTM_100_200,
		CASE 	WHEN (200 < ESTACTM <= 500)  THEN 1 ELSE 0    END AS ESTACTM_200_500,
		CASE 	WHEN (ESTACTM> 500)          THEN 1 ELSE 0    END AS ESTACTM_M_500,

		CASE	WHEN (0  <= ZMPA <= 50) 	 THEN 1 ELSE 0    END AS ZMPA_0_50,
		CASE 	WHEN (50 < ZMPA <= 100) 	 THEN 1 ELSE 0    END AS ZMPA_50_100,
		CASE 	WHEN (ZMPA> 100)        	 THEN 1 ELSE 0    END AS ZMPA_M_100,

		CASE	WHEN (0  <= ZOINFLRUID <= 100) THEN 1 ELSE 0    END AS ZOINFLRUID_0_100,
		CASE 	WHEN (100 < ZOINFLRUID <= 200) THEN 1 ELSE 0    END AS ZOINFLRUID_100_200,
		CASE 	WHEN (200 < ZOINFLRUID <= 500) THEN 1 ELSE 0    END AS ZOINFLRUID_200_500,
		CASE 	WHEN (ZOINFLRUID> 500)         THEN 1 ELSE 0    END AS ZOINFLRUID_M_500,

		CASE	WHEN (0  <= CENTCOMERC <= 100) THEN 1 ELSE 0    END AS CENTCOMERC_0_100,
		CASE 	WHEN (100 < CENTCOMERC <= 200) THEN 1 ELSE 0    END AS CENTCOMERC_100_200,
		CASE 	WHEN (200 < CENTCOMERC <= 500) THEN 1 ELSE 0    END AS CENTCOMERC_200_500,
		CASE 	WHEN (CENTCOMERC> 500)         THEN 1 ELSE 0    END AS CENTCOMERC_M_500,

		CASE	WHEN (0  <= CLINIC123  <= 100) THEN 1 ELSE 0    END AS CLINIC123_0_100,
		CASE 	WHEN (100 < CLINIC123  <= 200) THEN 1 ELSE 0    END AS CLINIC123_100_200,
		CASE 	WHEN (200 < CLINIC123  <= 500) THEN 1 ELSE 0    END AS CLINIC123_200_500,
		CASE 	WHEN (CLINIC123 > 500)         THEN 1 ELSE 0    END AS CLINIC123_M_500,

		CASE	WHEN (0  <= HOSP123  <= 100)   THEN 1 ELSE 0    END AS HOSP123_0_100,
		CASE 	WHEN (100 < HOSP123  <= 200)   THEN 1 ELSE 0    END AS HOSP123_100_200,
		CASE 	WHEN (200 < HOSP123  <= 500)   THEN 1 ELSE 0    END AS HOSP123_200_500,
		CASE 	WHEN (HOSP123 > 500)           THEN 1 ELSE 0    END AS HOSP123_M_500,

      	CASE	WHEN (0  <= PORTALTM <= 100) THEN 1 ELSE 0    END AS PORTALTM_0_100,
    	CASE 	WHEN (100 < PORTALTM <= 200) THEN 1 ELSE 0    END AS PORTALTM_100_200,
		CASE 	WHEN (200 < PORTALTM <= 500) THEN 1 ELSE 0    END AS PORTALTM_200_500,
		CASE 	WHEN (PORTALTM > 500)        THEN 1 ELSE 0    END AS PORTALTM_M_500,

		CASE	WHEN (0  <= RSDJ <= 100) THEN 1 ELSE 0    END AS RSDJ_0_100,
    	CASE 	WHEN (100 < RSDJ <= 200) THEN 1 ELSE 0    END AS RSDJ_100_200,
		CASE 	WHEN (200 < RSDJ <= 500) THEN 1 ELSE 0    END AS RSDJ_200_500,
		CASE 	WHEN (RSDJ > 500)        THEN 1 ELSE 0    END AS RSDJ_M_500,
		
/*ZOINFLRUID, ZMPA, RSDJ, diatancia a los estratos, reserva regional  y nacional (RFREGION - RFNAL)*/
       CASE	WHEN (ZOINFLRUID = 0) 	 THEN 1 ELSE 0    END AS R_ZOINFLRUID,
       CASE	WHEN (ZMPA = 0) 	 THEN 1 ELSE 0    END AS R_ZMPA,
       CASE	WHEN (RSDJ = 0) 	 THEN 1 ELSE 0    END AS R_RSDJ,
	   CASE	WHEN (EST01 = 0) 	 THEN 1 ELSE 0    END AS R_EST01,
	   CASE	WHEN (EST02 = 0) 	 THEN 1 ELSE 0    END AS R_EST02,
	   CASE	WHEN (EST03 = 0) 	 THEN 1 ELSE 0    END AS R_EST03,
	   CASE	WHEN (EST04 = 0) 	 THEN 1 ELSE 0    END AS R_EST04,
	   CASE	WHEN (EST05 = 0) 	 THEN 1 ELSE 0    END AS R_EST05,
	   CASE	WHEN (EST06 = 0) 	 THEN 1 ELSE 0    END AS R_EST06,
	   CASE	WHEN (RFREGION = 0)  THEN 1 ELSE 0    END AS R_RFREGION,
	   CASE	WHEN (RFNAL = 0) 	 THEN 1 ELSE 0    END AS R_RFNAL,

/*Centralidades*/
CASE WHEN CENTRALIDAD = 'CENT_ALAMOS' THEN 1 ELSE 0 END AS CENT_ALAMOS,
CASE WHEN CENTRALIDAD = 'CENT_AMERICAS' THEN 1 ELSE 0 END AS CENT_AMERICAS,
CASE WHEN CENTRALIDAD = 'CENT_BOSA' THEN 1 ELSE 0 END AS CENT_BOSA,
CASE WHEN CENTRALIDAD = 'CENT_CLL_72_CLL_100' THEN 1 ELSE 0 END AS CENT_CLL_72_CLL_100,
CASE WHEN CENTRALIDAD = 'CENT_CENTRO_H_INT' THEN 1 ELSE 0 END AS CENT_CENTRO_H_INT,
CASE WHEN CENTRALIDAD = 'CENT_CHAPINERO' THEN 1 ELSE 0 END AS CENT_CHAPINERO,
CASE WHEN CENTRALIDAD = 'CENT_CORABASTOS' THEN 1 ELSE 0 END AS CENT_CORABASTOS,
CASE WHEN CENTRALIDAD = 'CENT_DANUB_RIO_TUNJ' THEN 1 ELSE 0 END AS CENT_DANUB_RIO_TUNJ,
CASE WHEN CENTRALIDAD = 'CENT_DELICIAS_ENS' THEN 1 ELSE 0 END AS CENT_DELICIAS_ENS,
CASE WHEN CENTRALIDAD = 'CENT_EJE_INTEG_LLAN_NUSME' THEN 1 ELSE 0 END AS CENT_EJE_INTEG_LLAN_NUSME,
CASE WHEN CENTRALIDAD = 'CENT_FERIAS' THEN 1 ELSE 0 END AS CENT_FERIAS,
CASE WHEN CENTRALIDAD = 'CENT_FONT_AEROP_ENG' THEN 1 ELSE 0 END AS CENT_FONT_AEROP_ENG,
CASE WHEN CENTRALIDAD = 'CENT_PRADO_VERANIEGO' THEN 1 ELSE 0 END AS CENT_PRADO_VERANG,
CASE WHEN CENTRALIDAD = 'CENT_QUIRIGUA_BOLIV' THEN 1 ELSE 0 END AS CENT_QUIRIGUA_BOLIV,
CASE WHEN CENTRALIDAD = 'CENT_RESTREPO_SANT' THEN 1 ELSE 0 END AS CENT_RESTREPO_SANT,
CASE WHEN CENTRALIDAD = 'CENT_SALITRE_Z_IND' THEN 1 ELSE 0 END AS CENT_SALITRE_Z_IND,
CASE WHEN CENTRALIDAD = 'CENT_SIETE_AGOSTO' THEN 1 ELSE 0 END AS CENT_SIETE_AGOSTO,
CASE WHEN CENTRALIDAD = 'CENT_SUBA' THEN 1 ELSE 0 END AS CENT_SUBA,
CASE WHEN CENTRALIDAD = 'CENT_TOBERIN_LA_PAZ' THEN 1 ELSE 0 END AS CENT_TOBERIN_LA_PAZ,
CASE WHEN CENTRALIDAD = 'CENT_USAQUEN_H_STA_BARB' THEN 1 ELSE 0 END AS CENT_USAQUEN_H_STA_BARB,
CASE WHEN CENTRALIDAD = 'CENT_VEINTE_JULIO' THEN 1 ELSE 0 END AS CENT_VEINTE_JULIO

FROM PREDIO_VISTA_PROD_10
ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, CODIGO_USO, UNIDAD_CALIFICADA;
QUIT;

/**************************************************************************************************************/
/*10. TIPOLOGÍAS
/* TIPOLOGIAS CONSTRUCTIVAS, GRUPO ACABADOS, GRUPO DE BAÑOS, GRUPO COCINA*/
/**************************************************************************************************************/


DATA PREDIO_VISTA_PROD_13; SET PREDIO_VISTA_PROD_12; /* TIPOLOGIAS CONSTRUCTIVAS, GRUPO ACABADOS, GRUPO DE BAÑOS, GRUPO COCINA*/
Tip1=0;
Tip2=0;
Tip3=0;
Tip4=0;
Tip5=0;
Tip6=0;
Tip7=0;
Tip8=0;
Tip9=0;
Tip10=0;

/* Tipología constructiva*/	
IF  (((ARMAZON_ESTRUCTURA="111" AND MUROS_ESTRUCTURA="121") OR
((ARMAZON_ESTRUCTURA="111" OR ARMAZON_ESTRUCTURA="113") AND 
  MUROS_ESTRUCTURA="123" AND CUBIERTA_ESTRUCTURA="132"))) OR 
((ARMAZON_ESTRUCTURA="111" AND (MUROS_ESTRUCTURA~="121" AND MUROS_ESTRUCTURA~="122" AND MUROS_ESTRUCTURA~="123" AND MUROS_ESTRUCTURA~="124" AND MUROS_ESTRUCTURA~="125")))
THEN Tip1=1;


IF  ((((ARMAZON_ESTRUCTURA="111" OR ARMAZON_ESTRUCTURA="113") AND MUROS_ESTRUCTURA="125" AND (CUBIERTA_ESTRUCTURA="132" OR CUBIERTA_ESTRUCTURA="133")
AND (COMPLEMENTO_INDUSTRIA ~="511" AND COMPLEMENTO_INDUSTRIA ~="512" AND COMPLEMENTO_INDUSTRIA ~="513" AND COMPLEMENTO_INDUSTRIA ~="514" AND COMPLEMENTO_INDUSTRIA ~="515")) OR
((ARMAZON_ESTRUCTURA="111" OR ARMAZON_ESTRUCTURA="113") AND MUROS_ESTRUCTURA="125" AND (CUBIERTA_ESTRUCTURA="132" OR CUBIERTA_ESTRUCTURA="134")
AND (COMPLEMENTO_INDUSTRIA ~="511" AND COMPLEMENTO_INDUSTRIA ~="512" AND COMPLEMENTO_INDUSTRIA ~="513" AND COMPLEMENTO_INDUSTRIA ~="514" AND COMPLEMENTO_INDUSTRIA ~="515"))))
OR
((ARMAZON_ESTRUCTURA="113" AND MUROS_ESTRUCTURA="121") OR (ARMAZON_ESTRUCTURA="113" AND MUROS_ESTRUCTURA="124"))
THEN Tip2=1;

IF ((ARMAZON_ESTRUCTURA="111" AND MUROS_ESTRUCTURA="122") AND (CUBIERTA_ESTRUCTURA="133" OR CUBIERTA_ESTRUCTURA="134")) OR
(ARMAZON_ESTRUCTURA="113" AND MUROS_ESTRUCTURA="122" AND (CUBIERTA_ESTRUCTURA="133" OR CUBIERTA_ESTRUCTURA="134")) OR
((ARMAZON_ESTRUCTURA="111" OR ARMAZON_ESTRUCTURA="113") AND MUROS_ESTRUCTURA="122" AND CUBIERTA_ESTRUCTURA="132")
THEN Tip3=1;


IF  ((ARMAZON_ESTRUCTURA="114" OR ARMAZON_ESTRUCTURA="115") AND MUROS_ESTRUCTURA="124")
THEN Tip4=1;

IF  (ARMAZON_ESTRUCTURA="112" AND MUROS_ESTRUCTURA="124")
OR  ((ARMAZON_ESTRUCTURA="112" AND
(MUROS_ESTRUCTURA~="121" AND MUROS_ESTRUCTURA~="122" AND MUROS_ESTRUCTURA~="123" AND MUROS_ESTRUCTURA~="124" AND MUROS_ESTRUCTURA~="125") AND
CUBIERTA_ESTRUCTURA="132"))
THEN Tip5=1;

IF (((ARMAZON_ESTRUCTURA="111" OR ARMAZON_ESTRUCTURA="113") AND MUROS_ESTRUCTURA="125" AND (CUBIERTA_ESTRUCTURA="132" OR CUBIERTA_ESTRUCTURA="133")
AND (COMPLEMENTO_INDUSTRIA="511" OR COMPLEMENTO_INDUSTRIA="512" OR COMPLEMENTO_INDUSTRIA="513" OR COMPLEMENTO_INDUSTRIA="514" OR COMPLEMENTO_INDUSTRIA="515")) OR
((ARMAZON_ESTRUCTURA="111" OR ARMAZON_ESTRUCTURA="113") AND MUROS_ESTRUCTURA="125" AND (CUBIERTA_ESTRUCTURA="132" OR CUBIERTA_ESTRUCTURA="134")
AND (COMPLEMENTO_INDUSTRIA="511" OR COMPLEMENTO_INDUSTRIA="512" OR COMPLEMENTO_INDUSTRIA="513" OR COMPLEMENTO_INDUSTRIA="514" OR COMPLEMENTO_INDUSTRIA="515")))
THEN Tip6=1;

IF  ((ARMAZON_ESTRUCTURA="114" OR ARMAZON_ESTRUCTURA="115") AND MUROS_ESTRUCTURA="125"
AND (COMPLEMENTO_INDUSTRIA ~="511" AND COMPLEMENTO_INDUSTRIA ~="512" AND COMPLEMENTO_INDUSTRIA ~="513" AND COMPLEMENTO_INDUSTRIA ~="514" AND COMPLEMENTO_INDUSTRIA ~="515"))
OR
(ARMAZON_ESTRUCTURA="113" AND MUROS_ESTRUCTURA="125" AND CUBIERTA_ESTRUCTURA="136"
AND (COMPLEMENTO_INDUSTRIA ~="511" AND COMPLEMENTO_INDUSTRIA ~="512" AND COMPLEMENTO_INDUSTRIA ~="513" AND COMPLEMENTO_INDUSTRIA ~="514" AND COMPLEMENTO_INDUSTRIA ~="515"))
THEN Tip7=1;


IF  ((ARMAZON_ESTRUCTURA="114" OR ARMAZON_ESTRUCTURA="115") AND MUROS_ESTRUCTURA="125"
AND (COMPLEMENTO_INDUSTRIA="511" OR COMPLEMENTO_INDUSTRIA="512" OR COMPLEMENTO_INDUSTRIA="513" OR COMPLEMENTO_INDUSTRIA="514" OR COMPLEMENTO_INDUSTRIA="515"))
OR
(ARMAZON_ESTRUCTURA="113" AND MUROS_ESTRUCTURA="125" AND CUBIERTA_ESTRUCTURA="136"
AND (COMPLEMENTO_INDUSTRIA="511" OR COMPLEMENTO_INDUSTRIA="512" OR COMPLEMENTO_INDUSTRIA="513" OR COMPLEMENTO_INDUSTRIA="514" OR COMPLEMENTO_INDUSTRIA="515"))
THEN Tip8=1;

IF  ((ARMAZON_ESTRUCTURA="114" OR ARMAZON_ESTRUCTURA="115")
AND (MUROS_ESTRUCTURA~="121" AND MUROS_ESTRUCTURA~="122" AND MUROS_ESTRUCTURA~="123" AND MUROS_ESTRUCTURA~="124" AND MUROS_ESTRUCTURA~="125")
AND (COMPLEMENTO_INDUSTRIA ~="511" AND COMPLEMENTO_INDUSTRIA ~="512" AND COMPLEMENTO_INDUSTRIA ~="513" AND COMPLEMENTO_INDUSTRIA ~="514" AND COMPLEMENTO_INDUSTRIA ~="515"))
THEN Tip9=1;

IF  ((ARMAZON_ESTRUCTURA="114" OR ARMAZON_ESTRUCTURA="115")
AND (MUROS_ESTRUCTURA~="121" AND MUROS_ESTRUCTURA~="122" AND MUROS_ESTRUCTURA~="123" AND MUROS_ESTRUCTURA~="124" AND MUROS_ESTRUCTURA~="125")
AND (COMPLEMENTO_INDUSTRIA="511" OR COMPLEMENTO_INDUSTRIA="512" OR COMPLEMENTO_INDUSTRIA="513" OR COMPLEMENTO_INDUSTRIA="514" OR COMPLEMENTO_INDUSTRIA="515"))
THEN Tip10=1;

/*Grupos de acabados principales*/
GA1=0;
GA2=0;
GA3=0;
GA4=0;
 
IF (FACHADA_ACABADOS="211" AND CONSERVACION_ACABADOS="241")
THEN GA1=1;

IF FACHADA_ACABADOS="212" AND
(CONSERVACION_ACABADOS="241" OR CONSERVACION_ACABADOS="242" OR CONSERVACION_ACABADOS="243" OR
(CONSERVACION_ACABADOS~="241" AND CONSERVACION_ACABADOS~="242" AND CONSERVACION_ACABADOS~="243" AND CONSERVACION_ACABADOS~="244"))
THEN GA2=1;

IF ((FACHADA_ACABADOS="213" OR FACHADA_ACABADOS="214") AND (CONSERVACION_ACABADOS="242" OR CONSERVACION_ACABADOS="243")) OR
(FACHADA_ACABADOS="213" AND (CONSERVACION_ACABADOS="241" OR CONSERVACION_ACABADOS="244"))
THEN GA3=1;

IF (FACHADA_ACABADOS="215" AND (CONSERVACION_ACABADOS="243" OR CONSERVACION_ACABADOS="244"))  OR
(FACHADA_ACABADOS="214" AND CONSERVACION_ACABADOS="244")
THEN GA4=1; 

/*Grupos de baños*/
GB1=0; 
GB2=0;
GB3=0;
GB4=0;
GB5=0;
GB6=0;

IF (TAMANO_BANO="311") OR
(TAMANO_BANO~="311" AND TAMANO_BANO~="312" AND TAMANO_BANO~="313" AND TAMANO_BANO~="314")
THEN GB1=1; 

IF (TAMANO_BANO="312" AND ENCHAPE_BANO~="325" AND MOBILIARIO_BANO="331")
THEN GB2=1;

IF TAMANO_BANO="312" AND ENCHAPE_BANO~="325" AND (MOBILIARIO_BANO="332" OR MOBILIARIO_BANO="333")
THEN GB3=1;

IF TAMANO_BANO="313" AND ENCHAPE_BANO~="325" AND (MOBILIARIO_BANO="332" OR MOBILIARIO_BANO="333" OR MOBILIARIO_BANO="334")
THEN GB4=1;

IF TAMANO_BANO="314" AND ENCHAPE_BANO~="325" AND (MOBILIARIO_BANO="333" OR MOBILIARIO_BANO="334")
THEN GB5=1;

IF ENCHAPE_BANO="325" AND (MOBILIARIO_BANO="334" OR MOBILIARIO_BANO="335")
THEN GB6=1;

/*Grupos de cocina*/
GC1=0;
GC2=0;
GC3=0;
GC4=0;

IF (TAMANO_COCINA="411") OR
(TAMANO_COCINA~="411" AND TAMANO_COCINA~="412" AND TAMANO_COCINA~="413" AND TAMANO_COCINA~="414")
THEN GC1=1;

IF (TAMANO_COCINA="412" AND ENCHAPE_COCINA~="425" AND
(MOBILIARIO_COCINA="431" OR MOBILIARIO_COCINA="432" OR MOBILIARIO_COCINA="433" OR MOBILIARIO_COCINA="434" OR
(MOBILIARIO_COCINA~="431" AND MOBILIARIO_COCINA~="432" AND MOBILIARIO_COCINA~="433" AND MOBILIARIO_COCINA~="434" AND MOBILIARIO_COCINA~="435")))
THEN GC2=1;

IF (TAMANO_COCINA="413" OR TAMANO_COCINA="414") AND ENCHAPE_COCINA~="425" AND
(MOBILIARIO_COCINA="432" OR MOBILIARIO_COCINA="433" OR MOBILIARIO_COCINA="434")
THEN GC3=1;

IF ENCHAPE_COCINA="425" AND (MOBILIARIO_COCINA="434" OR MOBILIARIO_COCINA="435")
THEN GC4=1;

RUN;


/**************************************************************************************************************/
/*10. SE PEGAN LOS VALORES TOTALES E INTEGRALES DE LA VIGENCIA ANTERIOR */
/**************************************************************************************************************/

PROC SQL; CREATE TABLE PREDIO_VISTA_PROD_15 /*PEGADO INFORMACION 2018 PARA COMPARACION Y VARIACIONES*/
AS SELECT C.CHIP, A.*, B.AVALUO_TOTAL_PUNTUAL_COM_&VIGENCIA_ANT., B.VALOR_INTEGRAL_COM_&VIGENCIA_ANT.
FROM PREDIO_VISTA_PROD_13 AS A
LEFT JOIN COMUN.PREDIO_FINAL_&VIGENCIA_ANT. AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
                    A.CODIGO_RESTO = B.CODIGO_RESTO
LEFT JOIN ODBCLIB.IDENTIFICADOR AS C
				ON	A.CODIGO_BARRIO = C.CODIGO_BARRIO &
					A.CODIGO_MANZANA = C.CODIGO_MANZANA &
					A.CODIGO_PREDIO = C.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = C.CODIGO_CONSTRUCCION &
                    A.CODIGO_RESTO = C.CODIGO_RESTO;
QUIT;


/**************************************************************************************************************/
/*10. CÁLCULO DE LA DENSIDAD, NÚMERO DE UNIDADES RESIDENCIALES & TOTAL TERRENO RESIDENCIALES POR BMP. */
/**************************************************************************************************************/


PROC SQL;  CREATE TABLE BARMANPRED_RES AS SELECT
CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, 
SUM(AREA_CONSTRUIDA) AS AREA_CONSTRUIDA_RES_BMP, SUM(AREA_TERRENO) AS AREA_TERRENO_RES_BMP, COUNT(*) AS NUMERO_UNIDADES_RES_BMP
FROM (SELECT * FROM PREDIO_VISTA_PROD_15 WHERE (CODIGO_USO IN ('037','038','001','002','009','019','020','022') & UNIDAD_LIQUIDACION = 1))
GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO;
QUIT;

PROC SQL;	CREATE TABLE PREDIO_VISTA_PROD_18 AS
		SELECT A.*, B.AREA_TERRENO_RES_BMP, B.NUMERO_UNIDADES_RES_BMP,
			C.AREA_CONSTRUIDA_BMP, C.AREA_TERRENO_BMP, C.NUMERO_UNIDADES_BMP
			FROM  PREDIO_VISTA_PROD_15 AS A
            LEFT JOIN BARMANPRED_RES AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO
            LEFT JOIN DENSIDAD AS C
				ON	A.CODIGO_BARRIO = C.CODIGO_BARRIO &
					A.CODIGO_MANZANA = C.CODIGO_MANZANA &
					A.CODIGO_PREDIO = C.CODIGO_PREDIO;					
QUIT;

/**************************************************************************************************************/
/*10. 
/**************************************************************************************************************/


/**************************************************************************************************************/
/*10. EN LA SIGUIENTE PARTE SE PEGA LA INFO DE PM Y OFERTAS A LA BASE. ESTÁ PENDIENTE INCLUIR LOS VALORES. */
/**************************************************************************************************************/

/**************************************************************************************************************/
/* EN CUANTO LA BASE DE OFERTAS, SE PEGAN LAS VARIABLES VALOR_INTEGRAL_OF, AVALUO_PREDIO_OF, OFERTA POR CHIP */
/* LA BASE DE OFERTAS ES COMUN.OFERTA_PH_2020 */
/**************************************************************************************************************/

/**************************************************************************************************************/
/* EN CUANTO LA BASE DE PUNTOS MUESTRA, SE TRAEN LAS VARIABLES A.AVL_OBSERVACIONES,A.AVL_ZONAHF,	*/
/* A.AVL_TVLRCOMPUNUNITARIO AS	VALOR_UNIT_TERRENO_2020, A.AVL_TVLRCOMPUNTOTAL AS VALOR_TOTAL_TERRENO_2020, */
/* A.AVL_CONVLRPUNCOMTOTAL	 AS VALOR_CONSTRUCCION_2020, A.AVL_INTPUNTUAL AS	VALOR_INTEGRAL_PM, */
/* A.AVL_AVALUOTOTALPUNTUAL AS	AVALUO_PREDIO_PM, 1 AS PUNTO_MUESTRA POR LLAVE */
/* LA BASE DE PUM ES COMUN.FOCA_ANALISIS_VALORES_2020 */
/**************************************************************************************************************/
/* TIPO_MUESTRA_2020 SE TRAE DE COMUN.TIPO_PUNTO_MUESTRA_2020 POR CHIP */
/**************************************************************************************************************/

PROC SQL;
CREATE TABLE PRUEBA.PREDIO_VISTA_PROD_22
AS SELECT A.*, B.EXCLUSION, B.F_EXP AS F_EXPANSION, B.PUNTO_MUESTRA, B.INCLUSION_FORZOSA
FROM PREDIO_VISTA_PROD_18 AS A
LEFT JOIN (SELECT DISTINCT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, 
CODIGO_CONSTRUCCION, CODIGO_RESTO, F_EXP, EXCLUSION, PUNTO_MUESTRA, INCLUSION_FORZOSA
FROM COMUN.MARCO_FINAL_2022 AS B)
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
                    A.CODIGO_RESTO = B.CODIGO_RESTO;
QUIT;


proc import datafile = "&RUTA.\Verificacion_calculos\input\211006_PM.xlsx"
 out  =  COMUN.FOCA_ANALISIS_VALORES_2022
 dbms  =  xlsx
 replace;
 sheet  =  "Sheet1";
run;

proc import datafile = "&RUTA.\Verificacion_calculos\input\Ofertas_depuradas_PH.xlsx"
 out  =  COMUN.OFERTA_PH_2022
 dbms  =  xlsx
 replace;
 sheet  =  "OFERTAS ENTREGABLES";
run;


PROC SQL;
CREATE TABLE OFERTAS_PH_2022 AS SELECT DISTINCT 
CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
VALOR_FINAL_ESTADISTICA AS AVALUO_PREDIO_OF, VALOR_INTEGRAL_ESTADISTICA AS VALOR_INTEGRAL_OF, ESTADO_FINAL, 1 AS OFERTA
FROM COMUN.OFERTA_PH_2022
WHERE ESTADO_FINAL = "Válida censo";
QUIT;


PROC SORT DATA=OFERTAS_PH_2022 NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO;RUN;

PROC SQL; CREATE TABLE FOCA_PMUESTRA_PH_2022 AS SELECT DISTINCT
A.CHIP, A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, A.CODIGO_CONSTRUCCION, A.CODIGO_RESTO, 
/*A.AVL_OBSERVACIONES,A.AVL_ZONAHF,	
A.AVL_TVLRCOMPUNUNITARIO AS	VALOR_UNIT_TERRENO_2020,
A.AVL_TVLRCOMPUNTOTAL AS VALOR_TOTAL_TERRENO_2020,
A.AVL_CONVLRPUNCOMTOTAL	 AS VALOR_CONSTRUCCION_2020,*/
A.AVL_INTPUNTUAL AS	VALOR_INTEGRAL_PM,
A.AVL_AVALUOTOTALPUNTUAL AS	AVALUO_PREDIO_PM,
1 AS PM_EFECTIVO
FROM
COMUN.FOCA_ANALISIS_VALORES_2022 AS A
WHERE A.AVL_INTPUNTUAL > 0 AND A.AVL_INTPUNTUAL NE .;
QUIT;

PROC SORT DATA=FOCA_PMUESTRA_PH_2022 NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO;RUN;




PROC SQL;
CREATE TABLE PRUEBA.PREDIO_VISTA_PROD_23
AS SELECT A.*, B.*, C.*
FROM PRUEBA.PREDIO_VISTA_PROD_22 AS A 
LEFT JOIN FOCA_PMUESTRA_PH_2022 AS B 
ON A.CODIGO_BARRIO = B.CODIGO_BARRIO AND
A.CODIGO_MANZANA = B.CODIGO_MANZANA AND
A.CODIGO_PREDIO = B.CODIGO_PREDIO AND 
A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION AND 
A.CODIGO_RESTO = B.CODIGO_RESTO
LEFT JOIN OFERTAS_PH_2022 AS C 
ON A.CODIGO_BARRIO = C.CODIGO_BARRIO AND
A.CODIGO_MANZANA = C.CODIGO_MANZANA AND
A.CODIGO_PREDIO = C.CODIGO_PREDIO AND 
A.CODIGO_CONSTRUCCION = C.CODIGO_CONSTRUCCION AND 
A.CODIGO_RESTO = C.CODIGO_RESTO;
QUIT;

/* EL SIGUIENTE BLOQUE SE DEJA COMENTADO PARA RECORDAR QUE LAS OFT SOLO SE UTILIZAN PARA LOS MODELOS 2, 3, 4, 5 Y 6 PH */

/*
DATA REVISA;
SET COMUN.MARCO_FINAL_2022;
IF PUNTO_MUESTRA = 1 OR (OFERTA = 1 AND MODELO_0 IN ("M01_2", "M01_3", "M02_4", "M02_5", "M02_6")) and
MODELO_0 IN ("M01_1", "M01_2", "M01_3", "M02_4", "M02_5", "M02_6", "M03", "M04", "M05", "M06_123", "M06_456") AND EXCLUSION = "INCLUSION";
KEEP MODELO_0 CHIP F_EXP INCLUSION_FORZOSA PUNTO_MUESTRA PUNTO_MUESTRA_EFECTIVO OFERTA EXCLUSION;
RUN;
*/
PROC SQL; CREATE TABLE PRUEBA.PREDIO_VISTA_PROD_23 AS SELECT 
A.*,
CASE WHEN (A.PM_EFECTIVO = 1) THEN 1 
	 WHEN (A.OFERTA = 1 AND A.MODELO_0 IN ('M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6')) THEN 1 
ELSE 0 END  AS FOCA_MODELACION, 
CASE WHEN (A.PM_EFECTIVO = 1) THEN VALOR_INTEGRAL_PM 
	 WHEN (A.OFERTA = 1 AND A.MODELO_0 IN ('M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6')) THEN VALOR_INTEGRAL_OF 
ELSE 0 END  AS VALOR_INTEGRAL,
CASE WHEN (A.PM_EFECTIVO = 1) THEN AVALUO_PREDIO_PM
	 WHEN (A.OFERTA = 1 AND A.MODELO_0 IN ('M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6')) THEN AVALUO_PREDIO_OF
ELSE 0 END  AS AVALUO_PREDIO
FROM PRUEBA.PREDIO_VISTA_PROD_23 AS A;
QUIT;


DATA PRUEBA.PREDIO_VISTA_PROD_23;
SET PRUEBA.PREDIO_VISTA_PROD_23;
IF MODELO_0 NOT IN ("M01_1", "M01_2", "M01_3", "M02_4", "M02_5", "M02_6", "M03", "M04", "M05", "M06_123", "M06_456") THEN FOCA_MODELACION = 0;
RUN;
/*
DATA REVISA;
SET PRUEBA.PREDIO_VISTA_PROD_23;
IF PUNTO_MUESTRA = 1 OR (OFERTA = 1 AND MODELO_0 IN ("M01_2", "M01_3", "M02_4", "M02_5", "M02_6")) and
MODELO_0 IN ("M01_1", "M01_2", "M01_3", "M02_4", "M02_5", "M02_6", "M03", "M04", "M05", "M06_123", "M06_456") AND EXCLUSION = "INCLUSION";
KEEP MODELO_0 CHIP PM_EFECTIVO
F_EXP INCLUSION_FORZOSA PUNTO_MUESTRA PUNTO_MUESTRA_EFECTIVO OFERTA EXCLUSION
FOCA_MODELACION
VALOR_INTEGRAL_PM
VALOR_INTEGRAL_OF
VALOR_INTEGRAL;
RUN;
*/
/**************************************************************************************************************/
/*10. INFORMACIÓN DE MUTACIONES FISICAS. */
/**************************************************************************************************************/

PROC SQL; CREATE TABLE PRUEBA.PREDIO_VISTA_PROD_23 AS SELECT A.*,B.MUTADOS
FROM PRUEBA.PREDIO_VISTA_PROD_23 AS A 
LEFT JOIN (SELECT DISTINCT CHIP, 1 AS MUTADOS FROM ODBCLIB.TMP_MUT_FISICA_2021) AS B ON
A.CHIP = B.CHIP;
QUIT;


/**************************************************************************************************************/
/*10. CÁLCULO DE VARIABLES DUMMY PARA LOS MODELOS. */
/**************************************************************************************************************/
/*
DATA REVISA;
SET ODBCLIB.IDENTIFICADOR;
IF CHIP = "AAA0274STFT";
RUN;

PROC SQL;
CREATE TABLE REVISA_2 AS SELECT A.*
FROM  PRUEBA.RES_FORM_PRED_SIIC_&VIGENCIA. AS A 
INNER JOIN REVISA AS B
ON A.CODIGO_BARRIO=B.CODIGO_BARRIO AND
A.CODIGO_MANZANA=B.CODIGO_MANZANA AND
A.CODIGO_PREDIO=B.CODIGO_PREDIO  AND
A.CODIGO_CONSTRUCCION=B.CODIGO_CONSTRUCCION AND 
A.CODIGO_RESTO=B.CODIGO_RESTO;
QUIT;
*/


DATA PRUEBA.PREDIO_VISTA_DUMMIES; SET PRUEBA.PREDIO_VISTA_PROD_23; /*CREACION DE VARIABLES PARTICULARES DE PARA MODELOS Y DUMMIES*/
VALOR_REFERENCIA_2020 = VALOR_M2_TERRENO_COM_20;
IF CODIGO_BARRIO IN('006516') THEN DUMMY_TINTAL=1; ELSE DUMMY_TINTAL=0;
IF CODIGO_BARRIO IN('003201','003202') THEN DUMMY_CRUCBER=1; ELSE DUMMY_CRUCBER=0;
IF CODIGO_BARRIO IN('003104') THEN DUMMY_CONCORDIA=1; ELSE DUMMY_CONCORDIA=0;
IF CODIGO_BARRIO IN('003105','003103') THEN DUMMY_EGIPTOAGUAS=1; ELSE DUMMY_EGIPTOAGUAS=0;
IF CODIGO_BARRIO IN('008413','008415','008417','008406') THEN DUMMY_STABARBAR=1; ELSE DUMMY_STABARBAR=0;
IF CODIGO_BARRIO IN('008308', '008309','008310','008311') THEN DUMMY_RETIROCHI=1; ELSE DUMMY_RETIROCHI=0;
IF CODIGO_BARRIO IN('006313', '006320') THEN DUMMY_SALITHAYU=1; ELSE DUMMY_SALITHAYU=0;

ARMAZON_FERROCONCRETO=0;
IF ARMAZON_ESTRUCTURA IN ('111','112') AND (COMPLEMENTO_INDUSTRIA IN ('511','512','513','514','515') OR AREA_CONSTRUIDA > 500) THEN ARMAZON_FERROCONCRETO = 1; ELSE DO;
IF ARMAZON_ESTRUCTURA IN ('114','115')  THEN ARMAZON_FERROCONCRETO=1;
END;


CERCHA_LIVIANA =0;
CERCHA_MEDIANA =0;
CERCHA_PESADA =0;
IF COMPLEMENTO_INDUSTRIA IN ('514') AND 0<AREA_CONSTRUIDA <= 10000 THEN CERCHA_MEDIANA =1;
IF COMPLEMENTO_INDUSTRIA NOT IN ('514') AND 0<AREA_CONSTRUIDA <= 1000 THEN CERCHA_LIVIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('000','') AND   AREA_CONSTRUIDA > 10000  THEN CERCHA_PESADA =1;
IF COMPLEMENTO_INDUSTRIA IN ('000','') AND 0<AREA_CONSTRUIDA <= 10000 THEN CERCHA_LIVIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('511','512') THEN CERCHA_LIVIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('513') AND   AREA_CONSTRUIDA > 1000 THEN CERCHA_MEDIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('514','515') AND AREA_CONSTRUIDA > 10000 THEN CERCHA_PESADA =1;

DUMMY_ESPNORTE=0;
IF CODIGO_BARRIO='006303' THEN DUMMY_ESPNORTE=1;
NUMERO_PISO_01=0;
NUMERO_PISO_02=0;
NUMERO_PISO_03=0;
IF NUMERO_PISO=1 THEN NUMERO_PISO_01=1;
IF NUMERO_PISO=2 THEN NUMERO_PISO_02=1;
IF NUMERO_PISO=3 THEN NUMERO_PISO_03=1;

IF CODIGO_BARRIO IN('003107') THEN DUMMY_SI=1; ELSE DUMMY_SI=0;
IF CODIGO_BARRIO IN('003108') THEN DUMMY_CAPUCHINA=1; ELSE DUMMY_CAPUCHINA=0;
IF CODIGO_BARRIO IN('004208') THEN DUMMY_EJIDOS=1; ELSE DUMMY_EJIDOS=0;
IF CODIGO_BARRIO IN ("006401", "006402", "006403", "006408", "006410", "006420") THEN DUMMY_MACRO_18 = 1; ELSE DUMMY_MACRO_18 = 0;
IF CODIGO_BARRIO IN('005637') THEN DUMMY_VILLA_GLADYS=1; ELSE DUMMY_VILLA_GLADYS=0;
RUN;

/**************************************************************************************************************/
/*10. CÁLCULO DE VALORES INTEGRALES DE LOS MODELOS. */
/**************************************************************************************************************/


DATA PREDIO_VISTA_MODELOS; SET PRUEBA.PREDIO_VISTA_DUMMIES; /*PROGRAMACION MODELOS*/
		
IF MODELO_0='M01_1' THEN VALOR_INTEGRAL_20&VIGENCIA_2.= EXP(24.5745418003291000000000 +
(0.17276382906867300000000*USO_037) +
(-0.0078321874420895300000*AREA_CONSTRUIDA) +
(2.39835143788454000000000*SAN_CRISTOBAL) +
(2.29554662844096000000000*USME) +
(0.66545402544068000000000*BOSA) +
(0.77404043613946500000000*KENNEDY) +
(2.94222905581562000000000*RAFAEL_U_U) +
(1.27015396236594000000000*C_BOLIVAR) +
(-0.0206952907737807000000*EDAD) +
(0.00039373501394862800000*COL_PUB) +
(-0.0000455767021716299000*COL_PRIV) +
(0.69810411483126500000000*ZHF_1213_13) +
(0.49511338838854900000000*ZHF_4_TRAT_DESARR) +
(-0.0001257544379978260000*COORDENADA_X) +
(0.00060840085823031700000*EST02) +
(0.14317850401394600000000*CENTCOMERC_200_500) +
(0.68490086373436500000000*ZHF_1213_12) +
(0.07898706774122030000000*ZMPA_0_50) +
(0.26215802789631700000000*RELACION_AREA) +
(-0.0001610807825286550000*ESTACTM) );

IF MODELO_0='M01_2' THEN VALOR_INTEGRAL_20&VIGENCIA_2.= EXP(14.1082097721274000000000 +
(0.00251400767349227000000*SANTAFE) +
(0.20504236322571400000000*SAN_CRISTOBAL) +
(0.09424939790690140000000*USME) +
(0.16333597767690900000000*TUNJUELITO) +
(-0.1581289414395240000000*BOSA) +
(0.08909079898387610000000*KENNEDY) +
(0.08217491082587370000000*FONTIBON) +
(-0.0578566387967322000000*ENGATIVA) +
(-0.0205374933093599000000*SUBA) +
(-0.2430745212361210000000*MARTIRES) +
(-0.1769218850287310000000*A_NARINO) +
(-0.3525463943163310000000*CANDELARIA) +
(0.08997616257066400000000*RAFAEL_U_U) +
(0.03589471932728370000000*C_BOLIVAR) +
(-0.0042608617118284900000*AREA_CONSTRUIDA) +
(-0.0054304810962007000000*EDAD) +
(-0.0476364698630865000000*USO_037) +
(-0.0000611051475216787000*IN_MIL_POL) +
(-0.0000225760319486002000*EST04) +
(0.00006273665901272820000*COL_PUB) +
(-0.0000982976880785735000*COL_PRIV) +
(-0.0315969170310543000000*ZHF_10_EST_VIA_REG) +
(0.00003834020862300470000*PORTALTM) +
(-0.0000351100031354313000*CENTCOMERC) +
(-0.0000277218473249839000*ESTACTM) +
(0.00001504200379396960000*ZMPA) +
(0.06247945181162310000000*ZHF_1213_21) +
(0.00001166007156048300000*COORDENADA_Y) +
(-0.1920583009360660000000*AREA_ACT4) +
(-0.0298703189149992000000*ZHF_1213_17) +
(0.04732132187831230000000*ZHF_4_TRAT_MEJ) +
(0.19499596505036400000000*AREA_ACT5) +
(-0.0322407336677966000000*ZHF_11_INF_VIA_LOCAL) +
(0.03317632075732600000000*ZHF_4_TRAT_CONSOL) +
(0.00267144765387841000000*RELACION_AREA) +
(0.00049226081416796000000*PUNTAJE) +
(0.04228910700892020000000*ZHF_1213_14) +
(0.00690416004291756000000*AREA_CONSTRUIDA*CANDELARIA) +
(-0.0654121901616009000000*RELACION_AREA*SUBA) +
(-0.0728667033386333000000*RELACION_AREA*SAN_CRISTOBAL) +
(-0.0025988579683657300000*EDAD*CANDELARIA) +
(0.00233681189602582000000*AREA_CONSTRUIDA*BOSA) +
(0.00299646594944311000000*AREA_CONSTRUIDA*SANTAFE) +
(0.00193709380889595000000*AREA_CONSTRUIDA*ENGATIVA) +
(-0.1232871554766240000000*RELACION_AREA*USME) +
(0.00509932458945183000000*EDAD*BOSA) +
(-0.0053834184462609600000*EDAD*SANTAFE) +
(0.00682948818837451000000*USME*PUNTAJE) +
(0.00342818491306718000000*EDAD*USME) +
(0.25186848881238700000000*CANDELARIA*ZHF_1213_14) +
(-0.1315280268567100000000*ZHF_1213_21*ENGATIVA) +
(0.17013556715591700000000*ZHF_4_TRAT_CONSOL*C_BOLIVAR) +
(-0.0759019069424227000000*ZHF_1213_21*KENNEDY) +
(0.14596329169838300000000*ZHF_10_EST_VIA_REG*RAFAEL_U_U) +
(0.06222906910087020000000*ZHF_4_TRAT_CONSOL*RAFAEL_U_U) +
(-0.3221270313560680000000*ZHF_4_TRAT_MEJ*RAFAEL_U_U) +
(-0.0690174785719829000000*ZHF_11_INF_VIA_LOCAL*SAN_CRISTOBAL) +
(-0.1772621542892120000000*ZHF_11_INF_VIA_LOCAL*RAFAEL_U_U) +
(-0.0391768345724067000000*ZHF_4_TRAT_MEJ*KENNEDY) +
(-0.2209216891983260000000*ZHF_10_EST_VIA_REG*SANTAFE) );

IF MODELO_0='M01_3' THEN VALOR_INTEGRAL_20&VIGENCIA_2.=EXP(11.2604648218923000000000 +
(0.00322287446631027000000*PUNTAJE) +
(-0.0021032288108407600000*AREA_CONSTRUIDA) +
(-0.5797776505634880000000*CHAPINERO) +
(-0.2031848063268790000000*SANTAFE) +
(0.09421805119752240000000*SAN_CRISTOBAL) +
(0.45672743208114800000000*TUNJUELITO) +
(0.13576284210127100000000*BOSA) +
(0.18554293578338000000000*KENNEDY) +
(-0.1178450545888190000000*FONTIBON) +
(0.13844169928378600000000*ENGATIVA) +
(0.10555727923790600000000*SUBA) +
(-0.0378177510823947000000*B_UNIDOS) +
(0.25362476080867600000000*TEUSAQUILLO) +
(0.36159617090891400000000*MARTIRES) +
(0.24480729212553400000000*A_NARINO) +
(0.27981524632334100000000*P_ARANDA) +
(0.01581122316062140000000*CANDELARIA) +
(0.42212932927578200000000*RAFAEL_U_U) +
(0.17298278478542800000000*C_BOLIVAR) +
(0.00005440638759992180000*COORDENADA_X) +
(-0.0031640167961540600000*EDAD) +
(-0.0246541512091641000000*RELACION_AREA) +
(0.06496253904023160000000*USO_037) +
(0.00003042024729572180000*EST01) +
(0.30780033289312400000000*AREA_ACT5) +
(0.00006499353914788520000*COL_PUB) +
(0.46098126151060600000000*DENSIDAD) +
(-0.0001801921956803090000*PKVENCIN) +
(0.05339931036218400000000*ZHF_1213_17) +
(-0.0198963292588906000000*ZHF_10_EST_VIA_REG) +
(0.02487360032754280000000*GB4) +
(-0.0000143987844031283000*CLINIC123) +
(-0.0100877986942892000000*ZHF_11_INF_VIA_ZO_INT) +
(0.16315864115672200000000*ZHF_6_TOPOG_PLANA) +
(-0.0000140045129706571000*PKMETROP) +
(-0.0813076160392290000000*ZHF_1213_23) +
(-0.0166024387950379000000*GA2) +
(-0.0000206898220780852000*ESTACTM) +
(-0.0000385244504121059000*RFNAL) +
(-0.0207539552369423000000*GC3) +
(-0.0001194480065789860000*AEROPTO) +
(0.00006263557904782630000*EST02) +
(0.00002911579958085660000*EST06) +
(0.03392735300673930000000*ZHF_1213_13) +
(0.03634842007712360000000*ZHF_1213_14) +
(0.11382347750775500000000*ZHF_1213_12) +
(0.12856500114382800000000*GA4) +
(0.00006957908413858570000*ZOINFLRUID) +
(-0.0000109199939742261000*COORDENADA_Y) +
(0.06434216646627760000000*ZHF_6_TOPOG_INCL) +
(-0.1468542507003440000000*ZHF_10_EST_VIA_MALO) +
(0.00152000262896518000000*AREA_CONSTRUIDA*SANTAFE) +
(-0.0029777392899312100000*AREA_CONSTRUIDA*TUNJUELITO) +
(-0.0013886073367236800000*AREA_CONSTRUIDA*A_NARINO) +
(-0.0011181649535446400000*AREA_CONSTRUIDA*ENGATIVA) +
(-0.0520777969615144000000*RELACION_AREA*MARTIRES) +
(-0.0064591431624781500000*EDAD*B_UNIDOS) +
(0.00958972783291755000000*PUNTAJE*CHAPINERO) +
(0.00734297726356294000000*PUNTAJE*FONTIBON) +
(-0.0027695386532544400000*EDAD*P_ARANDA) +
(0.05663382673679320000000*RELACION_AREA*B_UNIDOS) +
(-0.0032000193665595300000*EDAD*SANTAFE) +
(-0.0040418085739093000000*EDAD*TEUSAQUILLO) +
(0.00259485956002397000000*PUNTAJE*C_BOLIVAR) +
(-0.0033723234050973200000*EDAD*SUBA) +
(-0.0049054201108153600000*EDAD*MARTIRES) +
(0.06614351877759890000000*RELACION_AREA*TUNJUELITO) +
(0.02951434593749030000000*RELACION_AREA*SANTAFE) +
(0.04139331049850550000000*RELACION_AREA*KENNEDY) +
(0.03127093993002750000000*RELACION_AREA*CANDELARIA) +
(0.03121837949934350000000*RELACION_AREA*CHAPINERO) +
(0.03635188316016510000000*RELACION_AREA*C_BOLIVAR) +
(-0.2621823154810830000000*ZHF_10_EST_VIA_REG*MARTIRES) +
(-0.1234917724654390000000*ZHF_1213_13*RAFAEL_U_U) +
(-0.0935284161552836000000*ZHF_11_INF_VIA_ZO_INT*KENNEDY) +
(-0.0776699471090832000000*ZHF_10_EST_VIA_REG*SANTAFE) +
(-0.0438508552865279000000*ZHF_10_EST_VIA_REG*KENNEDY) +
(-0.0871365418171057000000*ZHF_10_EST_VIA_REG*TUNJUELITO) +
(0.15655272208699700000000*ZHF_11_INF_VIA_ZO_INT*SAN_CRISTOBAL) +
(0.17608479100372300000000*ZHF_1213_17*A_NARINO) +
(-0.1119524572117010000000*ZHF_6_TOPOG_PLANA*RAFAEL_U_U) +
(0.25769073284505400000000*ZHF_1213_23*ENGATIVA) +
(0.09240420693448590000000*ZHF_10_EST_VIA_REG*SAN_CRISTOBAL) );	
	

IF MODELO_0='M02_4' THEN VALOR_INTEGRAL_20&VIGENCIA_2.=EXP(15.3161896090406000000000 +
(0.29683233259348500000000*CHAPINERO) +
(0.22332652532429300000000*SANTAFE) +
(0.01526787292526170000000*KENNEDY) +
(-0.1725781547224310000000*FONTIBON) +
(0.02113243717726780000000*ENGATIVA) +
(-0.0962504476102933000000*SUBA) +
(-0.1281821736641220000000*B_UNIDOS) +
(0.07723317352600810000000*TEUSAQUILLO) +
(-0.0314573105619220000000*MARTIRES) +
(-0.1683058537862910000000*P_ARANDA) +
(-0.0070267788425322300000*EDAD) +
(0.00000003090550143812070*VALOR_REFERENCIA_2022) +
(-0.0019133092136162900000*AREA_CONSTRUIDA) +
(0.00241229898574620000000*PUNTAJE) +
(-0.0533560617433074000000*ZHF_12_ACT_ECON_COM) +
(-0.0421935531548687000000*ZHF_6_TOPOG_INCL) +
(0.06663892977504030000000*USO_037) +
(0.00004778035821800400000*EST01) +
(-0.0000394011439953423000*EST06) +
(-0.0000314437200599627000*HOSP123) +
(-0.4512557686836510000000*DENSIDAD) +
(0.00645025688140690000000*RELACION_AREA) +
(0.00002097880941418900000*PKZONAL) +
(0.07521686451689670000000*ZHF_1213_18) +
(-0.0002118744542785420000*ZOINFLRUID) +
(0.00020801249742234500000*AEROPTO) +
(-0.0000221430625365866000*PKMETROP) +
(-0.0840785640642749000000*AREA_ACT4) +
(0.00002102388270254560000*ZMPA) +
(0.03164689864341480000000*ZHF_1213_21) +
(0.00602205172064724000000*ZHF_10_EST_VIA_BUENO) +
(-0.0175472851346535000000*ZHF_11_INF_VIA_ZO_INT) +
(0.00364340008278045000000*ZHF_11_INF_VIA_ART_COM) +
(0.09896494105100470000000*ZHF_10_EST_VIA_BUENO*CHAPINERO) +
(0.07921241911054120000000*ZHF_11_INF_VIA_ZO_INT*SUBA) +
(-0.0016484583075286600000*EDAD*TEUSAQUILLO) +
(0.07489292773678770000000*RELACION_AREA*FONTIBON) +
(0.40947479853394000000000*ZHF_11_INF_VIA_ART_COM*B_UNIDOS) +
(-0.0029364162181980200000*PUNTAJE*CHAPINERO) +
(0.06913348207926930000000*RELACION_AREA*P_ARANDA) +
(0.00080613691266003000000*AREA_CONSTRUIDA*SANTAFE) +
(0.00093784804246733700000*AREA_CONSTRUIDA*FONTIBON) +
(0.04723168085529440000000*RELACION_AREA*MARTIRES) +
(-0.0000000364016291742887*VALOR_REFERENCIA_2022*SUBA) +
(0.01588220308178700000000*RELACION_AREA*TEUSAQUILLO) +
(0.00237994676964970000000*PUNTAJE*SUBA) +
(0.14190133446146000000000*AREA_ACT4*SUBA) +
(0.08949000169657590000000*AREA_ACT4*TEUSAQUILLO) +
(0.23346394093429500000000*AREA_ACT4*B_UNIDOS) +
(0.00338940806412596000000*EDAD*FONTIBON) +
(-0.0616333514039266000000*ZHF_1213_21*CHAPINERO) );

IF MODELO_0='M02_5' THEN VALOR_INTEGRAL_20&VIGENCIA_2. = EXP(20.8867560117578000000000 +
(-0.0100972313223237000000*EDAD) +
(-0.0000256946903790701000*COORDENADA_Y) +
(0.00204413364785431000000*PUNTAJE) +
(-0.1178855484158810000000*USAQUEN) +
(0.05864476478219260000000*CHAPINERO) +
(0.14926145422181800000000*SUBA) +
(0.23501546724129700000000*B_UNIDOS) +
(-0.1088448017254700000000*TEUSAQUILLO) +
(-0.0007229408222838420000*AREA_CONSTRUIDA) +
(-0.0479613666623774000000*AREA_ACT6) +
(-0.4467039520714610000000*ZHF_12_ACT_ECON_COM) +
(-0.4369609612698470000000*ZHF_12_ACT_ECON_RES) +
(0.05678451174377880000000*USO_037) +
(0.00012422003359229300000*PKVENCIN) +
(-0.0962226039217619000000*Tip7) +
(0.00000003331986410913660*VALOR_REFERENCIA_2022) +
(0.17989182747672700000000*CENTCOMERC_0_100) +
(-0.0000193849527029925000*COORDENADA_X) +
(-0.3944928032020150000000*GC1) +
(0.08804665249233290000000*ZHF_10_EST_VIA_EXC) +
(0.03536257236399530000000*ZHF_1213_16) +
(-0.0000298184360326632000*COL_PRIV) +
(0.03675534490991430000000*PISO_11_20) +
(-0.0000194636854660612000*EST06) +
(-0.0511587530081995000000*ZMPA_0_50) +
(-0.5197032490437040000000*DENSIDAD) +
(0.02257645355021770000000*PISO_6_10) +
(0.03917290576712730000000*ZHF_1213_15) +
(0.05219165133700890000000*ZHF_4_TRAT_CONSOL) +
(-0.0573882074346050000000*ZHF_1213_23) +
(0.37134100489240600000000*ZHF_1213_16*SUBA) +
(0.00000003171587684428200*VALOR_REFERENCIA_2022*USAQUEN) +
(-0.0006070396779022790000*AREA_CONSTRUIDA*SUBA) +
(-0.0042674627376339100000*AREA_CONSTRUIDA*B_UNIDOS) +
(-0.0000000644126500475659*VALOR_REFERENCIA_2022*SUBA) );	

IF MODELO_0='M02_6' THEN VALOR_INTEGRAL_20&VIGENCIA_2.=EXP(15.7658924426709000000000 +
(-0.0110374112084799000000*EDAD) +
(0.21217188789593700000000*CHAPINERO) +
(-0.1048024440311640000000*SUBA) +
(0.11779236520147600000000*ZHF_1213_14) +
(0.01229186676492950000000*ZHF_1213_15) +
(0.06969891867888480000000*ZHF_1213_16) +
(0.01162170319130710000000*ZHF_1213_21) +
(0.01646014910771640000000*ZHF_1213_22) +
(-0.0000686436834440841000*CAI) +
(0.00201870494834992000000*PUNTAJE) +
(-0.8557280785620500000000*DENSIDAD) +
(0.00046004679192622700000*NUMERO_UNIDADES_RES_BMP) +
(-0.0132190450834477000000*RELACION_AREA) +
(0.00007823756173236210000*PKBOLSIL) +
(0.00005861941563580120000*EST03) +
(-0.0000541589707956558000*COL_PRIV) +
(-0.0187994288418340000000*ZHF_6_TOPOG_INCL) +
(-0.0478773893270669000000*ZHF_6_TOPOG_EMP) +
(-0.2903125771981500000000*ZHF_4_TRAT_RENOV) +
(0.07466127705244140000000*ZHF_4_TRAT_CONSERV) +
(0.01358463710593130000000*ZHF_4_TRAT_REDES) +
(-0.0000483767014209976000*EST04) +
(0.00003694739785699760000*PKZONAL) +
(-0.0019412635511263100000*EDAD*CHAPINERO) +
(0.86430774171874700000000*DENSIDAD*CHAPINERO) +
(0.00347807450253294000000*EDAD*SUBA) );	

IF MODELO_0='M03' THEN VALOR_INTEGRAL_20&VIGENCIA_2.=EXP(24.8422987915780000000000 +
(-0.0079140244314766600000*EDAD) +
(0.00551944121570927000000*PUNTAJE) +
(-0.9915156412115240000000*DUMMY_EJIDOS) +
(0.02761896955864240000000*USO_045) +
(0.04110807454301470000000*USO_046) +
(0.41790020025628100000000*USO_059) +
(-0.4574958164710300000000*USO_081) +
(-0.0446856104610548000000*USO_092) +
(-0.1172566391980730000000*CHAPINERO) +
(-0.3404447662210230000000*SANTAFE) +
(-0.6586158463928210000000*SAN_CRISTOBAL) +
(-0.7092998585568020000000*TUNJUELITO) +
(-0.2852204124563860000000*FONTIBON) +
(-0.2698983429239700000000*ENGATIVA) +
(-0.0619274075138562000000*SUBA) +
(-0.1328622100528600000000*B_UNIDOS) +
(-0.0799503496391448000000*TEUSAQUILLO) +
(-0.2392336575583510000000*MARTIRES) +
(-0.4960247707287190000000*A_NARINO) +
(-0.4027627631071310000000*P_ARANDA) +
(-0.4031318770160510000000*CANDELARIA) +
(-0.0001118416179855130000*AREA_CONSTRUIDA) +
(0.00423669770501453000000*NUMERO_PISO) +
(-0.0000519756406626279000*COORDENADA_Y) +
(0.04402138261655910000000*ZHF_10_EST_VIA_BUENO) +
(-0.0685046535429372000000*ZHF_10_EST_VIA_EXC) +
(-0.0000612016820075017000*PKBOLSIL) +
(-0.0495392137273059000000*AREA_ACT2) +
(-0.0108784882583347000000*AREA_ACT3) +
(-0.0571192996609965000000*AREA_ACT4) +
(-0.0617193747522651000000*AREA_ACT5) +
(-0.2573992236297470000000*AREA_ACT6) +
(0.00213374517415480000000*AREA_ACT7) +
(-0.2176333658743660000000*ZHF_4_TRAT_DESARR) +
(-0.0296790030045970000000*ZHF_4_TRAT_CONSOL) +
(-0.0674344328646873000000*ZHF_4_TRAT_RENOV) +
(-0.0000442301522622192000*RFREGION) +
(-0.0000883900526227016000*EST05) +
(-0.1294827647182980000000*CONSERVACION_M) +
(0.00319033264969733000000*CONSERVACION_N) +
(-0.0126720773677501000000*CONSERVACION_T) +
(0.00000000951335789208144*VALOR_REFERENCIA_2022) +
(0.29750680579851100000000*DUMMY_ESPNORTE) +
(-0.0000559550911357181000*PORTALTM) +
(0.00013856666402828900000*EST03) +
(0.00003219717200037770000*EST01) +
(0.00005062378889108100000*PKMETROP) +
(-0.0001069466084499020000*CAI) +
(-0.2041044016817880000000*CENT_CENTRO_H_INT) +
(0.00003084728022484680000*ZOINFLRUID) +
(-0.0000326371900780999000*COORDENADA_X) +
(-0.0001240407147986330000*PKVENCIN) +
(-0.0458359970627418000000*ZHF_11_INF_VIA_ZO_INT) +
(0.02450787007356660000000*ZHF_11_INF_VIA_ART_COM) +
(0.03567473685836120000000*ZHF_11_INF_VIA_ART_BAS) +
(0.03761455744220990000000*CENT_CLL_72_CLL_100) +
(0.00012760225394350500000*PKZONAL) );


IF MODELO_0='M04' THEN VALOR_INTEGRAL_20&VIGENCIA_2.=EXP(16.0320217341930000000000 +
(0.00000010669540991265300*VALOR_REFERENCIA_2022) +
(0.00720380349581769000000*PUNTAJE) +
(-0.0027920827594011400000*EDAD) +
(-0.2960703331336140000000*CHAPINERO) +
(-0.1363532647823920000000*SANTAFE) +
(-0.0795771126926989000000*SAN_CRISTOBAL) +
(-0.3932835900739380000000*USME) +
(-0.3756128814130070000000*TUNJUELITO) +
(0.01789989921001560000000*BOSA) +
(-0.2253615047395240000000*KENNEDY) +
(0.10541305846412200000000*FONTIBON) +
(-0.1571513051842170000000*ENGATIVA) +
(-0.3550022678010060000000*SUBA) +
(-0.1387641390598550000000*B_UNIDOS) +
(-0.0034758082630060400000*TEUSAQUILLO) +
(0.04159270359152240000000*MARTIRES) +
(-0.0556584352377991000000*A_NARINO) +
(-0.2641894429893110000000*P_ARANDA) +
(31.9407097817008000000000*CANDELARIA) +
(-0.1740635075374890000000*RAFAEL_U_U) +
(-0.2803512899725600000000*C_BOLIVAR) +
(-0.2752153405157500000000*AREA_ACT2) +
(-0.7642510940235540000000*AREA_ACT3) +
(-0.3305155771935410000000*AREA_ACT4) +
(-0.3187542202660310000000*AREA_ACT5) +
(-0.2367458928878020000000*AREA_ACT6) +
(-0.3538743338364240000000*AREA_ACT7) +
(0.34356236789008900000000*NUMERO_PISO_01) +
(0.22943386602568700000000*NUMERO_PISO_02) +
(0.00010802453464679700000*COL_PUB) +
(-0.3917020607793990000000*ZHF_1213_13) +
(-0.3892755916329760000000*ZHF_1213_14) +
(-0.2589598555231400000000*ZHF_1213_15) +
(-0.4761450234991580000000*ZHF_1213_16) +
(-0.3715078686216450000000*ZHF_1213_17) +
(-0.3782759874402220000000*ZHF_1213_18) +
(-0.3757748138227430000000*ZHF_1213_21) +
(-0.3599205966929670000000*ZHF_1213_22) +
(-0.3140076457722460000000*ZHF_1213_23) +
(-0.0817932270533524000000*ZHF_1213_24) +
(3.13762032598890000000000*DUMMY_SI) +
(0.29725933792388600000000*CENT_USAQUEN_H_STA_BARB) +
(0.02865010346733660000000*ZHF_4_TRAT_DESARR) +
(0.05887689964033790000000*ZHF_4_TRAT_CONSOL) +
(-0.0339331504675567000000*ZHF_4_TRAT_RENOV) +
(0.00533888823496712000000*ZHF_4_TRAT_CONSERV) +
(0.15214485255567400000000*NUMERO_PISO_03) +
(1.32231536818286000000000*DUMMY_CAPUCHINA) +
(-0.0004720294284619620000*AREA_CONSTRUIDA) +
(-0.0175269561409011000000*ZHF_11_INF_VIA_ZO_INT) +
(-0.0029797822743196100000*ZHF_11_INF_VIA_ART_COM) +
(0.06380204083953580000000*ZHF_11_INF_VIA_ART_BAS) +
(-0.0000542696011133818000*IN_MIL_POL) +
(-0.0964323269645163000000*CONSERVACION_M) +
(-0.0183567080823253000000*CONSERVACION_N) +
(-0.0557009585514944000000*CONSERVACION_T) +
(0.00005757980703347370000*CAI) +
(-0.0333915933228052000000*ZHF_10_EST_VIA_REG) +
(-0.0024230243530711700000*ZHF_10_EST_VIA_BUENO) +
(0.15436952380412000000000*ZHF_10_EST_VIA_EXC) +
(-0.0000448743271673200000*COL_PRIV) +
(0.20031781971208600000000*DENSIDAD) +
(-0.0001350453495434640000*PKBOLSIL) +
(-0.0355145043215831000000*SOTANO) +
(0.05114303200183630000000*USO_040) +
(0.04610627135819210000000*USO_060) +
(-0.0000208177736661879000*UNIVERS) +
(0.00002786560025876150000*EST03) +
(-0.0000145487065914554000*RFREGION) +
(0.00005426087012840000000*ZMPA) +
(-0.0000207260808439085000*PKZONAL) +
(0.00002616336769133800000*PORTALTM) +
(-0.5200167037545710000000*DUMMY_MACRO_18) +
(-0.0000074739431716443500*COORDENADA_X) +
(-0.0000001805586086648270*VALOR_REFERENCIA_2022*DUMMY_SI) +
(-0.0150216114292624000000*PUNTAJE*DUMMY_SI) +
(0.00625245747794235000000*DUMMY_SI*AREA_CONSTRUIDA) +
(-0.0000001192426625094980*VALOR_REFERENCIA_2022*DUMMY_CAPUCHINA) +
(-0.0102154689669182000000*PUNTAJE*DUMMY_CAPUCHINA) +
(1.02617759266393000000000*DUMMY_CAPUCHINA*DENSIDAD) +
(-0.0000000143847305781104*VALOR_REFERENCIA_2022*CHAPINERO) +
(0.00371610595379375000000*PUNTAJE*CHAPINERO) +
(-0.4320392301412360000000*DENSIDAD*CHAPINERO) +
(0.00015166811790088200000*AREA_CONSTRUIDA*SANTAFE) +
(0.00000008812702143112030*VALOR_REFERENCIA_2022*SUBA) +
(-0.0058819583760878100000*PUNTAJE*MARTIRES) +
(-0.0088887968371317500000*PUNTAJE*CANDELARIA) +
(0.00032328217987653900000*AREA_CONSTRUIDA*CANDELARIA) +
(-0.0003141883232096160000*COORDENADA_X*CANDELARIA) ); 

IF MODELO_0='M05' THEN VALOR_INTEGRAL_20&VIGENCIA_2.= EXP(15.1129064361573000000000 +
(0.81999875845749600000000*CHAPINERO) +
(0.52382361680671200000000*KENNEDY) +
(0.65002498821193100000000*FONTIBON) +
(0.83402576988295900000000*ENGATIVA) +
(1.15931062733264000000000*SUBA) +
(0.45021941713075800000000*B_UNIDOS) +
(1.50898215522360000000000*TEUSAQUILLO) +
(0.20255532269493300000000*MARTIRES) +
(0.19580948168056900000000*A_NARINO) +
(0.10479191918008700000000*P_ARANDA) +
(0.35658871230411300000000*AREA_ACT2) +
(-0.0553762334335930000000*AREA_ACT4) +
(-0.0584929818045828000000*AREA_ACT7) +
(-0.4446322197070340000000*ZHF_1213_21) +
(0.04759317520657570000000*ZHF_1213_22) +
(0.47303939329055000000000*ZHF_1213_23) +
(0.14689660315963300000000*ZHF_1213_32) +
(20.6292680362044000000000*DENSIDAD) +
(-0.2732596418987010000000*ZHF_10_EST_VIA_REG) +
(-0.3198793890866450000000*ZHF_10_EST_VIA_BUENO) +
(-0.2344119318405100000000*ZHF_10_EST_VIA_EXC) +
(-0.5356683300763970000000*USO_053) +
(-0.0297054649249521000000*USO_091) +
(-0.1663274668953880000000*USO_093) +
(-0.2100711802265770000000*USO_097) +
(0.00000018701964244783600*VALOR_REFERENCIA_2022) +
(-0.6659228941742470000000*CONSERVACION_N) +
(-0.0001684830601129190000*COL_PRIV) +
(-0.0000079582118903815300*AREA_CONSTRUIDA) +
(-0.0770506355783887000000*DUMMY_STABARBAR) +
(-0.3331260801404560000000*DUMMY_VILLA_GLADYS) +
(-0.0256967272705882000000*RELACION_AREA) +
(-0.6946926220727650000000*RELACION_AREA*SUBA) +
(0.00000024229812159761400*VALOR_REFERENCIA_2022*P_ARANDA) +
(-0.1083929876719470000000*RELACION_AREA*P_ARANDA) +
(-0.0007804008166613700000*AREA_CONSTRUIDA*DUMMY_STABARBAR) );


IF MODELO_0='M06_123' THEN VALOR_INTEGRAL_20&VIGENCIA_2.=EXP(14.5454477308414000000000 +
(0.42384795219568700000000*CHAPINERO) +
(0.27309324453012800000000*SANTAFE) +
(0.21833540892287900000000*SAN_CRISTOBAL) +
(0.03892752649879520000000*USME) +
(0.16801335500573800000000*TUNJUELITO) +
(0.05711710026262600000000*BOSA) +
(0.21140144745705400000000*KENNEDY) +
(0.19040496712518800000000*FONTIBON) +
(-0.1530599540072750000000*ENGATIVA) +
(0.02016942658923890000000*SUBA) +
(0.22071751041321900000000*B_UNIDOS) +
(0.37341607587229600000000*TEUSAQUILLO) +
(0.27296624439056800000000*MARTIRES) +
(0.31679757626203600000000*A_NARINO) +
(0.17796321793515400000000*P_ARANDA) +
(0.31231673519355500000000*CANDELARIA) +
(-0.1338992488660640000000*RAFAEL_U_U) +
(0.07482328383988400000000*C_BOLIVAR) +
(-0.1484247636066840000000*ZHF_1213_12) +
(-0.0373068034284696000000*ZHF_1213_13) +
(0.08783391276976210000000*ZHF_1213_14) +
(-0.0230367988284958000000*ZHF_1213_21) +
(0.06588863828827580000000*ZHF_1213_22) +
(0.43512369072885500000000*ZHF_1213_32) +
(-0.1950448159448670000000*AREA_ACT2) +
(-0.2455828228649240000000*AREA_ACT4) +
(-0.1251107549951930000000*AREA_ACT5) +
(-0.1373184370789560000000*AREA_ACT6) +
(-0.2456787506771680000000*AREA_ACT7) +
(0.60303154348748800000000*ZHF_4_TRAT_DESARR) +
(0.07883053918321970000000*ZHF_4_TRAT_CONSOL) +
(0.05481464896097750000000*ZHF_4_TRAT_RENOV) +
(0.06539807382533070000000*ZHF_4_TRAT_CONSERV) +
(-0.1495777040905150000000*USO_009) +
(0.07454232374890560000000*USO_019) +
(0.06505298234769410000000*USO_020) +
(0.03388171063683230000000*USO_022) +
(0.14417008180780900000000*ESTRATO2) +
(0.17967420482187800000000*ESTRATO3) +
(0.00000020475489635946900*VALOR_REFERENCIA_2022) +
(0.00205648453136546000000*PUNTAJE) +
(-0.0011281854806493500000*AREA_CONSTRUIDA) +
(-0.0051933451850777400000*EDAD) +
(-0.1674025851658060000000*RELACION_AREA) +
(0.00001867997506901450000*EST01) +
(-0.0000189305109338967000*EST05) +
(0.00008773153532953970000*PKBOLSIL) +
(0.00000851301618854901000*ZOINFLRUID) +
(-0.0000449597337095987000*ZMPA) +
(0.00000704370185427756000*PORTALTM) +
(-1.7670275617994100000000*DENSIDAD) +
(0.12624020138070300000000*RELACION_AREA*USME) +
(0.00157384934252758000000*AREA_CONSTRUIDA*BOSA) +
(-0.0038374455435472400000*EDAD*BOSA) +
(7.32868678560009000000000*DENSIDAD*BOSA) +
(0.03400580143102060000000*RELACION_AREA*KENNEDY) +
(0.00496662907886153000000*EDAD*ENGATIVA) +
(0.09770342935551720000000*RELACION_AREA*ENGATIVA) +
(0.00323205096071553000000*EDAD*SUBA) +
(0.04192851429223800000000*RELACION_AREA*SUBA) +
(0.00000009676003518494820*VALOR_REFERENCIA_2022*RAFAEL_U_U) +
(12.7541118952275000000000*DENSIDAD*RAFAEL_U_U) +
(0.14387835787761900000000*RELACION_AREA*C_BOLIVAR) );

IF MODELO_0='M06_456' THEN VALOR_INTEGRAL_20&VIGENCIA_2.=EXP(23.6059812137592000000000 +
(-0.4892534819385760000000*CHAPINERO) +
(-0.1540345526375990000000*SANTAFE) +
(-0.1287982303601130000000*KENNEDY) +
(-0.5142931321341750000000*FONTIBON) +
(-0.1339152259623590000000*ENGATIVA) +
(-10.026958344752800000000*SUBA) +
(-0.2358778464491820000000*B_UNIDOS) +
(0.04065331373116870000000*TEUSAQUILLO) +
(-0.2621136708718220000000*P_ARANDA) +
(0.00972210160679928000000*ZHF_1213_14) +
(0.06929544158796130000000*ZHF_1213_15) +
(0.13752828462444100000000*ZHF_1213_16) +
(-0.1237831076812230000000*ZHF_1213_17) +
(0.10869182515631500000000*ZHF_1213_21) +
(0.11065824276872400000000*ZHF_1213_22) +
(-0.0710740616777508000000*ZHF_11_INF_VIA_ZO_INT) +
(0.02050480762777560000000*ZHF_11_INF_VIA_ART_COM) +
(0.02690756453771620000000*ZHF_11_INF_VIA_ART_BAS) +
(-0.0440925349349404000000*ZHF_12_ACT_ECON_RES) +
(-0.1497570279644270000000*ZHF_12_ACT_ECON_COM) +
(0.05229504131461330000000*ESTRATO5) +
(-0.0042910098168812800000*ESTRATO6) +
(0.03351458354525590000000*ZHF_10_EST_VIA_BUENO) +
(-0.0000771573031635269000*COORDENADA_X) +
(0.00000012977229922145100*VALOR_REFERENCIA_2022) +
(0.00181921254709928000000*PUNTAJE) +
(-0.0003500633576567040000*AREA_CONSTRUIDA) +
(-0.0032042839456021600000*EDAD) +
(-4.6943314078247500000000*DENSIDAD) +
(-0.3946070288119660000000*RELACION_AREA) +
(-0.0000652913659857252000*COL_PUB) +
(-0.0000291089484142860000*IN_MIL_POL) +
(-0.0000572782728896829000*EST01) +
(0.00006314198544596490000*EST02) +
(0.00006746507732720510000*EST03) +
(0.00004377382602637910000*EST04) +
(-0.0000762057582905073000*EST06) +
(0.00007182531405813380000*PKMETROP) +
(-0.0001215762963798360000*PKVENCIN) +
(0.00006345492616394160000*PKZONAL) +
(0.00003233997053364750000*CENTCOMERC) +
(-0.0000288462317763534000*HOSP123) +
(-0.0045527628162656200000*EDAD*CHAPINERO) +
(0.31162398461432000000000*RELACION_AREA*CHAPINERO) +
(0.00009839349485468350000*COORDENADA_X*SUBA) +
(-0.0000001598407421162750*VALOR_REFERENCIA_2022*SUBA) +
(0.11057533205617000000000*RELACION_AREA*SUBA) +
(-0.0055462313665750100000*EDAD*TEUSAQUILLO) );
RUN;


/**************************************************************************************************************/
/*10. INFORMACIÓN DE VALORES DE TERRENO CORREGIDOS PROVENIENTES DE ODBCLIB.RESOLUCION_PREDIO_DIG. */
/**************************************************************************************************************/


PROC SQL; 	CREATE TABLE PRUEBA.RES_FORM_PRED_SIIC_&VIGENCIA. AS  /*ZHF Y VALORES TERRENO CORREGIDOS VALOR_M2_TERRENO_COR_19*/
		SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, VIGENCIA_RESOLUCION,  CODIGO_ZONA_FISICA, VALOR_TERRENO
			FROM ODBCLIB.RESOLUCION_PREDIO_DIG
			WHERE VIGENCIA_RESOLUCION = &VIGENCIA.;
			
QUIT;


PROC SORT 	DATA=PRUEBA.RES_FORM_PRED_SIIC NODUPKEY; BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO; RUN;

PROC SQL; 	CREATE TABLE PRUEBA.PREDIO_VISTA_MODELOS AS  /*VALOR_M2_TERRENO_COR_20*/
		SELECT A.*,  B.VALOR_TERRENO AS VALOR_M2_TERRENO_COR_&VIGENCIA_2.
			FROM PREDIO_VISTA_MODELOS AS A LEFT JOIN PRUEBA.RES_FORM_PRED_SIIC_&VIGENCIA. AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO=B.CODIGO_PREDIO;
QUIT;


/**************************************************************************************************************/
/*10. AVALÚOS ESPECIALES. */
/**************************************************************************************************************/

DATA PRUEBA.AVALUOS_ESPECIALES_OR_&VIGENCIA.;
SET ODBCLIB.AVALUOS_ESPECIALES;  /*TABLA AVALÚOS ESPECIALES 2019*/
AVALUO_ESP = 1;
IF VIGENCIA_RESOLUCION = &VIGENCIA.;
LLAVE = COMPRESS(CODIGO_BARRIO||CODIGO_MANZANA||CODIGO_PREDIO||CODIGO_CONSTRUCCION||CODIGO_RESTO);
DROP PUNTAJE_USO AREA_CONSTRUIDA;
RUN;

PROC SORT DATA = PRUEBA.AVALUOS_ESPECIALES_OR_&VIGENCIA. NODUPKEY OUT = PREDIO_ESP_&VIGENCIA.; BY LLAVE; RUN;


PROC SQL; CREATE TABLE AVES_VISTA0 AS	/*LIQUIDACION VALOR CONSTRUCCION PONDERADO AVES*/
		SELECT A.CODIGO_LOCALIDAD, A.NOMBRE_BARRIO, A.CODIGO_BARRIO, A.CODIGO_MANZANA,
A.CODIGO_PREDIO, A.CODIGO_CONSTRUCCION, A.CODIGO_RESTO , 
A.CODIGO_USO, A.UNIDAD_CALIFICADA, A.AREA_USO,
B.AVALUO_ESP /*VU_AREA=VALOR_UNITARIO_2019_AVES*AREA_USO*/
				FROM PRUEBA.VISTA_MODELO_UNID_LIQ AS A 
               INNER JOIN PREDIO_ESP_&VIGENCIA. AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO;
QUIT;



PROC SQL; CREATE TABLE AVES_VISTA1 AS	/*LIQUIDACION VALOR CONSTRUCCION PONDERADO AVES*/
		SELECT A.CODIGO_LOCALIDAD, A.NOMBRE_BARRIO, A.CODIGO_BARRIO, A.CODIGO_MANZANA,
A.CODIGO_PREDIO, A.CODIGO_CONSTRUCCION, A.CODIGO_RESTO , 
A.CODIGO_USO, A.UNIDAD_CALIFICADA, A.AREA_USO, A.AVALUO_ESP, 
B.MODELO_0, B.NOMBRE_MODELO_0, B.MODELO_USO, B.VALOR_UNITARIO_&VIGENCIA. /*VU_AREA=VALOR_UNITARIO_2019_AVES*AREA_USO*/
				FROM AVES_VISTA0 AS A LEFT JOIN PRUEBA.PREDIOS_VALORES_TABLAS_NPH AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO &
					A.CODIGO_USO = B.CODIGO_USO	&
					A.UNIDAD_CALIFICADA = B.UNIDAD_CALIFICADA;
QUIT;



PROC SQL; CREATE TABLE AVES_VISTA2 AS	/*LIQUIDACION VALOR CONSTRUCCION PONDERADO AVES*/
		SELECT A.*,  B.VALOR_M2_CONSTRUCCION AS VALOR_UNITARIO_UCAL_AVESP, B.ORIGEN /*VU_AREA=VALOR_UNITARIO_2019_AVES*AREA_USO*/
				FROM AVES_VISTA1 AS A LEFT JOIN  PRUEBA.AVALUOS_ESPECIALES_OR_&VIGENCIA. AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO &
					A.CODIGO_USO = B.CODIGO_USO	&
					A.UNIDAD_CALIFICADA = B.UNIDAD_CALIFICADA;
QUIT;


/* EN EL SIGUIENTE DATA SET, CREO QUE LA VARIABLE VALOR_UNITARIO_UC_AVES ESTÁ MAL FORMULADA */

DATA PRUEBA.AVES_VISTA; set AVES_VISTA2;
IF VALOR_UNITARIO_UCAL_AVESP = . THEN VALOR_UNITARIO_UC_AVES = VALOR_UNITARIO_&VIGENCIA.;
ELSE VALOR_UNITARIO_UC_AVES = VALOR_UNITARIO_UCAL_AVESP * AREA_USO; /* PARA MÍ, EN ESTA SENTENCIA SOBRA EL ÁREA DEL USO */
IF VALOR_UNITARIO_UCAL_AVESP = . THEN VU_AREA = VALOR_UNITARIO_&VIGENCIA. * AREA_USO;
ELSE VU_AREA = VALOR_UNITARIO_UCAL_AVESP * AREA_USO;
RUN;

PROC SQL; CREATE TABLE AVES_PRED_VCONST AS SELECT CODIGO_BARRIO, CODIGO_MANZANA,
CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
SUM(VU_AREA) AS VALOR_CONSTRUCCION_COM_&VIGENCIA.
FROM PRUEBA.AVES_VISTA
GROUP BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO;
QUIT;

PROC SQL;CREATE TABLE PRUEBA.AVES_VISTA2 AS SELECT A.*,
B.VALOR_CONSTRUCCION_COM_&VIGENCIA. AS VALOR_UNITARIO_AVESP_&VIGENCIA.
FROM PRUEBA.AVES_VISTA AS A LEFT JOIN AVES_PRED_VCONST AS B ON 
A.CODIGO_BARRIO = B.CODIGO_BARRIO &
A.CODIGO_MANZANA = B.CODIGO_MANZANA &
A.CODIGO_PREDIO = B.CODIGO_PREDIO &
A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
A.CODIGO_RESTO = B.CODIGO_RESTO
ORDER BY A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, A.CODIGO_CONSTRUCCION, A.CODIGO_RESTO;
QUIT;


DATA PRUEBA.AVALUOS_ESPECIALES_&VIGENCIA.;SET PRUEBA.AVES_VISTA2;  /*TABLA AVALÚOS ESPECIALES 2019*/
/*IF SUBSTR(CODIGO_BARRIO,1,1) EQ '0' ; /* AVALÚOS ESPECIALES SÓLO URBANOS */
LLAVE = COMPRESS(CODIGO_BARRIO||CODIGO_MANZANA||CODIGO_PREDIO||CODIGO_CONSTRUCCION||CODIGO_RESTO);
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO CODIGO_USO UNIDAD_CALIFICADA LLAVE CODIGO_RESTO VALOR_UNITARIO_UC_AVES VALOR_UNITARIO_AVESP_&VIGENCIA. AVALUO_ESP ORIGEN; 
RUN;

PROC SQL; CREATE TABLE BD_PREDIOS_VLORM2_TERCOR_AVES AS	/*LIQUIDACION VALOR CONSTRUCCION PONDERADO AVES*/
		SELECT A.*,  B.ORIGEN, B.VALOR_UNITARIO_UC_AVES /*VU_AREA=VALOR_UNITARIO_2019_AVES*AREA_USO*/
				FROM PRUEBA.PREDIO_VISTA_MODELOS AS A 
				LEFT JOIN  PRUEBA.AVALUOS_ESPECIALES_&VIGENCIA. AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO &
					A.CODIGO_USO = B.CODIGO_USO	&
					A.UNIDAD_CALIFICADA = B.UNIDAD_CALIFICADA;
QUIT;

PROC SORT DATA=PRUEBA.AVALUOS_ESPECIALES_&VIGENCIA. NODUPKEY;   /*Base  AVALUOS_ESPECIALES a nivel de predio*/
BY CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO;
QUIT;


PROC SQL; CREATE TABLE PRUEBA.BD_PREDIOS_VLORM2_TERCOR_AVES AS	/*LIQUIDACION VALOR CONSTRUCCION PONDERADO AVES*/
		SELECT A.*,  B.VALOR_UNITARIO_AVESP_&VIGENCIA., B.AVALUO_ESP /*VU_AREA=VALOR_UNITARIO_2019_AVES*AREA_USO*/
				FROM BD_PREDIOS_VLORM2_TERCOR_AVES AS A LEFT JOIN  PRUEBA.AVALUOS_ESPECIALES_&VIGENCIA. AS B
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO = B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION = B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO = B.CODIGO_RESTO 
					;
QUIT;

/******************/


/*****************************************************************************/
/*	EN ESTA LINEA SE EXCLUYEN LAS UNIDADES CORRESPONDIENTES A AVALÚOS ESPECIALES QUE NO SON LA UNIDAD DE LIQUIDACIÓN */
/*****************************************************************************/  

DATA BD_PREDIOS_VLORM2_TERCOR_AVES; SET PRUEBA.BD_PREDIOS_VLORM2_TERCOR_AVES;
IF MODELO_0 NOT IN ('USOS MULTIPLES') AND UNIDAD_LIQUIDACION=0 AND AVALUO_ESP=1 THEN DELETE; RUN;


/*****************************************************************************/
/*			FIN AVALUOS ESPECIALES											 */
/*****************************************************************************/  

/*****************************************************************************/  
/* CALCULO DEL AVALUO COMERCIAL  */
/*****************************************************************************/  
DATA PREDIO_TABLA_LIQ_1; SET BD_PREDIOS_VLORM2_TERCOR_AVES; /*LIQUIDACION VALOR_INTEGRAL T21, T22,T23 Y VALOR_AVALUO_COM_2020*/
VALOR_AVALUO_COM_&VIGENCIA. = VALOR_UNITARIO_&VIGENCIA. * AREA_CONSTRUIDA + VALOR_M2_TERRENO_COR_&VIGENCIA_2. * AREA_TERRENO;
IF MODELO_0 IN ('USOS MULTIPLES') AND AVALUO_ESP NE 1 THEN VALOR_AVALUO_COM_&VIGENCIA.=VALOR_CONSTRUCCION_COM_&VIGENCIA._UM + VALOR_M2_TERRENO_COR_&VIGENCIA_2. * AREA_TERRENO;

IF MODELO_0 IN ('USOS MULTIPLES') AND AVALUO_ESP = 1 THEN VALOR_AVALUO_COM_&VIGENCIA. = VALOR_UNITARIO_AVESP_&VIGENCIA. + VALOR_M2_TERRENO_COR_&VIGENCIA_2. * AREA_TERRENO;

IF (MODELO_0 IN ('T21','T22')) THEN VALOR_AVALUO_COM_&VIGENCIA. = PRODUCTO_&VIGENCIA.;
IF MODELO_0 IN ('M01_1', 'M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6', 'M03', 'M04','M05','M06_123', 'M06_456') THEN VALOR_AVALUO_COM_&VIGENCIA. = VALOR_INTEGRAL_&VIGENCIA. * AREA_CONSTRUIDA; 
IF MODELO_0 IN ('LOTES_PH','LOTES_NPH') THEN VALOR_AVALUO_COM_&VIGENCIA.=VALOR_M2_TERRENO_COR_&VIGENCIA_2. * AREA_TERRENO;
IF AVALUO_ESP = 1 THEN VALOR_AVALUO_COM_&VIGENCIA. = ((VALOR_UNITARIO_AVESP_&VIGENCIA.)+(VALOR_M2_TERRENO_COR_&VIGENCIA_2.*AREA_TERRENO));

IF MODELO_0 IN ('T23') THEN VALOR_INTEGRAL_&VIGENCIA. = VALOR_UNITARIO_&VIGENCIA.; 
IF (MODELO_0 IN ('T21','T22')) THEN VALOR_INTEGRAL_&VIGENCIA. = PRODUCTO_&VIGENCIA./AREA_CONSTRUIDA; 

RUN; 

/*****************************************************************************/  
/* CÁLCULO DE VALORES DE CONSTRUCCIÓN POR M2 DE ACUERDO AL MODELO  */
/*****************************************************************************/  
DATA PRUEBA.BD_PREDIOS_LIQUIDACIONT_TAB_UR; SET PREDIO_TABLA_LIQ_1; /*LIQUIDACION VALOR_M2_CONSTRUCCION_2020 Y VALOR_AVALUO_COM_2020*/
IF MODELO_0 IN ('USOS MULTIPLES') AND AVALUO_ESP NE 1 THEN VALOR_M2_CONSTRUCCION_&VIGENCIA. = VALOR_CONSTRUCCION_COM_&VIGENCIA._UM/AREA_CONSTRUIDA;
IF MODELO_0 IN ('USOS MULTIPLES') AND AVALUO_ESP = 1  THEN VALOR_M2_CONSTRUCCION_&VIGENCIA. = VALOR_UNITARIO_AVESP_&VIGENCIA./AREA_CONSTRUIDA;

IF MODELO_0 NOT IN ('USOS MULTIPLES') THEN VALOR_M2_CONSTRUCCION_&VIGENCIA. = VALOR_UNITARIO_&VIGENCIA.;/*LIQUIDACION USO A USO*/
IF MODELO_0 IN ('T21','T22') THEN VALOR_M2_CONSTRUCCION_&VIGENCIA. = (VALOR_AVALUO_COM_&VIGENCIA.-(AREA_TERRENO*VALOR_M2_TERRENO_COR_&VIGENCIA_2.))/AREA_CONSTRUIDA; 
IF MODELO_0 IN ('T23') THEN VALOR_AVALUO_COM_&VIGENCIA.=(VALOR_INTEGRAL_&VIGENCIA.*AREA_CONSTRUIDA);
IF MODELO_0 IN ('M01_1', 'M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6', 'M03', 'M04', 'M05', 'M06_123', 'M06_456', 'T23') 
THEN VALOR_M2_CONSTRUCCION_&VIGENCIA. = ((VALOR_INTEGRAL_&VIGENCIA. * AREA_CONSTRUIDA) - (AREA_TERRENO * VALOR_M2_TERRENO_COR_&VIGENCIA_2.))/AREA_CONSTRUIDA;

IF AVALUO_ESP = 1 THEN VALOR_M2_CONSTRUCCION_&VIGENCIA. = VALOR_UNITARIO_AVESP_&VIGENCIA./AREA_CONSTRUIDA; /*se descomentan cuando haya tabla */ 

VALOR_M2_CONSTRUCCION_&VIGENCIA._or = VALOR_M2_CONSTRUCCION_&VIGENCIA.;
VALOR_AVALUO_COM_&VIGENCIA._or = VALOR_AVALUO_COM_&VIGENCIA.;
MODELO_0_or = MODELO_0;
NOMBRE_MODELO_0_or = NOMBRE_MODELO_0;
MODELO_USO_or = MODELO_USO;
LIQUIDACION_or = LIQUIDACION;
RUN; 





DATA PRUEBA.BD_PREDIOS_LIQUID_TAB_MOD_AVES; SET PRUEBA.BD_PREDIOS_LIQUIDACIONT_TAB_UR; /*VALORES AVALUO ESPECIAL*/
IF AVALUO_ESP = 1 THEN LIQUIDACION='AVESP';
/*IF AVALUO_ESP = 1 and LIQUIDACION='MODEL' THEN MODELO_0 = 'AV_ESP_MOD' ;*/
IF AVALUO_ESP = 1 AND MODELO_0 NOT IN ('USOS MULTIPLES')  THEN MODELO_0 ='AVESP';
IF AVALUO_ESP = 1 AND MODELO_0 IN ('USOS MULTIPLES')  THEN MODELO_0 ='USOS MULTIPLES CON AVESP';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=4 THEN MODELO_0 = 'AV_ESP_USO';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=5 THEN MODELO_0 = 'PRED_CESP';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=6 THEN MODELO_0 = 'REVIS_CAT';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=7 THEN MODELO_0 = 'AV_COMER';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=8 THEN MODELO_0 = 'AV_ESP_MOD';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=9 THEN MODELO_0 = 'AV_ESP_TAB';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=10 THEN MODELO_0 = 'AV_ESP_TOP';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=11 THEN MODELO_0 = 'AV_ESP_BIC';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=12 THEN MODELO_0 = 'AV_RUR_PH';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=13 THEN MODELO_0 = 'AV_USO_MU';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=14 THEN MODELO_0 = 'AV_ESP_SEN';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=15 THEN MODELO_0 = 'AV_ESP_CC';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=16 THEN MODELO_0 = 'AV_ESP_IND';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=18 THEN MODELO_0 = 'AVAL_COMER';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=43 THEN MODELO_0 = 'AV_ESP_MUL';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=44 THEN MODELO_0 = 'AV_AUTO_CAT';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=63 THEN MODELO_0 = 'AV_PROC_MARC';
IF AVALUO_ESP = 1 and MODELO_0 NOT IN ('USOS MULTIPLES') AND ORIGEN=64 THEN MODELO_0 = 'AV 100';

IF AVALUO_ESP = 1 and ORIGEN=4 THEN MODELO_USO = 'AV_ESP_USO';
IF AVALUO_ESP = 1 and ORIGEN=5 THEN MODELO_USO = 'PRED_CESP';
IF AVALUO_ESP = 1 and ORIGEN=6 THEN MODELO_USO = 'REVIS_CAT';
IF AVALUO_ESP = 1 and ORIGEN=7 THEN MODELO_USO = 'AV_COMER';
IF AVALUO_ESP = 1 and ORIGEN=8 THEN MODELO_USO = 'AV_ESP_MOD';
IF AVALUO_ESP = 1 and ORIGEN=9 THEN MODELO_USO = 'AV_ESP_TAB';
IF AVALUO_ESP = 1 and ORIGEN=10 THEN MODELO_USO = 'AV_ESP_TOP';
IF AVALUO_ESP = 1 and ORIGEN=11 THEN MODELO_USO = 'AV_ESP_BIC';
IF AVALUO_ESP = 1 and ORIGEN=12 THEN MODELO_USO = 'AV_RUR_PH';
IF AVALUO_ESP = 1 and ORIGEN=13 THEN MODELO_USO = 'AV_USO_MU';
IF AVALUO_ESP = 1 and ORIGEN=14 THEN MODELO_USO = 'AV_ESP_SEN';
IF AVALUO_ESP = 1 and ORIGEN=15 THEN MODELO_USO = 'AV_ESP_CC';
IF AVALUO_ESP = 1 and ORIGEN=16 THEN MODELO_USO = 'AV_ESP_IND';
IF AVALUO_ESP = 1 and ORIGEN=18 THEN MODELO_USO = 'AVAL_COMER';
IF AVALUO_ESP = 1 and ORIGEN=43 THEN MODELO_USO = 'AV_ESP_MUL';
IF AVALUO_ESP = 1 and ORIGEN=44 THEN MODELO_USO = 'AV_AUTO_CAT';
IF AVALUO_ESP = 1 and ORIGEN=63 THEN MODELO_USO = 'AV_PROC_MARC';
IF AVALUO_ESP = 1 and ORIGEN=64 THEN MODELO_USO = 'AV 100';

IF AVALUO_ESP = 1  AND MODELO_0 IN ('USOS MULTIPLES') THEN NOMBRE_MODELO_0 = 'USOS MULTIPLES CON AVESP';
IF AVALUO_ESP = 1  AND MODELO_0 NOT IN ('USOS MULTIPLES') THEN NOMBRE_MODELO_0 = 'AVESP';
IF AVALUO_ESP = 1 and ORIGEN=4 THEN NOMBRE_MODELO_0 = 'AV_ESP_USO - PREDIOS CON USO SIN TABLA NI MODELO';
IF AVALUO_ESP = 1 and ORIGEN=5 THEN NOMBRE_MODELO_0 = 'PRED_CESP - PREDIOS CON CARACTERISTICAS ESPECIALES';
IF AVALUO_ESP = 1 and ORIGEN=6 THEN NOMBRE_MODELO_0 = 'REVIS_CAT - AVALUOS CON MARCAS ECONOMICAS';
IF AVALUO_ESP = 1 and ORIGEN=7 THEN NOMBRE_MODELO_0 = 'AV_COMER - PREDIOS CON AVALUOS COMERCIALES';
IF AVALUO_ESP = 1 and ORIGEN=8 THEN NOMBRE_MODELO_0 = 'AV_ESP_MOD - AVALUOS CON USO DE MODELO NO SE AJUSTA';
IF AVALUO_ESP = 1 and ORIGEN=9 THEN NOMBRE_MODELO_0 = 'AV_ESP_TAB - AVALUOS CON TABLA VALOR NO SE AJUSTA';
IF AVALUO_ESP = 1 and ORIGEN=10 THEN NOMBRE_MODELO_0 = 'AV_ESP_TOP - AVALUOS CON AREA QUE SUPERA EL TOPE';
IF AVALUO_ESP = 1 and ORIGEN=11 THEN NOMBRE_MODELO_0 = 'AV_ESP_BIC - AVALUOS DE PREDIOS DE INTERES CULTURAL';
IF AVALUO_ESP = 1 and ORIGEN=12 THEN NOMBRE_MODELO_0 = 'AV_RUR_PH - AVALUOS RURALES EN PH';
IF AVALUO_ESP = 1 and ORIGEN=13 THEN NOMBRE_MODELO_0 = 'AV_USO_MU - AVALUOS DE USOS MULTIPLES';
IF AVALUO_ESP = 1 and ORIGEN=14 THEN NOMBRE_MODELO_0 = 'AV_ESP_SEN - AVALUOS PRESENTADOS EN EL PROCESO DE SENSIBILIDAD';
IF AVALUO_ESP = 1 and ORIGEN=15 THEN NOMBRE_MODELO_0 = 'AV_ESP_CC - AVALUOS DE CENTROS COMERCIALES';
IF AVALUO_ESP = 1 and ORIGEN=16 THEN NOMBRE_MODELO_0 = 'AV_ESP_IND - AVALUOS POR INCREMENTO INDICE LOCAL POR USO';
IF AVALUO_ESP = 1 and ORIGEN=18 THEN NOMBRE_MODELO_0 = 'AVAL_COMER - PREDIOS CON AVALUOS COMERCIALES PUNTUALES';
IF AVALUO_ESP = 1 and ORIGEN=43 THEN NOMBRE_MODELO_0 = 'AV_ESP_MUL - PREDIOS USO DE TABLA Y MODELO';
IF AVALUO_ESP = 1 and ORIGEN=44 THEN NOMBRE_MODELO_0 = 'AV_AUTO_CAT - PREDIO CON AUTO-AVALUO ACEPTADO';
IF AVALUO_ESP = 1 and ORIGEN=63 THEN NOMBRE_MODELO_0 = 'AV_PROC_MARC - AVALUOS ESPECIAL GENERADO POR EL PROCESO DE MARCAS';
IF AVALUO_ESP = 1 and ORIGEN=64 THEN NOMBRE_MODELO_0 = 'AV 100 - USOS CON MAS DE 100 AÑOS DE VETUSTEZ';

RUN;


PROC SQL;	CREATE TABLE PREDIO_Y_UM_FINAL_&FECHA_CORTE.  AS
		SELECT A.*,  B.AVALUO_TOTAL_PUNTUAL_COM_&VIGENCIA_ANT. AS VALOR_AVALUO_COM_&VIGENCIA_ANT., 
                    B.VALOR_M2_CONS_COM_&VIGENCIA_ANT. AS VALOR_M2_CONSTRUCCION_&VIGENCIA_ANT.,
             	((A.VALOR_AVALUO_COM_&VIGENCIA.-B.AVALUO_TOTAL_PUNTUAL_COM_&VIGENCIA_ANT.)/B.AVALUO_TOTAL_PUNTUAL_COM_&VIGENCIA_ANT.) AS VAR_AVALUO_COM_&VIGENCIA_ANT._&VIGENCIA.,
				((A.VALOR_M2_CONSTRUCCION_&VIGENCIA.-B.VALOR_M2_CONS_COM_&VIGENCIA_ANT.)/B.VALOR_M2_CONS_COM_&VIGENCIA_ANT.) AS VAR_M2_CONS_COM_&VIGENCIA_ANT._&VIGENCIA.
				FROM PRUEBA.BD_PREDIOS_LIQUID_TAB_MOD_AVES AS A LEFT JOIN COMUN.PREDIO_FINAL_&VIGENCIA_ANT. AS B  
				ON	A.CODIGO_BARRIO = B.CODIGO_BARRIO &
					A.CODIGO_MANZANA = B.CODIGO_MANZANA &
					A.CODIGO_PREDIO=B.CODIGO_PREDIO &
					A.CODIGO_CONSTRUCCION=B.CODIGO_CONSTRUCCION &
					A.CODIGO_RESTO=B.CODIGO_RESTO
			ORDER BY A.CODIGO_BARRIO, A.CODIGO_MANZANA, A.CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO,
			CODIGO_USO, UNIDAD_CALIFICADA;
QUIT;

/*****************************************************************************/
/*			CALCULO VALORES CATASTRALES										 */
/*****************************************************************************/
DATA PREDIO_COMERCIAL;SET PREDIO_Y_UM_FINAL_&FECHA_CORTE.;
IF (AREA_CONSTRUIDA=.) THEN AREA_CONSTRUIDA = 0;
IF (AREA_CONSTRUIDA=. OR AREA_CONSTRUIDA=0)  THEN VALOR_M2_CONSTRUCCION_&VIGENCIA. = 0;
ELSE VALOR_M2_CONSTRUCCION_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.;
IF VALOR_M2_CONSTRUCCION_&VIGENCIA. = . THEN VALOR_M2_CONSTRUCCION_&VIGENCIA. = 0;
RUN;

 
/*LIQUIDACIÓN AVALÚO CATASTRAL */

DATA PRUEBA.PREDIO_COMERCIAL_A; /*CALCULO VALORES CATASTRALES	*/
SET PREDIO_COMERCIAL;

/*Aplicación de CONFIS 2020*/
/*Aplicación General, cubre los casos no específicos*/

VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_COR_&VIGENCIA_2.*0.85;
VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.*0.75; 
 
/* Lotes */
IF AREA_CONSTRUIDA=0 OR (CODIGO_USOP in ('090')) THEN DO;
     VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_COR_&VIGENCIA_2.*0.90;
     VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.*0.90;
END;
 
/* Residencial, Parqueaderos y Bodegas*/
ELSE DO;
     IF CODIGO_DESTINO='01' THEN DO; 
          IF 0<CODIGO_ESTRATO<3  THEN DO;
           VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_COR_&VIGENCIA_2.*0.65;
           VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.*0.60;
        END;
          IF codigo_estrato=3 THEN DO;
           VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_COR_&VIGENCIA_2.*0.68;
           VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.*0.60;
        END;
          if codigo_estrato=4 THEN DO;
           VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_COR_&VIGENCIA_2.*0.84;
           VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.*0.64;
        END;
          IF 4<codigo_estrato<=6 THEN DO;
           VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_COR_&VIGENCIA_2.*0.85;
           VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.*0.74;
        END;
     END;
     IF CODIGO_DESTINO='24' OR (CODIGO_USOP IN ('025','033')) THEN DO;
           VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_COR_&VIGENCIA_2.*0.90;
           VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.*0.90;
     END;
END;
/*rurales*/
IF ID_UR_RU IN ('1','2') THEN DO; 
           VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_COR_&VIGENCIA_2.*0.70;
           VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_&VIGENCIA.*0.60;
END;

VALOR_AVALUO_CAT = AREA_TERRENO*VALOR_M2_TERRENO_CAT_&VIGENCIA. + AREA_CONSTRUIDA*VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA.;

RUN;


DATA COMUN.PREDIO_Y_UM_FINAL_&FECHA_CORTE.;  SET PRUEBA.PREDIO_COMERCIAL_A;
IF ID_UR_RU IN ('1','2') AND ACTUALIZADO NOT = 1 THEN VALOR_M2_TERRENO_CAT_&VIGENCIA. = (VALOR_M2_TERRENO*0.977); ELSE VALOR_M2_TERRENO_CAT_&VIGENCIA. = VALOR_M2_TERRENO_CAT_&VIGENCIA.;
IF ID_UR_RU IN ('1','2') AND ACTUALIZADO NOT = 1 THEN VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = (VALOR_M2_CONSTRUCCION*0.977); ELSE VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA. = VALOR_M2_CONSTRUCCION_CAT_&VIGENCIA.;
IF ID_UR_RU IN ('1','2') AND ACTUALIZADO NOT = 1 THEN VALOR_AVALUO_CAT = (AREA_TERRENO * (VALOR_M2_TERRENO*0.977) + AREA_CONSTRUIDA * (VALOR_M2_CONSTRUCCION * 0.977)); ELSE VALOR_AVALUO_CAT=VALOR_AVALUO_CAT;
RUN;

data _null_;
  dur = datetime() - &_timer_start;
  put 30*'-' / ' TOTAL DURATION:' dur time13.2 / 30*'-';
run;


/*
DATA BASE_FOCA_MODELACION;
SET COMUN.PREDIO_Y_UM_FINAL_&FECHA_CORTE.;
IF FOCA_MODELACION = 1 AND F_EXPANSION NE . AND
MODELO_0 IN ("M01_1", "M01_2", "M01_3", "M02_4", "M02_5", "M02_6", "M03", "M04", "M05", "M06_123", "M06_456") AND 
UNIDAD_LIQUIDACION = 1;
RUN;
*/
