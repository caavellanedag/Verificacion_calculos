/*---------------------------------------------------------------------------------------------

COMPARACION SISTEMAS

---------------------------------------------------------------------------------------------**/

%let _timer_start = %sysfunc(datetime());
%LET RUTA = \\prowin04\cavellaneda\EJERCICIOS\EJERCICIOS 2021\VERIFICACION_CALCULOS;
LIBNAME PRUEBA "\\prowin04\cavellaneda\EJERCICIOS\EJERCICIOS 2021\VERIFICACION_CALCULOS";


%LET FECHA_CORTE = 210901;
%LET VIGENCIA = 2022;
%LET VIGENCIA_2 = 22;
%LET YEAR = &VIGENCIA. - 1;
%LET VIGENCIA_ANT = %sysevalf(&VIGENCIA.-1);
%LET VIGENCIA_ANT_2 = %sysevalf(&VIGENCIA_2.-1);
%LET VIGENCIA_ANT_ANT = %sysevalf(&VIGENCIA.-2);
%LET VIGENCIA_ANT_ANT_2 = %sysevalf(&VIGENCIA_2.-2);

DATA PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI; /*SET COMUN.PREDIO_Y_UM_FINAL_&FECHA_CORTE.;*/
 SET COMUN.PREDIO_Y_UM_FINAL_&FECHA_CORTE.; /*PRUEBA.PREDIO_VISTA_2020_MODELOS;*/
IF ACTUALIZADO=1; 
IF CODIGO_USO=' ' THEN CODIGO_USO='000'; ELSE CODIGO_USO=CODIGO_USO;
RUN; 

/******************************************
PREDIOS SIN VALOR MODELO O TABLA
*******************************************/

/*PROC SQL;    CREATE TABLE FILTRO_SIN_VI_MODEL AS 
   SELECT *
   FROM PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI
WHERE (VALOR_INTEGRAL_2020 = . AND LIQUIDACION = 'MODEL');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_SIN_VALOR_TABLA AS 
   SELECT *
   FROM PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI
WHERE (VALOR_UNITARIO_2020 = . AND LIQUIDACION = 'TABLA' & MODELO_USO NOT IN ('T21','T22'));
QUIT;

PROC SQL;    CREATE TABLE FILTRO_SIN_VALOR_TABLAPARQ AS 
   SELECT *
   FROM PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI
WHERE (PRODUCTO_&VIGENCIA. = . AND LIQUIDACION = 'TABLA' & MODELO_USO  IN ('T21','T22'));
QUIT;
													/*FIN*/


DATA PRUEBA.COMPARA_MODSISTEMAS; SET ODBCLIB.VALORES_CONSTRUCCION; /*TABLA VALORES CONSTRUCCION SISTEMAS*/
IF VIGENCIA = 2020;
IF MODELO_APLICADO IN ('000',' ') THEN DELETE;
RUN;


DATA PRUEBA.COMPARA_MODSISTEMAS_UR;
SET PRUEBA.COMPARA_MODSISTEMAS;
IF SUBSTR(CODIGO_BARRIO,1,1) = '0';
LLAVE = COMPRESS(CODIGO_BARRIO || CODIGO_MANZANA || CODIGO_PREDIO || CODIGO_CONSTRUCCION || CODIGO_RESTO);
AREA_USO = ROUND(AREA_USO,.01);
VETUSTEZ_SIS = VETUSTEZ;
IF (2020 - VETUSTEZ = 0) THEN EDAD_SIS = 1; ELSE EDAD_SIS = (2020-VETUSTEZ);
PUNTAJE_SIS = PUNTAJE;
ESTRATO_SIS = ESTRATO;
VLR_M2_CONSTRUCCION_SIS = VLR_M2_CONSTRUCCION;
FASE_SIS = FASE;
CODIGO_DESTINO_SIS = CODIGO_DESTINO;
VALOR_INTEGRAL_SIS = VALOR_INTEGRAL;
IF MODELO_APLICADO='AVAES' THEN MODELO_APLICADO_SIS='AVESP     '; ELSE MODELO_APLICADO_SIS=PUT(MODELO_APLICADO, $10.); 
KEEP CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO CLASE_CONSTRUCCION UNIDAD_CALIFICADA CODIGO_USO AREA_USO LLAVE
VETUSTEZ EDAD_SIS PUNTAJE_SIS CODIGO_DESTINO_SIS ESTRATO_SIS VLR_M2_CONSTRUCCION_SIS VALOR_INTEGRAL_SIS FASE_SIS MODELO_APLICADO_SIS;
RUN;


/*INTERSECCION A NIVEL UNIDAD*/
proc sort data=PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI;
by  CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO CODIGO_USO UNIDAD_CALIFICADA AREA_USO CLASE_CONSTRUCCION ;RUN;
proc sort data=PRUEBA.COMPARA_MODSISTEMAS_UR;
by  CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO CODIGO_USO UNIDAD_CALIFICADA AREA_USO CLASE_CONSTRUCCION ;RUN;

DATA INTER_SISTEMAS_ESTADISTICA_0; /*BASE A COMPARAR PREDIOS MAS USO MULTIPLE*/
merge PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI (in=en_uno) PRUEBA.COMPARA_MODSISTEMAS_UR (in=en_dos);
by CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO CODIGO_USO UNIDAD_CALIFICADA AREA_USO CLASE_CONSTRUCCION
;if en_dos and en_uno; RUN;


/*LO QUE ESTA EN SISTEMAS Y NO EN ESTADISTICA o viceversa*/

/*DATA SIST_COMPLEMENTO; /*LO QUE ESTA EN ESTADISTICA y no en SISTEMAS == DEBERIAN SER LOTES*/
/*merge PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI (in=en_uno) PRUEBA.COMPARA_MODSISTEMAS_UR (in=en_dos);
by CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO CODIGO_USO UNIDAD_CALIFICADA AREA_USO CLASE_CONSTRUCCION
;if en_uno and not en_dos; RUN;

DATA EST_COMPLEMENTO; 
merge PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI (in=en_uno) PRUEBA.COMPARA_MODSISTEMAS_UR (in=en_dos);
by CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO CODIGO_USO UNIDAD_CALIFICADA AREA_USO CLASE_CONSTRUCCION
;if en_dos and not en_uno; RUN;*/

/*DATA PROVISIONAL; SET INTER_SISTEMAS_ESTADISTICA_0;
IF MODELO_0 IN ('T23') THEN VALOR_INTEGRAL_2020=VALOR_UNITARIO_2020; 
IF (MODELO_0 IN ('T21','T22')) THEN VALOR_INTEGRAL_2020 = PRODUCTO_&VIGENCIA./AREA_CONSTRUIDA;
RUN;*/

DATA PRUEBA.MODELOSIS_VACIOS; SET /*PROVISIONAL*/INTER_SISTEMAS_ESTADISTICA_0;
IF MODELO_APLICADO_SIS = MODELO_USO THEN COMPARA_MODELO = "CORRECTO"; 
IF MODELO_APLICADO_SIS NE MODELO_USO THEN COMPARA_MODELO = "INCORREC"; 
IF FASE_SIS = UNIDAD_LIQUIDACION THEN COMPARA_FASE = "CORRECTO"; 
IF FASE_SIS NE UNIDAD_LIQUIDACION THEN COMPARA_FASE = "INCORREC"; 
IF SUBSTR(CODIGO_BARRIO,1,1) = '0' THEN URBANO_RURAL = 'URBANO'; ELSE URBANO_RURAL = 'RURAL';

IF ABS(VALOR_UNITARIO_2020 - VLR_M2_CONSTRUCCION_SIS) <= 1 THEN COMPARA_VLRCONS_M2 = "CORRECTO";  /*tabla: valor m2 y T23 */
IF ABS(VALOR_UNITARIO_2020 - VLR_M2_CONSTRUCCION_SIS) > 1 THEN COMPARA_VLRCONS_M2 = "INCORREC";

IF ABS(VALOR_M2_CONSTRUCCION_2020 - VLR_M2_CONSTRUCCION_SIS) <= 5000 THEN COMPARA_AVALUOCOM = "CORRECTO";  /*(1)tabla: t21 y t22 parquederos */
IF ABS(VALOR_M2_CONSTRUCCION_2020 - VLR_M2_CONSTRUCCION_SIS) > 5000 THEN COMPARA_AVALUOCOM = "INCORREC"; 

IF ABS(VALOR_INTEGRAL_2020 - VALOR_INTEGRAL_SIS) <= 5000 THEN COMPARA_VAL_INT = "CORRECTO"; /*T23 DEPOSITOS Y MODELOS*/
IF ABS(VALOR_INTEGRAL_2020 - VALOR_INTEGRAL_SIS) > 5000 THEN COMPARA_VAL_INT = "INCORREC";

IF ABS(VALOR_M2_CONSTRUCCION_2020 - VLR_M2_CONSTRUCCION_SIS) <= 1 THEN COMPARA_VLRCONS = "CORRECTO";  /*valor m2 *area construcción*/ 
IF ABS(VALOR_M2_CONSTRUCCION_2020 - VLR_M2_CONSTRUCCION_SIS) > 1 THEN COMPARA_VLRCONS = "INCORREC";

IF MODELO_USO = 	'AV_ESP_BIC'	AND 	MODELO_APLICADO_SIS =	'AVBIC'  THEN COMPARA_MODELO = "CORRECTO";
IF MODELO_USO = 	'AV_ESP_CC'	    AND 	MODELO_APLICADO_SIS =	'AVECC'  THEN COMPARA_MODELO = "CORRECTO";
IF MODELO_USO = 	'AV_ESP_USO'	AND 	MODELO_APLICADO_SIS =	'AVUSO'  THEN COMPARA_MODELO = "CORRECTO";
IF MODELO_USO = 	'LOTES_NPH'	    AND 	MODELO_APLICADO_SIS =	'LTNPH'  THEN COMPARA_MODELO = "CORRECTO";
IF MODELO_USO = 	'LOTES_PH'	    AND 	MODELO_APLICADO_SIS =	'LTPH'   THEN COMPARA_MODELO = "CORRECTO";
IF MODELO_USO = 	'M06_123'	    AND 	MODELO_APLICADO_SIS =	'M06_1'  THEN COMPARA_MODELO = "CORRECTO";
IF MODELO_USO = 	'M06_456'	    AND 	MODELO_APLICADO_SIS =	'M06_4'  THEN COMPARA_MODELO = "CORRECTO";

RUN;




/***************************
1. DIFERENCIAS VARIABLE MODELO
****************************/

PROC SQL; CREATE TABLE INCORRECTO_MODELO AS SELECT  /*DIFERENCIAS VARIABLE MODELO*/
CODIGO_LOCALIDAD,	NOMBRE_BARRIO,	CODIGO_BARRIO,	CODIGO_MANZANA,	CODIGO_PREDIO,	CODIGO_CONSTRUCCION,	CODIGO_RESTO, UNIDAD_CALIFICADA, CLASE_CONSTRUCCION, LLAVE,	
CODIGO_DESTINO,	CLASE_PREDIO,	CODIGO_ESTRATO,	CONSERVACION_HISTORICA,		EDAD,	PUNTAJE,		
/*MARCA_MANZANA,*/		NUMERO_UNIDADES,	NUM_USOS,	ARMAZON_ESTRUCTURA,	MUROS_ESTRUCTURA, AREA_TERRENO,	AREA_CONSTRUIDA,	AREA_USO,	
CODIGO_USO,	CODIGO_USOP,  PREDIO_UNIDCAL_COMPL, /*UM_MODELO_PH, UM_MODELO_AVES, */MARCA_MANZANA, NOMBRE_MODELO_0,	MODELO_USO,	MODELO_APLICADO_SIS, FASE_SIS,	UNIDAD_LIQUIDACION AS FASE_EST,	
COMPARA_MODELO/*,	COMPARA_FASE*/  
FROM PRUEBA.MODELOSIS_VACIOS
WHERE COMPARA_MODELO='INCORREC'; QUIT;



PROC EXPORT DATA= INCORRECTO_MODELO
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2019\EXPORT\BD_DIFERENCIAS_VARIABLE_MODELO.xlsx" 
			dbms=xlsx replace;
			sheet="Diferencia Variable Modelo";
			RUN;



/***************************
4. DIFERENCIAS TABLAS NPH 
****************************/

PROC SQL; CREATE TABLE INCORRECTO_VR_TABL_NPH AS SELECT  /*DIFERENCIAS VALORS TABLAS NPH*/
CODIGO_LOCALIDAD,	NOMBRE_BARRIO,	CODIGO_BARRIO,	CODIGO_MANZANA,	CODIGO_PREDIO,	CODIGO_CONSTRUCCION,	CODIGO_RESTO, UNIDAD_CALIFICADA, CLASE_CONSTRUCCION, LLAVE,	
ARMAZON_ESTRUCTURA,	MUROS_ESTRUCTURA, LIQUIDACION,	NOMBRE_MODELO_0,	 /*AVALUO_ESP,*/	 FASE_SIS,	UNIDAD_LIQUIDACION as FASE_EST, CODIGO_DESTINO, CODIGO_DESTINO_SIS,	CLASE_PREDIO, 
CONSERVACION_HISTORICA, NUMERO_UNIDADES,	NUM_USOS, CODIGO_USO,	CODIGO_USOP, EC_MO_ID, MODELO_USO AS MODELO_APLICADO_EST,	MODELO_APLICADO_SIS,	CODIGO_ESTRATO, ESTRATO_SIS,	EDAD, EDAD_SIS,	PUNTAJE, PUNTAJE_SIS,		
MARCA_MANZANA,	 AREA_TERRENO,	AREA_CONSTRUIDA,	AREA_USO,	
VLR_M2_CONSTRUCCION_SIS, VALOR_M2_CONSTRUCCION_2020, VALOR_UNITARIO_2020, NOMBRE_MODELO_0, 
/*VALOR_CONSTRUCCION_COM_2020_UM, VALOR_AVALUO_COM_2020, */
COMPARA_MODELO, COMPARA_VLRCONS_M2
FROM PRUEBA.MODELOSIS_VACIOS
WHERE COMPARA_VLRCONS_M2='INCORREC'& LIQUIDACION IN ('TABLA') & MODELO_USO NOT IN ('T21','T22','T23'); QUIT;

PROC SQL; CREATE TABLE INCORRECTO_AVES AS SELECT
CODIGO_LOCALIDAD,	NOMBRE_BARRIO,	CODIGO_BARRIO,	CODIGO_MANZANA,	CODIGO_PREDIO,	CODIGO_CONSTRUCCION,	CODIGO_RESTO, UNIDAD_CALIFICADA, LLAVE,
FASE_SIS,	UNIDAD_LIQUIDACION as FASE_EST,
NUMERO_UNIDADES,	NUM_USOS, CODIGO_USO,	CODIGO_USOP,  LIQUIDACION, ORIGEN, NOMBRE_MODELO_0, MODELO_USO AS MODELO_APLICADO_EST,	MODELO_APLICADO_SIS,
VLR_M2_CONSTRUCCION_SIS, VALOR_M2_CONSTRUCCION_2020, VALOR_UNITARIO_UC_AVES, 
COMPARA_MODELO, COMPARA_VLRCONS
FROM PRUEBA.MODELOSIS_VACIOS
WHERE COMPARA_VLRCONS='INCORREC'& LIQUIDACION IN ('AVESP')
ORDER BY CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO
; QUIT;


PROC EXPORT DATA= INCORRECTO_VR_TABL_NPH
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFERENCIAS TABLAS DE VALOR\BD_DIFERENCIAS_TABLA_NPH.xlsx" 
			dbms=xlsx replace;
			sheet="Diferencia Valor tabla NPH";
			RUN;

PROC EXPORT DATA= INCORRECTO_AVES
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFERENCIAS TABLAS DE VALOR\BD_DIFERENCIAS_AVESP.xlsx" 
			dbms=xlsx replace;
			sheet="Diferencia AVESP";
			RUN;


PROC SQL; CREATE TABLE INCORRECTO_T21T22_PARQ_VI AS SELECT /*DIFERENCIAS VALOR INTEGRAL PH T21 Y T22*/
CHIP, CODIGO_LOCALIDAD,	NOMBRE_BARRIO,	CODIGO_BARRIO,	CODIGO_MANZANA,	CODIGO_PREDIO,	CODIGO_CONSTRUCCION,	CODIGO_RESTO, UNIDAD_CALIFICADA, CLASE_CONSTRUCCION, CLASE_PREDIO, LLAVE,	
CODIGO_DESTINO, CODIGO_DESTINO_SIS,			AREA_USO,	CODIGO_USO, NUM_USOS, NUMERO_UNIDADES,	CODIGO_USOP, ZHF_2020,	NOMBRE_MODELO_0,	MODELO_USO AS MODELO_APLICADO_EST,	MODELO_APLICADO_SIS, 	
FASE_SIS,	UNIDAD_LIQUIDACION  as FASE_EST,	CODIGO_ESTRATO, ESTRATO_SIS,	AREA_CONSTRUIDA, VLR_M2_CONSTRUCCION_SIS, PRODUCTO_&VIGENCIA., /*VALOR_AVALUO_COM_2019,*/ VALOR_INTEGRAL_2020, VALOR_INTEGRAL_SIS, 
COMPARA_VAL_INT
FROM PRUEBA.MODELOSIS_VACIOS
WHERE COMPARA_VAL_INT='INCORREC' & MODELO_USO IN ('T21','T22') ; QUIT;


PROC EXPORT DATA= INCORRECTO_T21T22_PARQ_VI
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFERENCIAS TABLAS DE VALOR\BD_DIFERENCIAS_T21T22_PARQ_PH.xlsx" 
			dbms=xlsx replace;
			sheet="Diferencia Valor Int";
			RUN;



PROC SQL; CREATE TABLE INCORRECTO_T21T22_PARQ_VI2 AS SELECT /*DIFERENCIAS VALOR INTEGRAL PH T21 Y T22*/
CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0, 	
AREA_USO,	CODIGO_ESTRATO, AREA_CONSTRUIDA,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2019*/
FROM PRUEBA.MODELOSIS_VACIOS
WHERE COMPARA_VAL_INT='INCORREC' & MODELO_USO IN ('T21','T22') ; QUIT;

proc export data=INCORRECTO_T21T22_PARQ_VI2   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFERENCIAS TABLAS DE VALOR\DIF_T21T22_PARQ_VI.txt'   dbms=dlm  replace;  delimiter='|';  RUN;

/*****************************************************************************

			7. DIFERENCIAS VALOR INTEGRAL - MODELOS Y T23 

*********************************************************************************/


/*T23 Depósito (Lockers) PH*/

PROC SQL; CREATE TABLE INCORRECTO_VI_DEPOSITOS AS SELECT
CODIGO_LOCALIDAD,	NOMBRE_BARRIO,	CODIGO_BARRIO,	CODIGO_MANZANA,	CODIGO_PREDIO,	CODIGO_CONSTRUCCION,	CODIGO_RESTO, LLAVE, CODIGO_USO,	CODIGO_USOP,	
NOMBRE_MODELO_0,	MODELO_USO AS MODELO_APLICADO_EST, MODELO_APLICADO_SIS,	 FASE_SIS, UNIDAD_LIQUIDACION as FASE_EST,  CODIGO_ESTRATO, ESTRATO_SIS, AREA_CONSTRUIDA,
VLR_M2_CONSTRUCCION_SIS,  VALOR_UNITARIO_2020, /*VALOR_M2_CONSTRUCCION_2020, VALOR_AVALUO_COM_2019,*/ 
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020, COMPARA_VAL_INT
FROM PRUEBA.MODELOSIS_VACIOS
WHERE COMPARA_VAL_INT='INCORREC'& MODELO_USO IN ('T23'); QUIT;

PROC SQL; CREATE TABLE INCORRECTO_VI_DEPOSITOS2 AS SELECT /*DIFERENCIAS VALOR INTEGRAL PH T21 Y T22*/
CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0, 	
AREA_USO,	CODIGO_ESTRATO, AREA_CONSTRUIDA,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2019*/
FROM PRUEBA.MODELOSIS_VACIOS
WHERE COMPARA_VAL_INT='INCORREC' & MODELO_USO IN ('T23') ; QUIT;

proc export data=INCORRECTO_VI_DEPOSITOS2   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFERENCIAS TABLAS DE VALOR\DIF_T23_DEPOSITOSPH_VI.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


PROC EXPORT DATA= INCORRECTO_VI_DEPOSITOS
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2019\EXPORT\BD_DIFERENCIAS_T23_DEPOS_PH.xlsx" 
			dbms=xlsx replace;
			sheet="Diferencia Valor Int";
			RUN;

/******************************************
7. DIFERENCIAS VALOR INTEGRAL - MODELOS
*******************************************/


PROC SQL; CREATE TABLE PRUEBA.INCORRECTO_VI_MODEL AS SELECT *
FROM PRUEBA.MODELOSIS_VACIOS
WHERE COMPARA_VAL_INT='INCORREC'& LIQUIDACION IN ('MODEL'); QUIT;



PROC SQL;    CREATE TABLE FILTRO_M01_1 AS /*M01_1 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0, 
PUNTAJE,
EDAD,
AREA_CONSTRUIDA,
USO_038,
COL_PUB,
COL_PRIV,
PKZONAL,
EST02,
EST03,
RELACION_AREA,
SAN_CRISTOBAL,
USME,
BOSA,
C_BOLIVAR,
P_ARANDA,
ZHF_1213_12,
ZHF_1213_13,
AREA_ACT2,
ZMPA_50_100,
URI_UPJ,
GA3,
ZHF_4_TRAT_DESARR,
NUMERO_UNIDADES_RES_BMP,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M01_1');
QUIT;

 
proc export data=FILTRO_M01_1   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M01_1.txt'   dbms=dlm  replace;  delimiter='|';  RUN;



PROC SQL;    CREATE TABLE FILTRO_M01_2 AS /*M01_2 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
AREA_CONSTRUIDA,
EDAD,
DUMMY_CRUCBER,
DUMMY_CONCORDIA,
DUMMY_TINTAL,
DUMMY_EGIPTOAGUAS,
COORDENADA_X,
COORDENADA_Y,
COL_PRIV,
PKBOLSIL,
URI_UPJ,
ZMPA_M_100,
CENTCOMERC_100_200,
CENTCOMERC_200_500,
IN_MIL_POL,
PKZONAL,
ESTACTM_200_500,
EST03,
TUNJUELITO,
BOSA,
KENNEDY,
MARTIRES,
Tip4,
GA3,
GB1,
GB2,
ZHF_4_TRAT_CONSERV,
ZHF_4_TRAT_MEJ,
ZHF_10_EST_VIA_REG,
ZHF_11_INF_VIA_LOCAL,
ZHF_1213_13,
ZHF_1213_17,
ZHF_1213_32,
SUBA,
C_BOLIVAR,
SANTAFE,
SAN_CRISTOBAL,
USME,
FONTIBON,
ENGATIVA,
CANDELARIA,
RAFAEL_U_U,
PUNTAJE,
NUMERO_UNIDADES_BMP,
DUMMY_SUB_2020_M01_2,
DUMMY_SOB_2020_M01_2,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M01_2');
QUIT;


PROC SQL;    CREATE TABLE FILTRO_M01_2_DUMMY AS /*M01_2 - DIFERENCIAS VARIABLES DUMMIES*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
CODIGO_BARRIO, 
AREA_CONSTRUIDA, 
PUNTAJE, 
AREA_TERRENO,
DENSIDAD,
EDAD
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M01_2');
QUIT;


DATA FILTRO_M01_2_DUMMY; SET FILTRO_M01_2_DUMMY; 

/*M01.2. Residencial PH, estrato 2*/

DUMMY_SOB_2020_M01_2=0;
DUMMY_SUB_2020_M01_2=0;
IF ( CODIGO_BARRIO IN('001429','002455','002579','004627','009252') AND AREA_CONSTRUIDA < 46.520 AND PUNTAJE < 44 AND AREA_TERRENO >= 25.855 AND AREA_TERRENO <33.000) THEN DUMMY_SOB_2020_M01_2 = 1 ;
IF ( CODIGO_BARRIO IN('001309','001312','001413','002406','002524','003201','003202','004565','004632','004643','005636','005637') AND AREA_CONSTRUIDA >= 49.100 AND AREA_CONSTRUIDA <59.310 AND PUNTAJE >= 32 AND DENSIDAD >= 0.033774154) THEN DUMMY_SOB_2020_M01_2 = 2 ;
IF ( CODIGO_BARRIO IN('001309','001312','001413','002406','002524','003201','003202','004565','004632','004643','005636','005637') AND AREA_CONSTRUIDA < 46.465 AND PUNTAJE < 32) THEN DUMMY_SOB_2020_M01_2 = 3 ;
IF ( CODIGO_BARRIO IN('003202','004605','005631','009252') AND AREA_CONSTRUIDA >= 59.310 AND AREA_CONSTRUIDA <89.450 AND EDAD >= 33) THEN DUMMY_SOB_2020_M01_2 = 4 ;
IF ( CODIGO_BARRIO IN('001427','001428','002427','004568','004573','004588','004618','005632','006516','006521','006531','009226','009235') AND PUNTAJE < 33 AND DENSIDAD > 0.027609816 AND DENSIDAD <0.031082517) THEN DUMMY_SOB_2020_M01_2 = 5 ;
IF ( CODIGO_BARRIO IN('001101','001416','001429','002412','002455','002579','004513','004605','004627','005631','006103','006518','009210','009248','009252') AND AREA_CONSTRUIDA < 59.310 AND PUNTAJE >= 44 AND AREA_TERRENO >= 32.550 AND AREA_TERRENO <70.445) THEN DUMMY_SOB_2020_M01_2 = 6 ;
IF ( CODIGO_BARRIO IN('001308','001319','002518','003203','009267') AND AREA_CONSTRUIDA < 54.500) THEN DUMMY_SOB_2020_M01_2 = 7 ;
IF ( CODIGO_BARRIO IN('003202','004605','005631','009252') AND AREA_CONSTRUIDA >= 59.310 AND EDAD < 17) THEN DUMMY_SOB_2020_M01_2 = 8 ;
IF ( CODIGO_BARRIO IN('001116','001434','002424','002501','002513','002632','004539','004554','009205','009220','009230')) THEN DUMMY_SOB_2020_M01_2 = 9 ;

IF ( CODIGO_BARRIO IN('001101','002455','002529') AND PUNTAJE < 36 AND AREA_CONSTRUIDA >= 42.00) THEN DUMMY_SUB_2020_M01_2 = 1 ;
IF ( CODIGO_BARRIO IN('002544','008528','009262') AND AREA_TERRENO < 28.950) THEN DUMMY_SUB_2020_M01_2 = 2 ;
IF ( CODIGO_BARRIO IN('001416','002417','002599','003202','004553','004632','004643','005632','005669','006103') AND AREA_TERRENO >= 27.030 AND PUNTAJE < 36 AND AREA_CONSTRUIDA >= 42.00 AND DENSIDAD >= 0.037071451) THEN DUMMY_SUB_2020_M01_2 = 3 ;
IF ( CODIGO_BARRIO IN('002402','002418','002544','003203','008528','009251','009262') AND AREA_TERRENO >= 28.950) THEN DUMMY_SUB_2020_M01_2 = 4 ;
IF ( CODIGO_BARRIO IN('001101','001301','001416','002413','002417','002455','002529','002599','003202','004538','004553','004632','004643','005632','005636','005666','005669','006103','009233','009245') AND AREA_TERRENO >= 21.570 AND AREA_TERRENO <22.365 AND PUNTAJE >= 36 AND AREA_CONSTRUIDA >= 44.75) THEN DUMMY_SUB_2020_M01_2 = 5;
RUN;

proc export data=FILTRO_M01_2   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M01_2.txt'   dbms=dlm  replace;  delimiter='|';  RUN;

proc export data=FILTRO_M01_2_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M01_2_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


PROC SQL;    CREATE TABLE FILTRO_M01_3 AS /*M01_3 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
USO_037,
PUNTAJE,
EDAD,
COORDENADA_X,
DENSIDAD,
RELACION_AREA,
EST05,
EST04,
RFREGION,
AREA_CONSTRUIDA,
NUMERO_UNIDADES_RES_BMP,
EST02,
COL_PUB,
EST01,
TEUSAQUILLO,
AREA_ACT5,
SANTAFE,
PKVENCIN,
CHAPINERO,
TUNJUELITO,
ENGATIVA,
CANDELARIA,
C_BOLIVAR,
ZHF_1213_23,
ZHF_4_TRAT_CONSOL,
ZHF_4_TRAT_DESARR,
ZHF_4_TRAT_CONSERV,
ZHF_6_TOPOG_INCL,
ZHF_6_TOPOG_PLANA,
ZHF_11_INF_VIA_ZO_INT,
ZHF_11_INF_VIA_ART_COM,
MARTIRES,
SUBA,
ZHF_10_EST_VIA_REG,
ZHF_1213_14,
ZHF_1213_17,
B_UNIDOS,
A_NARINO,
P_ARANDA,
RAFAEL_U_U,
ZHF_1213_13,
SAN_CRISTOBAL,
KENNEDY,
AREA_ACT2,
DUMMY_SOB_2020_M01_3,
DUMMY_SUB_2020_M01_3,
PUNTAJE,
EDAD,
RELACION_AREA,
AREA_CONSTRUIDA,
P_ARANDA,
ZHF_10_EST_VIA_REG,
TEUSAQUILLO,
ZHF_1213_14,
SANTAFE,
ZHF_4_TRAT_CONSERV,
ZHF_6_TOPOG_INCL,
ZHF_11_INF_VIA_ART_COM,
TUNJUELITO,
KENNEDY,
ZHF_1213_13,
ZHF_11_INF_VIA_ZO_INT,
ZHF_4_TRAT_CONSOL,
MARTIRES,
ZHF_1213_17,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M01_3');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M01_3_DUMMY AS /*M01_3 - DIFERENCIAS VARIABLES DUMMIES*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
CODIGO_BARRIO, AREA_CONSTRUIDA, COL_PRIV, CAI, UNIVERS, EDAD, PUNTAJE, COL_PUB, DENSIDAD, URI_UPJ, IN_MIL_POL, PKMETROP
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M01_3');
QUIT;




DATA FILTRO_M01_3_DUMMY; SET FILTRO_M01_3_DUMMY; 
/*M01.3. Residencial PH, estrato 3*/

DUMMY_SOB_2020_M01_3=0;
DUMMY_SUB_2020_M01_3=0;
IF ( CODIGO_BARRIO IN('002306','004212','004504','005619','006406','008507','009102','009117') AND DENSIDAD >= 0.014912715 AND EDAD >= 6 AND EDAD <=26 AND IN_MIL_POL < 1858.15098 AND COL_PUB >= 243.777958 AND COL_PUB <=306.206310) THEN DUMMY_SUB_2020_M01_3 = 1 ;
IF ( CODIGO_BARRIO IN('001114','002306','002401','002415','002416','002422','004212','004503','004504','004505','004525','005602','005619','005625','006315','006404','006406','006502','006506','006507','006531','007304','008101','008501','008503','008507','008516','008521','009102','009103','009106','009117','009135','009210','009217','009228','009242','009248') AND DENSIDAD >= 0.066923294 AND EDAD < 6 AND AREA_CONSTRUIDA >= 72.980) THEN DUMMY_SUB_2020_M01_3 = 2 ;
IF ( CODIGO_BARRIO IN('001114','002306','002401','004212','004503','004504','004525','005619','006315','006406','006502','006506','007304','008101','008501','008507','008516','009102','009106','009117','009135','009217','009228') AND DENSIDAD >= 0.014912715 AND EDAD >= 6 AND IN_MIL_POL >= 1948.62940 AND COL_PUB >= 206.182222 AND COL_PUB <=233.912750) THEN DUMMY_SUB_2020_M01_3 = 3 ;
IF ( CODIGO_BARRIO IN('002306','004212','004504','005619','006406','008507','009102','009117') AND DENSIDAD >= 0.014912715 AND EDAD >= 6 AND EDAD <=26 AND IN_MIL_POL < 407.88967 AND COL_PUB >= 621.960978 AND AREA_CONSTRUIDA < 61.450) THEN DUMMY_SUB_2020_M01_3 = 4 ;
IF ( CODIGO_BARRIO IN('001114','004503','006315','007304','009106','009135') AND DENSIDAD >= 0.014912715 AND EDAD >= 26 AND IN_MIL_POL >= 609.79006 AND IN_MIL_POL <=1858.15098 AND COL_PUB >= 343.502438 AND AREA_CONSTRUIDA < 50.250) THEN DUMMY_SUB_2020_M01_3 = 5 ;
IF ( CODIGO_BARRIO IN('001114','004503','006315','007304','009106','009135') AND DENSIDAD >= 0.014912715 AND EDAD >= 26 AND IN_MIL_POL >= 609.79006 AND IN_MIL_POL  <=1858.15098 AND COL_PUB >= 343.502438 AND AREA_CONSTRUIDA >= 65.700) THEN DUMMY_SUB_2020_M01_3 = 6 ;
IF ( CODIGO_BARRIO IN('001114','004503','006315','007304','009106','009135') AND DENSIDAD >= 0.014912715 AND EDAD >= 26 AND IN_MIL_POL < 609.79006 AND COL_PUB >= 85.240403) THEN DUMMY_SUB_2020_M01_3 = 7 ;
IF ( CODIGO_BARRIO IN('001114','002306','002401','004212','004503','004504','004525','005619','006315','006406','006502','006506','007304','008101','008501','008507','008516','009102','009106','009117','009135','009217','009228') AND DENSIDAD >= 0.014912715 AND EDAD >= 6 AND IN_MIL_POL >= 1937.41377 AND IN_MIL_POL  <=1948.62940 AND COL_PUB >= 85.240403) THEN DUMMY_SUB_2020_M01_3 = 8 ;
IF ( CODIGO_BARRIO IN('001114','002306','002401','004212','004503','004504','004525','005619','006315','006406','006502','006506','007304','008101','008501','008507','008516','009102','009106','009117','009135','009217','009228') AND DENSIDAD >= 0.014912715 AND EDAD >= 6 AND IN_MIL_POL>= 1858.15098 AND IN_MIL_POL <=1864.32235 AND COL_PUB >= 85.240403) THEN DUMMY_SUB_2020_M01_3 = 9 ;
IF ( CODIGO_BARRIO IN('001202','003102','005626','005640','005650','007209','008214') AND DENSIDAD >= 0.013747980 AND DENSIDAD <=0.026498296 AND EDAD >= 20 AND IN_MIL_POL >= 406.95229 AND PUNTAJE >= 54) THEN DUMMY_SUB_2020_M01_3 = 10 ;
IF ( CODIGO_BARRIO IN('001202','003102','005626','005640','005650','007209','008214') AND DENSIDAD >= 0.047486462 AND DENSIDAD <=0.063523781 AND EDAD >= 5 AND IN_MIL_POL >= 406.95229 AND PUNTAJE >= 54) THEN DUMMY_SUB_2020_M01_3 = 11 ;
IF ( CODIGO_BARRIO IN('003101','004111','005403','005623','005641','005680','006101','006109','006208','006409','007203','008519','009211') AND DENSIDAD >= 0.013747980 AND EDAD >= 5 AND EDAD <=6 AND IN_MIL_POL >= 406.95229) THEN DUMMY_SUB_2020_M01_3 = 12 ;
IF ( CODIGO_BARRIO IN('001202','002308','004402','004403','005502','005503','007203') AND DENSIDAD >= 0.013747980 AND EDAD < 5 AND COL_PUB >= 379.401809) THEN DUMMY_SUB_2020_M01_3 = 13 ;
IF ( CODIGO_BARRIO IN('002311','005623','005635','005650','006402','006508') AND DENSIDAD < 0.013747980 AND AREA_CONSTRUIDA < 98.250 AND PUNTAJE >= 51) THEN DUMMY_SUB_2020_M01_3 = 14 ;
IF ( CODIGO_BARRIO IN('005621','005623','005641','007209','008108','008523') AND DENSIDAD >= 0.013747980 AND EDAD < 5) THEN DUMMY_SUB_2020_M01_3 = 15 ;
IF ( CODIGO_BARRIO IN('001210','002311','003109','004106','004403','006320','008107') AND DENSIDAD >= 0.013747980 AND DENSIDAD <=0.052816010 AND EDAD >= 5 AND EDAD <=39 AND AREA_CONSTRUIDA >= 50.100 AND AREA_CONSTRUIDA <=59.720) THEN DUMMY_SUB_2020_M01_3 = 16;
IF ( CODIGO_BARRIO IN('002415','005625','006404','006406','009103','009210') AND DENSIDAD < 0.014912715 AND EDAD >= 6 AND COL_PUB < 513.126560 AND AREA_CONSTRUIDA >= 95.050) THEN DUMMY_SUB_2020_M01_3 = 17;
IF ( CODIGO_BARRIO IN('004111','007203') AND DENSIDAD >= 0.031260904 AND EDAD >= 6 AND IN_MIL_POL >= 406.95229 AND IN_MIL_POL <=2356.93923 AND PUNTAJE < 44) THEN DUMMY_SUB_2020_M01_3 = 18 ;
IF ( CODIGO_BARRIO IN('002416','002422','005602','006507','006531','008503','008521') AND DENSIDAD < 0.066923294 AND EDAD < 5 AND COL_PUB < 434.761848 AND AREA_CONSTRUIDA >= 60.890) THEN DUMMY_SUB_2020_M01_3 = 19 ;
IF ( CODIGO_BARRIO IN('003101','004111','005403','005623','005641','005680','006101','006109','006208','006409','007203','008519','009211') AND DENSIDAD >= 0.031260904 AND EDAD >= 6 AND IN_MIL_POL >= 1529.07930 AND IN_MIL_POL <=2356.93923 AND COL_PUB >= 473.735318 AND COL_PUB <=557.408522 AND PUNTAJE >= 44) THEN DUMMY_SUB_2020_M01_3 = 20 ;
IF ( CODIGO_BARRIO IN('002311','005623','005635','005650','006402','006508') AND DENSIDAD < 0.013747980 AND IN_MIL_POL < 2155.18678 AND AREA_CONSTRUIDA < 98.250 AND PUNTAJE < 42) THEN DUMMY_SUB_2020_M01_3 = 21 ;
IF ( CODIGO_BARRIO IN('001209','002309','004402','005626','005640','009241') AND DENSIDAD < 0.013747980 AND AREA_CONSTRUIDA < 98.250) THEN DUMMY_SUB_2020_M01_3 = 22 ;
IF ( CODIGO_BARRIO IN('002422','006531','008503') AND DENSIDAD < 0.066923294 AND EDAD < 6 AND IN_MIL_POL < 1567.99955 AND AREA_CONSTRUIDA >= 51.865 AND AREA_CONSTRUIDA <=60.485) THEN DUMMY_SUB_2020_M01_3 = 23 ;
IF ( CODIGO_BARRIO IN('002416','005602','006507','008521') AND DENSIDAD < 0.066923294 AND EDAD < 6 AND AREA_CONSTRUIDA < 60.890) THEN DUMMY_SUB_2020_M01_3 = 24 ;
IF ( CODIGO_BARRIO IN('001202','001209','002308','002309','003101','003102','004111','004402','005403','005503','005621','005623','005626','005635','005640','005641','005650','005680','006101','006109','006208','006409','006508','007203','007209','008108','008214','008505','008519','008523','009211','009241') AND DENSIDAD >= 0.013747980 AND EDAD >= 22 AND IN_MIL_POL < 406.95229) THEN DUMMY_SUB_2020_M01_3 = 25 ;
IF ( CODIGO_BARRIO IN('001210','002311','003109','004106','004403','006320','008107') AND DENSIDAD >= 0.052816010 AND EDAD >= 5 AND EDAD <=39 AND AREA_CONSTRUIDA >= 50.100) THEN DUMMY_SUB_2020_M01_3 = 26 ;
IF ( CODIGO_BARRIO IN('001114','002306','002401','004212','004503','004504','004525','005619','006315','006406','006502','006506','007304','008101','008501','008507','008516','009102','009106','009117','009135','009217','009228') AND DENSIDAD >= 0.014912715 AND EDAD >= 6 AND COL_PUB >= 81.852895 AND COL_PUB <=85.240403) THEN DUMMY_SUB_2020_M01_3 = 27 ;
IF ( CODIGO_BARRIO IN('002415','005625','006404','006406','009103','009210') AND DENSIDAD < 0.014912715 AND EDAD >= 6 AND COL_PUB < 513.126560 AND AREA_CONSTRUIDA < 76.000) THEN DUMMY_SUB_2020_M01_3 = 28 ;
IF ( CODIGO_BARRIO IN('002416','002422','005602','006507','006531','008503','008521') AND DENSIDAD < 0.066923294 AND EDAD >= 5 AND EDAD <=6 AND AREA_CONSTRUIDA >= 60.890) THEN DUMMY_SUB_2020_M01_3 = 29 ;

IF ( CODIGO_BARRIO IN('001403','002104','004504','004544','005602','005605','005619','005623','006423','007204','008214','008505','009101','009103','009232') AND AREA_CONSTRUIDA >= 54.550 AND DENSIDAD >= 0.065999747 AND UNIVERS >= 1018.64398 AND IN_MIL_POL >= 1274.77341) THEN DUMMY_SOB_2020_M01_3 = 1 ;
IF ( CODIGO_BARRIO IN('001429','002421','004505','004548','005641','005644','006405','006505','006507','008506','009135','009212','009213','009217') AND AREA_CONSTRUIDA < 88.100 AND COL_PUB < 322.85202 AND CAI >= 892.43565 AND CAI <=1541.67111 AND UNIVERS >= 880.64476 AND UNIVERS <=1085.96163 AND IN_MIL_POL < 2745.10766 AND PKMETROP >= 438.0047) THEN DUMMY_SOB_2020_M01_3 = 2 ;
IF ( CODIGO_BARRIO IN('004402','008501','009102','009210','009241') AND AREA_CONSTRUIDA < 47.565 AND COL_PUB >= 111.65394 AND COL_PUB<=719.80107 AND COL_PRIV < 129.159293 AND PUNTAJE >= 50 AND URI_UPJ < 6825.8041 AND PKMETROP >= 623.6922) THEN DUMMY_SOB_2020_M01_3 = 3 ;
IF ( CODIGO_BARRIO IN('002415','002419','004304','004401','005632','006406','009105') AND AREA_CONSTRUIDA >= 46.435 AND AREA_CONSTRUIDA<=54.550 AND COL_PUB >= 533.84126 AND EDAD < 33 AND PUNTAJE < 46) THEN DUMMY_SOB_2020_M01_3 = 4 ;
IF ( CODIGO_BARRIO IN('006423','009232') AND AREA_CONSTRUIDA >= 62.045 AND DENSIDAD < 0.061424444 AND COL_PRIV >= 127.888240 AND UNIVERS >= 1018.64398 AND IN_MIL_POL < 1274.77341 AND URI_UPJ < 5872.9313) THEN DUMMY_SOB_2020_M01_3 = 5 ;
IF ( CODIGO_BARRIO IN('004518','005509','005616','008213','009116','009219','009226') AND AREA_CONSTRUIDA >= 56.420 AND COL_PUB < 752.76283 AND CAI >= 893.07096 AND CAI <=999.90765 AND EDAD < 32) THEN DUMMY_SOB_2020_M01_3 = 6 ;
IF ( CODIGO_BARRIO IN('001111','001114','002301','003102','005625','005647','006104','006521','007303','009133','009214') AND DENSIDAD >= 0.021860488 AND DENSIDAD <=0.033557612 AND CAI < 720.79975 AND COL_PRIV < 474.116827 AND PUNTAJE >= 50) THEN DUMMY_SOB_2020_M01_3 = 7 ;
IF ( CODIGO_BARRIO IN('001111','001114','001206','001406','002301','002305','002306','003102','003108','004104','004506','005203','005502','005505','005508','005611','005612','005625','005647','006103','006104','006106','006407','006515','006521','007303','007307','007308','008105','008108','008425','009133','009214') AND AREA_CONSTRUIDA >= 62.260 AND DENSIDAD >= 0.104553340 AND COL_PRIV < 474.116827 AND UNIVERS < 1219.24829) THEN DUMMY_SOB_2020_M01_3 = 8 ;
IF ( CODIGO_BARRIO IN('004518','005509','005616','008213','009116','009219','009226') AND AREA_CONSTRUIDA >= 56.420 AND DENSIDAD >= 0.068090946 AND COL_PUB >= 296.74817 AND COL_PUB<=752.76283 AND CAI < 893.07096 AND EDAD >= 12 AND EDAD <=32) THEN DUMMY_SOB_2020_M01_3 = 9 ;
IF ( CODIGO_BARRIO IN('002304','004108','004510','004511','005603','005617','006210','008407','009201') AND AREA_CONSTRUIDA >= 68.300 AND DENSIDAD < 0.052559739 AND EDAD >= 11) THEN DUMMY_SOB_2020_M01_3 = 10 ;
IF ( CODIGO_BARRIO IN('001204','004101','006502','007106','008107') AND AREA_CONSTRUIDA < 56.420 AND COL_PUB < 752.76283 AND EDAD < 32) THEN DUMMY_SOB_2020_M01_3 = 11 ;
IF ( CODIGO_BARRIO IN('001403','004504','005602','006423','008505','009232') AND AREA_CONSTRUIDA >= 54.550 AND DENSIDAD < 0.061424444 AND COL_PRIV < 127.888240 AND UNIVERS >= 1018.64398 AND IN_MIL_POL < 1274.77341 AND URI_UPJ < 5872.9313) THEN DUMMY_SOB_2020_M01_3 = 12 ;
IF ( CODIGO_BARRIO IN('004518','006415','006516','008523') AND AREA_CONSTRUIDA < 53.000 AND COL_PUB < 752.76283 AND CAI >= 1003.41814 AND EDAD < 32 AND COL_PRIV >= 98.989142 AND PUNTAJE < 55) THEN DUMMY_SOB_2020_M01_3 = 13 ;
IF ( CODIGO_BARRIO IN('002306','004506','005508','006106','006407','007308') AND DENSIDAD >= 0.046538061 AND DENSIDAD <=0.104553340 AND CAI < 720.79975 AND COL_PRIV < 474.116827 AND UNIVERS < 910.34876 AND PUNTAJE >= 36) THEN DUMMY_SOB_2020_M01_3 = 14 ;
IF ( CODIGO_BARRIO IN('001405','002427','004303','004514','004518','006415','006516','008213','008523','009116','009203','009263') AND AREA_CONSTRUIDA < 53.000 AND COL_PUB < 752.76283 AND CAI >= 581.03927 AND EDAD < 32 AND COL_PRIV >= 98.989142 AND PUNTAJE >= 62) THEN DUMMY_SOB_2020_M01_3 = 15 ;
IF ( CODIGO_BARRIO IN('004310','004525','004530','007209','007403') AND AREA_CONSTRUIDA >= 56.420 AND DENSIDAD < 0.030552332 AND COL_PUB >= 155.68803 AND COL_PUB<=752.76283 AND CAI < 698.28720 AND EDAD < 32 AND IN_MIL_POL >= 831.03128) THEN DUMMY_SOB_2020_M01_3 = 16 ;
IF ( CODIGO_BARRIO IN('004310','004525','004530','005503','005601','006101','007209','007403','008101','008529','009248') AND AREA_CONSTRUIDA >= 56.420 AND DENSIDAD < 0.063266941 AND COL_PUB < 155.68803 AND EDAD < 32 AND IN_MIL_POL >= 831.03128) THEN DUMMY_SOB_2020_M01_3 = 17 ;
IF ( CODIGO_BARRIO IN('004310','004525','004530','005503','005601','006101','007209','007403','008101','008529','009248') AND AREA_CONSTRUIDA >= 56.420 AND COL_PUB < 752.76283 AND EDAD < 32 AND IN_MIL_POL < 831.03128) THEN DUMMY_SOB_2020_M01_3 = 18 ;
IF ( CODIGO_BARRIO IN('002304','004108','004510','004511','005603','005617','006210','008407','009201') AND AREA_CONSTRUIDA < 51.670 AND DENSIDAD < 0.052559739 AND EDAD >= 11) THEN DUMMY_SOB_2020_M01_3 = 19 ;
IF ( CODIGO_BARRIO IN('005625','005647','009214') AND DENSIDAD >= 0.038030045 AND DENSIDAD <=0.046538061 AND CAI < 720.79975 AND COL_PRIV < 474.116827 AND PUNTAJE >= 36) THEN DUMMY_SOB_2020_M01_3 = 20 ;
IF ( CODIGO_BARRIO IN('001403','002104','004504','004544','005602','005605','005619','005623','006423','007204','008214','008505','009101','009103','009232') AND AREA_CONSTRUIDA >= 54.550 AND AREA_CONSTRUIDA<=72.600 AND CAI < 390.00371 AND EDAD >= 25 AND UNIVERS < 1018.64398) THEN DUMMY_SOB_2020_M01_3 = 21 ;
IF ( CODIGO_BARRIO IN('001403','004504','005602','006423','008505','009232') AND AREA_CONSTRUIDA >= 54.550 AND UNIVERS >= 1018.64398 AND IN_MIL_POL < 1274.77341 AND URI_UPJ >= 5872.9313) THEN DUMMY_SOB_2020_M01_3 = 22 ;
IF ( CODIGO_BARRIO IN('001405','002427','004303','004514','004518','006415','006516','008213','008523','009116','009203','009263') AND AREA_CONSTRUIDA < 53.000 AND COL_PUB < 752.76283 AND CAI >= 581.03927 AND EDAD < 32 AND COL_PRIV < 98.989142) THEN DUMMY_SOB_2020_M01_3 = 23 ;
IF ( CODIGO_BARRIO IN('004310','004525','004530','005503','005601','006101','007209','007403','008101','008529','009248') AND AREA_CONSTRUIDA >= 56.420 AND DENSIDAD >= 0.043089478 AND DENSIDAD <=0.063266941 AND COL_PUB >= 155.68803 AND  COL_PUB  <=752.76283 AND EDAD < 32 AND IN_MIL_POL >= 831.03128) THEN DUMMY_SOB_2020_M01_3 = 24 ;
IF ( CODIGO_BARRIO IN('001111','001114','001206','002301','002306','003102','004506','005203','005502','005505','005508','005611','005612','005625','005647','006104','006106','006407','006521','007303','007308','008108','009133','009214') AND DENSIDAD < 0.104553340 AND COL_PRIV < 474.116827 AND PUNTAJE < 36) THEN DUMMY_SOB_2020_M01_3 = 25 ;
IF ( CODIGO_BARRIO IN('001111','001114','001206','001406','002301','002305','002306','003102','003108','004104','004506','005203','005502','005505','005508','005611','005612','005625','005647','006103','006104','006106','006407','006515','006521','007303','007307','007308','008105','008108','008425','009133','009214') AND AREA_CONSTRUIDA < 52.010 AND DENSIDAD >= 0.104553340 AND COL_PRIV < 474.116827 AND UNIVERS < 1219.24829) THEN DUMMY_SOB_2020_M01_3 = 26 ;
IF ( CODIGO_BARRIO IN('001111','001114','001206','001406','002301','002305','002306','003102','003108','004104','004506','005203','005502','005505','005508','005611','005612','005625','005647','006103','006104','006106','006407','006515','006521','007303','007307','007308','008105','008108','008425','009133','009214') AND COL_PRIV >= 474.116827 AND UNIVERS >= 402.09976) THEN DUMMY_SOB_2020_M01_3 = 27 ;
IF ( CODIGO_BARRIO IN('001204','001405','002427','003101','004101','004105','004303','004310','004514','004518','004525','004530','005501','005503','005509','005601','005616','005626','006101','006415','006502','006516','007105','007106','007209','007403','008101','008107','008213','008523','008529','009116','009203','009219','009226','009248','009263') AND AREA_CONSTRUIDA >= 61.735 AND COL_PUB >= 752.76283) THEN DUMMY_SOB_2020_M01_3 = 28 ;
IF ( CODIGO_BARRIO IN('001111','001114','001206','002301','002306','003102','004506','005203','005502','005505','005508','005611','005612','005625','005647','006104','006106','006407','006521','007303','007308','008108','009133','009214') AND AREA_CONSTRUIDA >= 62.205 AND DENSIDAD < 0.104553340 AND CAI >= 1056.35304 AND COL_PRIV < 474.116827 AND PUNTAJE >= 36) THEN DUMMY_SOB_2020_M01_3 = 29 ;
IF ( CODIGO_BARRIO IN('005203','005612','008108') AND DENSIDAD < 0.046538061 AND CAI < 720.79975 AND COL_PRIV < 474.116827 AND PUNTAJE >= 36) THEN DUMMY_SOB_2020_M01_3 = 30 ;
IF ( CODIGO_BARRIO IN('001109','001110','001404','002107','002205','003106','004308','006512','007207','007306','008103') AND DENSIDAD < 0.052559739) THEN DUMMY_SOB_2020_M01_3 = 31 ;
IF ( CODIGO_BARRIO IN('002415','002419','004304','004401','005632','006406','009105') AND AREA_CONSTRUIDA >= 46.435 AND AREA_CONSTRUIDA  <=54.550 AND EDAD < 33 AND PUNTAJE >= 46 AND PUNTAJE <=62) THEN DUMMY_SOB_2020_M01_3 = 32 ;
IF ( CODIGO_BARRIO IN('002104','005605','005619') AND AREA_CONSTRUIDA >= 54.550 AND UNIVERS >= 1018.64398 AND IN_MIL_POL < 1274.77341) THEN DUMMY_SOB_2020_M01_3 = 33 ;
IF ( CODIGO_BARRIO IN('004518','005509','005616','008213','009116','009219','009226') AND AREA_CONSTRUIDA >= 56.420 AND COL_PUB < 296.74817 AND CAI < 893.07096 AND EDAD < 32 AND URI_UPJ >= 1296.7837) THEN DUMMY_SOB_2020_M01_3 = 34 ;
IF ( CODIGO_BARRIO IN('004108','004510','005107','005305') AND DENSIDAD >= 0.052559739) THEN DUMMY_SOB_2020_M01_3 = 35 ;
IF ( CODIGO_BARRIO IN('002304','004108','004510','004511','005603','005617','006210','008407','009201') AND DENSIDAD < 0.052559739 AND EDAD < 11) THEN DUMMY_SOB_2020_M01_3 = 36 ;

RUN;


proc export data=FILTRO_M01_3   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M01_3.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


proc export data=FILTRO_M01_3_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M01_3_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


PROC SQL;    CREATE TABLE FILTRO_M02_4 AS /*M02_4 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
COORDENADA_Y,
EDAD,
PUNTAJE,
EST05,
IN_MIL_POL,
CLINIC123_M_500,
RELACION_AREA,
EST06,
DENSIDAD,
EST01,
RFNAL,
CAI,
AREA_CONSTRUIDA,
GA4,
USO_037,
CONSERVACION_N,
COL_PUB,
CLINIC123_100_200,
CENTCOMERC_200_500,
ZMPA_0_50,
ZMPA_50_100,
ZHF_1213_13,
ZHF_1213_14,
ZHF_1213_15,
CHAPINERO,
FONTIBON,
TEUSAQUILLO,
AREA_ACT6,
ENGATIVA,
B_UNIDOS,
KENNEDY,
SANTAFE,
SUBA,
USAQUEN,
P_ARANDA,
DUMMY_SOB_2020_M02_4,
DUMMY_SUB_2020_M02_4,
EDAD,
RELACION_AREA,
DENSIDAD,
AREA_CONSTRUIDA,
ZHF_1213_15,
ZHF_1213_14,
AREA_ACT6,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M02_4');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M02_4_DUMMY AS /*M02_4 - DIFERENCIAS DUMMY*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
AREA_CONSTRUIDA, CODIGO_BARRIO, PUNTAJE, COL_PRIV, PKVENCIN, EST03, URI_UPJ, COL_PUB, EDAD, PKBOLSIL, CAI
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M02_4');
QUIT;

DATA FILTRO_M02_4_DUMMY; SET FILTRO_M02_4_DUMMY; 
/*M02.4. Residencial PH, estrato 4*/
DUMMY_SUB_2020_M02_4 = 0;
DUMMY_SOB_2020_M02_4 = 0;
IF ( CODIGO_BARRIO IN('007206','008406') AND EDAD >= 8 AND PKBOLSIL >= 51.013098 AND PKBOLSIL <=59.579022 AND CAI < 1209.26183) THEN DUMMY_SUB_2020_M02_4 = 1 ;
IF ( CODIGO_BARRIO IN('005606','006217','006312','006313','006320','006423','007101','008207','008510','008511','008515','008519','008528','009128') AND EDAD >= 37 AND AREA_CONSTRUIDA >= 34.020 AND AREA_CONSTRUIDA <=66.600 AND PKBOLSIL < 688.734609 AND CAI < 758.48553) THEN DUMMY_SUB_2020_M02_4 = 2 ;
IF ( CODIGO_BARRIO IN('005606','006217','006312','006313','006320','006423','007101','008207','008510','008511','008515','008519','008528','009128') AND AREA_CONSTRUIDA < 32.650 AND PKBOLSIL >= 306.625096 AND PKBOLSIL <=361.139732) THEN DUMMY_SUB_2020_M02_4 = 3 ;
IF ( CODIGO_BARRIO IN('006311','009114') AND EDAD >= 8 AND PKBOLSIL >= 601.556132) THEN DUMMY_SUB_2020_M02_4 = 4 ;
IF ( CODIGO_BARRIO IN('005606','006217','006313','006423','008528') AND EDAD >= 6 AND EDAD <=33 AND AREA_CONSTRUIDA >= 34.020 AND AREA_CONSTRUIDA<=110.700 AND PKBOLSIL >= 278.125622 AND PKBOLSIL <=287.516718) THEN DUMMY_SUB_2020_M02_4 = 5 ;
IF ( CODIGO_BARRIO IN('008503','008518') AND EDAD >= 7 AND EDAD <=8 AND AREA_CONSTRUIDA < 70.000 AND CAI >= 478.90407) THEN DUMMY_SUB_2020_M02_4 = 6 ;
IF ( CODIGO_BARRIO IN('005104','005105','008204','008205','008503','008518','009108','009122') AND EDAD < 8 AND AREA_CONSTRUIDA >= 76.850 AND PKBOLSIL >= 471.974561) THEN DUMMY_SUB_2020_M02_4 = 7 ;
IF ( CODIGO_BARRIO IN('005104','005105','008204','008205','008503','008518','009108','009122') AND EDAD < 8 AND AREA_CONSTRUIDA < 70.000 AND CAI >= 230.02602 AND CAI <=478.90407) THEN DUMMY_SUB_2020_M02_4 = 8 ;
IF ( CODIGO_BARRIO IN('005606','006217','006312','006313','006320','006423','007101','008207','008510','008511','008515','008519','008528','009128') AND AREA_CONSTRUIDA >= 32.650 AND AREA_CONSTRUIDA <=34.020 AND PKBOLSIL >= 306.625096) THEN DUMMY_SUB_2020_M02_4 = 9 ;
IF ( CODIGO_BARRIO IN('005117','005307','006202','007206','008204','008406','008530','009102','009115','009210') AND EDAD >= 8 AND AREA_CONSTRUIDA >= 33.000 AND AREA_CONSTRUIDA <=40.435 AND PKBOLSIL >= 59.579022 AND PKBOLSIL  <=601.556132 AND CAI < 1209.26183) THEN DUMMY_SUB_2020_M02_4 = 10 ;
IF ( CODIGO_BARRIO IN('008425') AND EDAD >= 8 AND EDAD <=36 AND PKBOLSIL < 601.556132 AND CAI < 1209.26183) THEN DUMMY_SUB_2020_M02_4 = 11 ;
IF ( CODIGO_BARRIO IN('005117','005307','006202','007206','008204','008406','008425','008530','009102','009115','009210') AND EDAD >= 8 AND PKBOLSIL < 601.556132 AND CAI >= 1209.26183) THEN DUMMY_SUB_2020_M02_4 = 12 ;
IF ( CODIGO_BARRIO IN('008503','008518') AND EDAD >= 3 AND EDAD <=5 AND AREA_CONSTRUIDA >= 46.855 AND AREA_CONSTRUIDA <=61.405 AND CAI >= 478.90407) THEN DUMMY_SUB_2020_M02_4 = 13 ;
IF ( CODIGO_BARRIO IN('005104','005105','008204','008205','008503','008518','009108','009122') AND EDAD < 3 AND AREA_CONSTRUIDA < 70.000 AND CAI >= 478.90407) THEN DUMMY_SUB_2020_M02_4 = 14 ;

IF ( CODIGO_BARRIO IN('005403','006303','006312','007202','008206','008503','008509') AND COL_PUB < 2071.53431 AND EST03 < 731.926160 AND AREA_CONSTRUIDA >= 92.015 AND AREA_CONSTRUIDA <=115.650 AND URI_UPJ >= 4512.8072 AND URI_UPJ <=4894.9041 AND PUNTAJE < 70) THEN DUMMY_SOB_2020_M02_4 = 1 ;
IF ( CODIGO_BARRIO IN('005403','006303','006312','007202','008205','008206','008503','008509','008511','008515','008518') AND COL_PRIV < 588.137686 AND COL_PUB >= 1261.57290 AND COL_PUB  <=2071.53431 AND EST03 >= 885.977667 AND AREA_CONSTRUIDA >= 62.815 AND URI_UPJ >= 1779.6200) THEN DUMMY_SOB_2020_M02_4 = 2 ;
IF ( CODIGO_BARRIO IN('006405','008207') AND COL_PRIV >= 463.582402 AND COL_PRIV  <=970.870999 AND COL_PUB < 2267.25399 AND PKVENCIN >= 38.551198 AND PKVENCIN <=463.217963 AND EST03 < 489.652436 AND AREA_CONSTRUIDA >= 59.615 AND AREA_CONSTRUIDA <=73.610 AND URI_UPJ < 5340.8064 AND PUNTAJE >= 73) THEN DUMMY_SOB_2020_M02_4 = 3 ;
IF ( CODIGO_BARRIO IN('006405','008207') AND COL_PRIV >= 463.582402 AND COL_PRIV <=970.870999 AND COL_PUB < 2267.25399 AND PKVENCIN >= 38.551198 AND PKVENCIN <=463.217963 AND EST03 < 489.652436 AND AREA_CONSTRUIDA >= 78.425 AND URI_UPJ < 5340.8064 AND PUNTAJE >= 73) THEN DUMMY_SOB_2020_M02_4 = 4 ;
IF ( CODIGO_BARRIO IN('005207','006201','006217','006301','006320','006405','008207','008502','008512','009121','009127','009133') AND COL_PRIV >= 970.870999 AND COL_PUB < 2267.25399 AND PKVENCIN >= 38.551198 AND PKVENCIN <=463.217963 AND EST03 < 489.652436 AND URI_UPJ < 5340.8064) THEN DUMMY_SOB_2020_M02_4 = 5 ;
IF ( CODIGO_BARRIO IN('005103','005207','005507','006201','006217','006301','006320','006405','008207','008208','008502','008512','009121','009127','009133') AND COL_PRIV >= 146.408705 AND COL_PUB < 2267.25399 AND PKVENCIN < 38.551198 AND AREA_CONSTRUIDA < 91.720) THEN DUMMY_SOB_2020_M02_4 = 6 ;
IF ( CODIGO_BARRIO IN('005103','005207','005507','006201','006217','006301','006320','006405','008207','008208','008502','008512','009121','009127','009133') AND COL_PRIV < 146.408705 AND COL_PUB < 2267.25399 AND PKVENCIN >= 176.970761 AND PKVENCIN <=463.217963 AND PUNTAJE < 62) THEN DUMMY_SOB_2020_M02_4 = 7 ;
IF ( CODIGO_BARRIO IN('003102','004502','004551','005101','005102','005103','005104','005107','005110','005111','005113','005117','005207','005305','005306','005307','005402','005403','005506','005507','005603','005606','005607','005663','005668','005669','006110','006201','006202','006208','006209','006216','006217','006301','006302','006303','006311','006312','006313','006316','006319','006320','006405','006502','007102','007103','007105','007106','007201','007202','007203','007206','007208','007209','008105','008201','008202','008203','008204','008205','008206','008207','008208','008212','008306','008425','008501','008502','008503','008506','008508','008509','008510','008511','008512','008515','008518','008519','008521','008525','008526','008532','008533','009102','009103','009104','009105','009106','009108','009110','009113','009114','009115','009116','009117','009120','009121','009122','009127','009128','009129','009130','009133','009135','009210','009211','009212','009214','009215','009219','009241') AND COL_PUB >= 2267.25399) THEN DUMMY_SOB_2020_M02_4 = 8 ;
IF ( CODIGO_BARRIO IN('005106','007104','008544') AND COL_PRIV >= 591.765320 AND COL_PRIV <=611.425117 AND COL_PUB >= 242.82316 AND PKVENCIN >= 24.279327 AND EST03 >= 66.110552 AND EST03 <=878.544266 AND PUNTAJE >= 47 AND PUNTAJE <=72) THEN DUMMY_SOB_2020_M02_4 = 9 ;
IF ( CODIGO_BARRIO IN('005105','005106','007205','008406','008528','008530','008544') AND COL_PRIV >= 38.762251 AND COL_PRIV  <=185.121228 AND PKVENCIN >= 24.279327 AND EST03 >= 44.956749 AND AREA_CONSTRUIDA < 73.175 AND PUNTAJE >= 72) THEN DUMMY_SOB_2020_M02_4 = 10 ;
IF ( CODIGO_BARRIO IN('005401','006423','006512','007101','007207','008107','008517') AND COL_PRIV >= 38.762251 AND COL_PUB >= 633.89084 AND PKVENCIN >= 24.279327 AND EST03 >= 44.956749 AND AREA_CONSTRUIDA >= 108.160 AND PUNTAJE >= 72) THEN DUMMY_SOB_2020_M02_4 = 11 ;
IF ( CODIGO_BARRIO IN('005401','006423','006512','007101','007207','008107','008517') AND COL_PRIV >= 38.762251 AND COL_PUB >= 588.95705 AND  COL_PUB <=633.89084 AND PKVENCIN >= 24.279327 AND EST03 >= 44.956749 AND AREA_CONSTRUIDA >= 38.330 AND PUNTAJE >= 72) THEN DUMMY_SOB_2020_M02_4 = 12 ;
IF ( CODIGO_BARRIO IN('004531','005304','007107','007401','008108','008111','008112','008214','008411') AND COL_PRIV >= 138.554334 AND COL_PUB >= 661.56243 AND PKVENCIN >= 24.279327 AND PKVENCIN <=288.870186 AND URI_UPJ < 4808.7748 AND PUNTAJE >= 66 AND PUNTAJE <=75) THEN DUMMY_SOB_2020_M02_4 = 13 ;
IF ( CODIGO_BARRIO IN('008414','009213') AND AREA_CONSTRUIDA >= 72.930) THEN DUMMY_SOB_2020_M02_4 = 14 ;
IF ( CODIGO_BARRIO IN('004531','005304','007107','007401','008108','008111','008112','008214','008411') AND COL_PRIV >= 138.554334 AND PKVENCIN >= 24.279327 AND PKVENCIN <=288.870186 AND AREA_CONSTRUIDA >= 89.600 AND AREA_CONSTRUIDA <=117.500 AND URI_UPJ >= 4808.7748) THEN DUMMY_SOB_2020_M02_4 = 15 ;
IF ( CODIGO_BARRIO IN('006423','007207') AND COL_PRIV >= 38.762251 AND PKVENCIN >= 24.279327 AND EST03 < 66.110552 AND AREA_CONSTRUIDA >= 84.900 AND PUNTAJE >= 47 AND PUNTAJE <=72) THEN DUMMY_SOB_2020_M02_4 = 16 ;
IF ( CODIGO_BARRIO IN('005403','006303','006312','007202','008205','008206','008503','008509','008511','008515','008518') AND COL_PRIV >= 588.137686 AND COL_PUB < 2071.53431 AND EST03 >= 885.977667 AND AREA_CONSTRUIDA >= 62.815 AND URI_UPJ >= 1779.6200) THEN DUMMY_SOB_2020_M02_4 = 17 ;
IF ( CODIGO_BARRIO IN('005402','005403','006208','006303','006312','006313','007202','008205','008206','008503','008509','008510','008511','008515','008518','009110') AND COL_PUB >= 2071.53431 AND COL_PUB <=2267.25399 AND AREA_CONSTRUIDA >= 62.815 AND URI_UPJ >= 1779.6200 AND URI_UPJ  <=3888.2757) THEN DUMMY_SOB_2020_M02_4 = 18 ;
IF ( CODIGO_BARRIO IN('005103','006301','009127','009133') AND COL_PRIV >= 146.408705 AND COL_PRIV <=463.582402 AND COL_PUB < 2267.25399 AND PKVENCIN >= 38.551198 AND PKVENCIN <=463.217963 AND EST03 < 67.380505 AND URI_UPJ < 5340.8064 AND PUNTAJE >= 62) THEN DUMMY_SOB_2020_M02_4 = 19 ;
IF ( CODIGO_BARRIO IN('005507','008208') AND COL_PRIV >= 463.582402 AND COL_PUB < 2267.25399 AND PKVENCIN >= 38.551198 AND PKVENCIN <=463.217963 AND URI_UPJ < 5340.8064) THEN DUMMY_SOB_2020_M02_4 = 20 ;
IF ( CODIGO_BARRIO IN('005103','005207','005507','006201','006217','006301','006320','006405','008207','008208','008502','008512','009121','009127','009133') AND COL_PUB < 2267.25399 AND PKVENCIN >= 463.217963) THEN DUMMY_SOB_2020_M02_4 = 21 ;
IF ( CODIGO_BARRIO IN('005105','005106','005401','006423','006512','007101','007104','007205','007207','008107','008406','008517','008528','008530','008544') AND COL_PRIV >= 38.762251 AND PKVENCIN >= 24.279327 AND URI_UPJ >= 2627.5977 AND PUNTAJE < 47) THEN DUMMY_SOB_2020_M02_4 = 22 ;
IF ( CODIGO_BARRIO IN('005401','006423','006512','007101','007207','008107','008517') AND COL_PRIV >= 38.762251 AND COL_PUB >= 633.89084 AND PKVENCIN >= 110.586348 AND EST03 >= 44.956749 AND AREA_CONSTRUIDA >= 77.220 AND AREA_CONSTRUIDA <78.050 AND PUNTAJE >= 72) THEN DUMMY_SOB_2020_M02_4 = 23 ;
IF ( CODIGO_BARRIO IN('007107') AND COL_PRIV >= 38.762251 AND COL_PRIV <=138.554334 AND PKVENCIN >= 24.279327 AND PKVENCIN <=288.870186) THEN DUMMY_SOB_2020_M02_4 = 24 ;
IF ( CODIGO_BARRIO IN('004531','005304','007107','007401','008108','008111','008112','008214','008411') AND COL_PRIV >= 38.762251 AND PKVENCIN >= 288.870186 AND AREA_CONSTRUIDA >= 60.950) THEN DUMMY_SOB_2020_M02_4 = 25 ;
IF ( CODIGO_BARRIO IN('004531','005105','005106','005304','005401','006423','006512','007101','007104','007107','007205','007207','007401','008107','008108','008111','008112','008214','008406','008411','008517','008528','008530','008544') AND COL_PRIV >= 38.762251 AND PKVENCIN < 24.279327) THEN DUMMY_SOB_2020_M02_4 = 26 ;
IF ( CODIGO_BARRIO IN('004531','005105','005106','005304','005401','006423','006512','007101','007104','007107','007205','007207','007401','008107','008108','008111','008112','008214','008406','008411','008517','008528','008530','008544') AND COL_PRIV < 38.762251) THEN DUMMY_SOB_2020_M02_4 = 27 ;
IF ( CODIGO_BARRIO IN('008414','009213') AND AREA_CONSTRUIDA < 66.305) THEN DUMMY_SOB_2020_M02_4 = 28 ;

RUN;

proc export data=FILTRO_M02_4   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M02_4.txt'   dbms=dlm  replace;  delimiter='|';  RUN;
proc export data=FILTRO_M02_4_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M02_4_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


PROC SQL;    CREATE TABLE FILTRO_M02_5 AS /*M02_5 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
VALOR_REFERENCIA_2020,
EDAD,
PKVENCIN,
COORDENADA_Y,
EST06,
COORDENADA_X,
ZHF_1213_16,
PKZONAL,
PKMETROP,
CENTCOMERC_200_500,
EST03,
GB4,
COL_PRIV,
USO_037,
CONSERVACION_N,
CONSERVACION_I,
PISO_4_5,
PISO_11_20,
PISO_6_10,
UNIVERS,
CENTCOMERC_M_500,
ZHF_1213_14,
ZHF_1213_15,
ZHF_1213_18,
ZHF_1213_21,
ZHF_1213_23,
ZHF_4_TRAT_MEJ,
ZHF_11_INF_VIA_ART_BAS,
AREA_ACT4,
GB2,
GB3,
GC4,
TEUSAQUILLO,
USAQUEN,
B_UNIDOS,
SUBA,
PUNTAJE,
AREA_CONSTRUIDA,
DUMMY_SOB_2020_M02_5,
DUMMY_SUB_2020_M02_5,
RELACION_AREA,
FONTIBON,
VALOR_REFERENCIA_2020,
EDAD,
B_UNIDOS,
PUNTAJE,
TEUSAQUILLO,
SUBA,
ZHF_1213_16,
ZHF_1213_21,
ZHF_1213_14,
ZHF_1213_15,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M02_5');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M02_5_DUMMY AS /*M02_5 - DIFERENCIAS DUMMIES*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
PKBOLSIL, COORDENADA_Y, AREA_CONSTRUIDA, DENSIDAD, EST06, PKMETROP, URI_UPJ, PUNTAJE, CODIGO_BARRIO, UNIVERS
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M02_5');
QUIT;

DATA FILTRO_M02_5_DUMMY; SET FILTRO_M02_5_DUMMY;
/*M02.5. Residencial PH, estrato 5*/

DUMMY_SOB_2020_M02_5=0;
DUMMY_SUB_2020_M02_5=0;
IF ( CODIGO_BARRIO IN('008306','008311','008314') AND COORDENADA_Y < 108594.58 AND UNIVERS < 399.76186 AND AREA_CONSTRUIDA >= 146.69 AND AREA_CONSTRUIDA <=160.70) THEN DUMMY_SUB_2020_M02_5 = 1 ;
IF ( CODIGO_BARRIO IN('008306','008311','008314') AND COORDENADA_Y >= 108594.58) THEN DUMMY_SUB_2020_M02_5 = 2 ;
IF ( CODIGO_BARRIO IN('008306','008311','008314') AND COORDENADA_Y < 108594.58 AND UNIVERS < 399.76186 AND AREA_CONSTRUIDA >= 88.55 AND AREA_CONSTRUIDA <=106.15) THEN DUMMY_SUB_2020_M02_5 = 3 ;

IF ( CODIGO_BARRIO IN('008313','008314','008514','009113') AND PKMETROP >= 1457.8911 AND COORDENADA_Y < 119299.43 AND AREA_CONSTRUIDA < 412.87 AND PUNTAJE >= 58 AND PUNTAJE<=60 AND EST06 >= 104.86428 AND PKBOLSIL >= 105.26558) THEN DUMMY_SOB_2020_M02_5 = 1 ;
IF ( CODIGO_BARRIO IN('008313','008314','008514','009113') AND PKMETROP < 1457.8911) THEN DUMMY_SOB_2020_M02_5 = 2 ;
IF ( CODIGO_BARRIO IN('008312','009129') AND PUNTAJE >= 77) THEN DUMMY_SOB_2020_M02_5 = 3 ;
RUN;


proc export data=FILTRO_M02_5   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M02_5.txt'   dbms=dlm  replace;  delimiter='|';  RUN;

proc export data=FILTRO_M02_5_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M02_5_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;

PROC SQL;    CREATE TABLE FILTRO_M02_6 AS /*M02_6 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
COORDENADA_Y,
EDAD,
RFNAL,
USAQUEN,
PUNTAJE,
PKZONAL,
COL_PRIV,
IN_MIL_POL,
PKBOLSIL,
GC3,
ZHF_6_TOPOG_PLANA,
NUMERO_UNIDADES_RES_BMP,
RELACION_AREA,
COL_PUB,
USO_037,
DENSIDAD,
CAI,
EST01,
UNIVERS,
CLINIC123_100_200,
CLINIC123_200_500,
ZHF_1213_15,
DUMMY_SUB_2020_M02_6,
DUMMY_SOB_2020_M02_6,
ZHF_1213_16,
CHAPINERO,
AREA_CONSTRUIDA,
EDAD,
PUNTAJE,
RELACION_AREA,
USAQUEN,
CHAPINERO,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M02_6');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M02_6_DUMMY AS /*M02_6 - DIFERENCIAS DUMMY*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
CODIGO_BARRIO, DENSIDAD, PKVENCIN, AREA_CONSTRUIDA, CLINIC123, PKBOLSIL, CAI, UNIVERS, COL_PUB, IN_MIL_POL, EDAD, ZOINFLRUID, EST04, EST06, PKZONAL, PKMETROP, RSDJ, EST01, EST03, RFNAL, RFREGION, EST02, COORDENADA_Y,
DENSIDAD, EDAD, PUNTAJE, COL_PRIV

FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M02_6');
QUIT;

DATA FILTRO_M02_6_DUMMY; SET FILTRO_M02_6_DUMMY;
DUMMY_SOB_2020_M02_6=0;
DUMMY_SUB_2020_M02_6=0;

IF ( COL_PUB >= 161.69336  AND CODIGO_BARRIO IN('008305','008308','008401','008408','008411','008412','008418') AND DENSIDAD >= 0.091469496 AND DENSIDAD<=0.155505738 AND COORDENADA_Y >= 106006.36 AND PKVENCIN >= 249.11913 AND EST01 < 3565.3983 AND PKBOLSIL < 742.53425 AND CLINIC123 < 1378.107 AND PKMETROP >= 3884.3799) THEN DUMMY_SOB_2020_M02_6 = 1 ;
IF ( COL_PUB >= 161.69336 AND CODIGO_BARRIO IN('008305','008308','008401','008408','008411','008412','008418') AND DENSIDAD < 0.155505738 AND COORDENADA_Y >= 106006.36 AND PKVENCIN >= 24.87652 AND EST01 >= 3565.3983) THEN DUMMY_SOB_2020_M02_6 = 2 ;
IF ( COL_PUB >= 161.69336 AND CODIGO_BARRIO IN('008305','008308','008401','008408','008411','008412','008418') AND DENSIDAD < 0.155505738 AND COORDENADA_Y >= 106006.36 AND PKVENCIN >= 24.87652 AND EST01 >=1065.1788 AND EST01<=3565.3983 AND PKBOLSIL < 668.04041 AND CLINIC123 < 1378.107 AND PKMETROP < 3884.3799 AND AREA_CONSTRUIDA >= 31.85 AND PKZONAL >= 2066.2146 AND EST04 >= 794.22607) THEN DUMMY_SOB_2020_M02_6 = 3 ;
IF ( COL_PUB >= 161.69336 AND CODIGO_BARRIO IN('008310','008406','008538','009249') AND DENSIDAD < 0.045474751 AND COORDENADA_Y >= 114250.99 AND UNIVERS >= 1798.9511) THEN DUMMY_SOB_2020_M02_6 = 4 ;
IF ( COL_PUB < 161.69336) THEN DUMMY_SOB_2020_M02_6 = 5 ;
IF ( COL_PUB >= 161.69336 AND CODIGO_BARRIO IN('008305','008308','008401','008408','008411','008412','008418') AND DENSIDAD < 0.155505738 AND COORDENADA_Y >= 106006.36 AND PKVENCIN>=24.87652 AND PKVENCIN<=249.11913 AND EST01 < 3565.3983 AND PKBOLSIL < 742.53425 AND CLINIC123 < 1378.107 AND PKMETROP >= 3884.3799) THEN DUMMY_SOB_2020_M02_6 = 6 ;
IF ( COL_PUB >= 161.69336 AND CODIGO_BARRIO IN('008401') AND DENSIDAD < 0.155505738 AND COORDENADA_Y >= 106006.36 AND PKVENCIN >= 24.87652 AND EST01 < 3565.3983 AND PKBOLSIL >= 742.53425) THEN DUMMY_SOB_2020_M02_6 = 7 ;
IF ( COL_PUB >= 161.69336 AND CODIGO_BARRIO IN('008202','008203','008301','008302','008303','008304','008305','008307','008308','008309','008311','008315','008401','008403','008405','008407','008408','008411','008412','008415','008416','008417','008418','008536','009112','009121','009128','009136','009222','009231') AND DENSIDAD < 0.155505738 AND COORDENADA_Y < 106006.36 AND PKVENCIN >= 24.87652 AND PKVENCIN<102.71714) THEN DUMMY_SOB_2020_M02_6 = 8 ;

IF ( CODIGO_BARRIO IN('008406','008407','008408') AND PUNTAJE >= 88 AND COL_PRIV >= 294.50477) THEN DUMMY_SUB_2020_M02_6 = 1 ;
IF ( CODIGO_BARRIO IN('008301','008304','008403') AND EDAD >= 9 AND EDAD<=54 AND DENSIDAD < 0.0179328261 AND AREA_CONSTRUIDA < 81.34) THEN DUMMY_SUB_2020_M02_6 = 2 ;
IF ( CODIGO_BARRIO IN('008307','008412') AND EDAD < 9 AND PUNTAJE < 75) THEN DUMMY_SUB_2020_M02_6 = 3 ;
IF ( CODIGO_BARRIO IN('008406','008407','008408') AND PUNTAJE >= 59 AND PUNTAJE<=88 AND DENSIDAD >= 0.0070319041 AND DENSIDAD<=0.0080546290) THEN DUMMY_SUB_2020_M02_6 = 4 ;
IF ( CODIGO_BARRIO IN('008315') AND EDAD < 9 AND DENSIDAD < 0.0316449784) THEN DUMMY_SUB_2020_M02_6 = 5;

RUN;

proc export data=FILTRO_M02_6   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M02_6.txt'   dbms=dlm  replace;  delimiter='|';  RUN;

proc export data=FILTRO_M02_6_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M02_6_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;

PROC SQL;    CREATE TABLE FILTRO_M03 AS /*M03 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
DUMMY_ESPNORTE,
EST05,
PUNTAJE,
PKZONAL,
EDAD,
NUMERO_UNIDADES_BMP,
VALOR_REFERENCIA_2020,
COL_PUB,
ESTACTM_M_500,
USO_081,
CENT_CHAPINERO,
CENT_SALITRE_Z_IND,
CONSERVACION_M,
ZHF_4_TRAT_RENOV,
ZHF_4_TRAT_CONSERV,
ZHF_10_EST_VIA_BUENO,
ZHF_11_INF_VIA_ZO_INT,
ZHF_1213_21,
ZHF_1213_44,
USAQUEN,
CHAPINERO,
SUBA,
TEUSAQUILLO,
CLINIC123_0_100,
CENTCOMERC_0_100,
ESTACTM_0_100,
AREA_CONSTRUIDA,
PKMETROP,
PKVENCIN,
SANTAFE,
ZHF_11_INF_VIA_ART_COM,
B_UNIDOS,
DUMMY_SUB_2020_M03,
DUMMY_SOB_2020_M03,
RELACION_AREA,
A_NARINO,
CANDELARIA,
P_ARANDA,
ZHF_1213_14,
ZHF_1213_13,
CENT_USAQUEN_H_STA_BARB,
PUNTAJE,
EDAD,
SANTAFE,
SUBA,
AREA_CONSTRUIDA,
CHAPINERO,
ZHF_1213_21,
ZHF_11_INF_VIA_ART_COM, 
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M03');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M03_DUMMY AS /*M03 - DIFERENCIAS DUMMY*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
CODIGO_BARRIO, PKVENCIN, CAI, AREA_CONSTRUIDA, DENSIDAD, 
COL_PUB, PKBOLSIL, PKZONAL, COL_PRIV, EST05, ZOINFLRUID, PUNTAJE, EST03, PKMETROP, COORDENADA_Y, PKVENCIN, IN_MIL_POL

FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M03');
QUIT;


DATA FILTRO_M03_DUMMY; SET FILTRO_M03_DUMMY;
IF ( CODIGO_BARRIO IN('003108','007204','008101','009127') AND CAI < 1476.5992 AND AREA_CONSTRUIDA >= 13.91 AND AREA_CONSTRUIDA <=48.35 AND DENSIDAD >= 0.091061815) THEN DUMMY_SOB_2020_M03 = 1 ;
IF ( CODIGO_BARRIO IN('003102','008414','008415','008514') AND CAI < 1476.5992 AND AREA_CONSTRUIDA >= 212.50) THEN DUMMY_SOB_2020_M03 = 1 ;
IF ( CODIGO_BARRIO IN('003102','003108','003109','004103','007204','008101','008301','008313','008411','008414','008415','008514','009124','009127') AND CAI >= 1476.5992) THEN DUMMY_SOB_2020_M03 = 1 ;
IF ( CODIGO_BARRIO IN('004101','004104','004209','005402','006103','007208','007403','008208','008501','008507','008512','008513','008530','009207') AND PKVENCIN < 234.5897) THEN DUMMY_SOB_2020_M03 = 1 ;

IF ( CODIGO_BARRIO IN('003102','003107','004101','004103','004110','005507','007107','008107','008109','008202','008314','008404','008406','008407','008411','008515','009118','009126') AND EST05 < 22.479371 AND PUNTAJE < 83 AND COL_PRIV < 503.54636) THEN DUMMY_SUB_2020_M03 = 1 ;
IF ( CODIGO_BARRIO IN('003102','003107','004101','004103','004110','005507','007107','008107','008109','008202','008314','008404','008406','008407','008411','008515','009118','009126') AND PUNTAJE >= 83) THEN DUMMY_SUB_2020_M03 = 1 ;
IF ( CODIGO_BARRIO IN('003108','003109','003110','008306','008412') AND EST05 >= 28.055870 AND PKBOLSIL >= 28.375272 AND AREA_CONSTRUIDA >= 11.205 AND AREA_CONSTRUIDA <=35.850 AND IN_MIL_POL >= 755.75683 AND IN_MIL_POL<=810.44199) THEN DUMMY_SUB_2020_M03 = 1 ;
IF ( CODIGO_BARRIO IN('004110','005507','007107','008109','008314') AND EST05 >= 22.479371 AND PUNTAJE < 64) THEN DUMMY_SUB_2020_M03 = 1 ;
RUN;


proc export data=FILTRO_M03   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M03_OFI.txt'   dbms=dlm  replace;  delimiter='|';  RUN;

proc export data=FILTRO_M03_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M03_OFI_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


PROC SQL;    CREATE TABLE FILTRO_M04 AS /*M04 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
NUMERO_PISO_01	,
NUMERO_PISO_02	,
VALOR_REFERENCIA_2020	,
COL_PUB	,
PUNTAJE	,
COL_PRIV	,
IN_MIL_POL	,
ZHF_1213_24	,
CHAPINERO	,
EST02	,
USAQUEN	,
EST04	,
ZHF_1213_23	,
CENT_USAQUEN_H_STA_BARB	,
ZHF_1213_15	,
SAN_CRISTOBAL	,
USME	,
TUNJUELITO	,
BOSA	,
FONTIBON	,
TEUSAQUILLO	,
MARTIRES	,
A_NARINO	,
CANDELARIA	,
RAFAEL_U_U	,
ZHF_1213_21	,
ZHF_1213_22	,
ZHF_4_TRAT_CONSOL	,
ZHF_4_TRAT_RENOV	,
ZHF_4_TRAT_CONSERV	,
ZHF_4_TRAT_MEJ	,
ZHF_6_TOPOG_PLANA	,
ZHF_6_TOPOG_INCL	,
ZHF_11_INF_VIA_LOCAL	,
ZHF_11_INF_VIA_ZO_INT	,
ZHF_11_INF_VIA_ART_COM	,
AREA_ACT5	,
AREA_ACT6	,
CENT_CENTRO_H_INT	,
CENT_DELICIAS_ENS	,
CENT_RESTREPO_SANT	,
CENT_SIETE_AGOSTO	,
CENT_SUBA	,
CENT_TOBERIN_LA_PAZ	,
CENT_VEINTE_JULIO	,
CENTCOMERC_0_100	,
RELACION_AREA	,
AREA_CONSTRUIDA	,
EDAD	,
NUMERO_UNIDADES_BMP	,
PKVENCIN	,
USO_040	,
KENNEDY	,
B_UNIDOS	,
P_ARANDA	,
SANTAFE	,
ZHF_10_EST_VIA_REG	,
ZHF_1213_12	,
SUBA	,
ENGATIVA	,
ZHF_1213_14	,
ZHF_1213_13	,
DUMMY_SOB_2020_M04	,
DUMMY_SUB_2020_M04	,
VALOR_REFERENCIA_2020,
USAQUEN,
A_NARINO,
TEUSAQUILLO,
EDAD,
FONTIBON,
CHAPINERO,
ZHF_1213_23,
ZHF_11_INF_VIA_ZO_INT,
ZHF_4_TRAT_MEJ,
ZHF_1213_12,
SUBA,
PUNTAJE,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M04');
QUIT;


PROC SQL;    CREATE TABLE FILTRO_M04_DUMMY AS /*M03 - DIFERENCIAS DUMMY*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
CODIGO_BARRIO, AREA_CONSTRUIDA, PKVENCIN, IN_MIL_POL, PUNTAJE, COL_PRIV, RFREGION, CAI, COL_PUB, EDAD, DENSIDAD, CLINIC123, URI_UPJ, EST01, PKMETROP, EST02, RFNAL, UNIVERS, PKZONAL, EST04, RSDJ, EST05, ZHF_11_INF_VIA_LOCAL, EST03,
PKBOLSIL,  ZOINFLRUID, COL_PRIV+ZHF_1213_15

FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M04');
QUIT;

DATA FILTRO_M04_DUMMY; SET FILTRO_M04_DUMMY;
IF ( CODIGO_BARRIO IN('001402','003103','003107','004107','004108','004203','004507','004511','005606','005614','005623','005657','006408','007403','008201','008313','008417','009228') AND AREA_CONSTRUIDA < 66.88 AND PKVENCIN >= 51.463132 AND PKZONAL>= 896.92302 AND PKZONAL<=935.75011) THEN DUMMY_SOB_2020_M04 = 1 ;
IF ( CODIGO_BARRIO IN('005509','008309') AND AREA_CONSTRUIDA < 66.88 AND PKVENCIN >= 51.463132 AND DENSIDAD < 0.047079844) THEN DUMMY_SOB_2020_M04 = 2 ;
IF ( CODIGO_BARRIO IN('003107','005606','008307','008309','008417') AND AREA_CONSTRUIDA >= 66.88 AND PKVENCIN < 155.110333) THEN DUMMY_SOB_2020_M04 = 3 ;
IF ( CODIGO_BARRIO IN('001204','002103','003108','003109','005502','006103','006201','007206','008207','008312','008315','008418','008518','009111') AND PKMETROP < 3148.5293 AND CAI >= 45.712544 AND COL_PUB >= 165.27407 AND EDAD >= 50 AND RFREGION >= 12565.718) THEN DUMMY_SOB_2020_M04 = 4 ;
IF ( CODIGO_BARRIO IN('001204','002103','003108','003109','005502','006103','006201','007206','008207','008312','008315','008418','008518','009111') AND PKMETROP < 3148.5293 AND CAI >= 45.712544 AND COL_PUB < 165.27407) THEN DUMMY_SOB_2020_M04 = 5 ;
IF ( CODIGO_BARRIO IN('001204','002103','003108','003109','005502','006103','006201','007206','008207','008312','008315','008418','008518','009111') AND PKMETROP < 3148.5293 AND CAI < 45.712544) THEN DUMMY_SOB_2020_M04 = 6 ;
IF ( CODIGO_BARRIO IN('001204','002103','003108','003109','005502','006103','006201','007206','008207','008312','008315','008418','008518','009111') AND PKMETROP >= 3148.5293) THEN DUMMY_SOB_2020_M04 = 7 ;
IF ( CODIGO_BARRIO IN('002301','003107','004105','004106','004108','005203','005606','005614','005657','006104','007403','008201','008202','008307','008309','008417','008523','009228') AND AREA_CONSTRUIDA >= 66.88 AND PKVENCIN >= 300.693524) THEN DUMMY_SOB_2020_M04 = 8 ;
IF ( CODIGO_BARRIO IN('001301','001402','002301','003103','003107','004105','004106','004107','004108','004203','004505','004507','004511','004520','004584','005203','005509','005606','005614','005623','005657','006104','006405','006408','007403','008201','008202','008307','008309','008313','008417','008523','009228','009234') AND AREA_CONSTRUIDA < 66.88 AND PKVENCIN < 51.463132) THEN DUMMY_SOB_2020_M04 = 9 ;
IF ( CODIGO_BARRIO IN('001301','004105','004106','004505','004520','004584','005509','006104','006405','008202','008307','008309','009234') AND AREA_CONSTRUIDA < 66.88 AND PKVENCIN >= 51.463132 AND DENSIDAD >=0.047079844 AND DENSIDAD<=0.067006640) THEN DUMMY_SOB_2020_M04 = 10 ;
IF ( CODIGO_BARRIO IN('001402','003103','004203','004507','004511','005623','008313') AND AREA_CONSTRUIDA >= 66.88) THEN DUMMY_SOB_2020_M04 = 11 ;
IF ( CODIGO_BARRIO IN('001211','002533','004403','004618','005117','005401','006105','006218','008515','008517','009209') AND CLINIC123 >= 369.18611) THEN DUMMY_SOB_2020_M04 = 12 ;

IF ( CODIGO_BARRIO IN('003107','004103','004109','004111','004503','005601','005626','008108','008202','008311','008414','008512','009105') AND EST02 < 1307.5545 AND RSDJ < 8202.9155) THEN DUMMY_SUB_2020_M04 = 1 ;
IF ( CODIGO_BARRIO IN('003105','004630','006212','008306','008310','008312','009133') AND EST02 < 1307.5545 AND AREA_CONSTRUIDA < 150.66 AND PKBOLSIL < 414.31314) THEN DUMMY_SUB_2020_M04 = 2 ;
IF ( CODIGO_BARRIO IN('001204','003108','004101','006301','007101','008201','008301','008308','008412','009130') AND AREA_CONSTRUIDA < 18.00 AND EST03 >= 33.708349) THEN DUMMY_SUB_2020_M04 = 3 ;
IF ( CODIGO_BARRIO IN('003107','004103','004109','004111','004503','005601','005626','008108','008202','008311','008414','008512','009105') AND EST02 < 1307.5545 AND RSDJ >= 8202.9155 AND IN_MIL_POL < 487.79808 AND PUNTAJE >= 61) THEN DUMMY_SUB_2020_M04 = 4 ;
IF ( CODIGO_BARRIO IN('003105','004630','006212','008306','008310','008312','009133') AND EST02 < 1307.5545 AND AREA_CONSTRUIDA >= 150.66) THEN DUMMY_SUB_2020_M04 = 5 ;
IF ( CODIGO_BARRIO IN('006106','006315','008416','008502','009220','009266')) THEN DUMMY_SUB_2020_M04 = 6 ;
RUN;

proc export data=FILTRO_M04   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M04_COMER.txt'   dbms=dlm  replace;  delimiter='|';  RUN;

proc export data=FILTRO_M04_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M04_COMER_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


PROC SQL;    CREATE TABLE FILTRO_M05 AS /*M05 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
VALOR_REFERENCIA_2020,
AREA_CONSTRUIDA,
COORDENADA_Y,
USO_091,
USAQUEN,
SUBA,
SANTAFE,
SAN_CRISTOBAL,
RAFAEL_U_U,
P_ARANDA,
MARTIRES,
KENNEDY,
FONTIBON,
ENGATIVA,
BOSA,
B_UNIDOS,
CENT_CLL_72_CLL_100,
CENT_SUBA,
CENT_RESTREPO_SANT,
ZHF_1213_33,
ARMAZON_FERROCONCRETO,
CERCHA_LIVIANA,
CERCHA_MEDIANA,
DUMMY_STABARBAR,
DUMMY_SALITHAYU,
AREA_TERRENO,
PUNTAJE,
USME,
DUMMY_SOB_2020_M05,
DUMMY_SUB_2020_M05,
COMPLEMENTO_INDUSTRIA,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2020*/

FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M05');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M05_DUMMY AS /*M03 - DIFERENCIAS DUMMY*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
CODIGO_BARRIO, AREA_TERRENO, AREA_CONSTRUIDA
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M05');
QUIT;

DATA FILTRO_M05_DUMMY; SET FILTRO_M05_DUMMY;
DUMMY_SOB_2020_M05 = 0 ;
DUMMY_SUB_2020_M05 = 0 ;

IF ( CODIGO_BARRIO IN('003102','006105','006218') AND AREA_CONSTRUIDA < 409.7) THEN DUMMY_SOB_2020_M05 = 1 ;
IF ( CODIGO_BARRIO IN('002104','005637','006313','006320','006507','006521','008407','009107','009123') AND AREA_CONSTRUIDA >= 198.5) THEN DUMMY_SOB_2020_M05 = 2 ;
IF ( CODIGO_BARRIO IN('001204','002306','004105','004201','004203','004630','005201','005207','005634','006215','007102','007106','008214','008314','008417','008515','008526','009106','009116','009122','009211')) THEN DUMMY_SOB_2020_M05 = 3 ;

IF ( CODIGO_BARRIO IN('005304','005403','006212','006313','006320','007402','008101') AND AREA_CONSTRUIDA >= 308.04 AND AREA_CONSTRUIDA <=543.70) THEN DUMMY_SUB_2020_M05 = 1 ;
IF ( CODIGO_BARRIO IN('002309','002401','003201','005507','006217','008212','008415','009110','009212')) THEN DUMMY_SUB_2020_M05 = 2 ;
IF ( CODIGO_BARRIO IN('005304','005403','006212','006313','006320','007402','008101') AND AREA_CONSTRUIDA >= 9.40 AND AREA_CONSTRUIDA <= 71.30) THEN DUMMY_SUB_2020_M05 = 3 ;
IF ( CODIGO_BARRIO IN('005304','005403','006212','006313','006320','007402','008101','009115','009136') AND AREA_CONSTRUIDA < 9.40) THEN DUMMY_SUB_2020_M05 = 4 ;
RUN;


proc export data=FILTRO_M05   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M05_BODEG.txt'   dbms=dlm  replace;  delimiter='|';  RUN;
proc export data=FILTRO_M05_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M05_BODEG_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


PROC SQL;    CREATE TABLE FILTRO_M06_123 AS /*M06_123 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
ESTRATO2,
ESTRATO3,
COORDENADA_Y,
COORDENADA_X,
EDAD,
RELACION_AREA,
AREA_CONSTRUIDA,
IN_MIL_POL,
EST04,
EST05,
PKBOLSIL,
PORTALTM_200_500,
ESTACTM_200_500,
VALOR_REFERENCIA_2020,
SAN_CRISTOBAL,
TUNJUELITO,
BOSA,
KENNEDY,
FONTIBON,
ENGATIVA,
SUBA,
A_NARINO,
P_ARANDA,
ZHF_4_TRAT_DESARR,
ZHF_4_TRAT_MEJ,
AREA_ACT2,
AREA_ACT6,
ZHF_6_TOPOG_PLANA,
ZHF_10_EST_VIA_MALO,
GA1,
GA2,
GA3,
GB1,
GB2,
GB3,
GB4,
Tip7,
ZHF_1213_13,
ZHF_1213_17,
ZHF_1213_21,
ZHF_1213_22,
ZHF_1213_23,
C_BOLIVAR,
DUMMY_SOB_2020_M06_123,
DUMMY_SUB_2020_M06_123,
PUNTAJE,
RAFAEL_U_U,
USME,

VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020/*,  VALOR_AVALUO_COM_2019*/
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M06_123');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M06_123_DUMMY AS /*M03 - DIFERENCIAS DUMMY*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
CODIGO_BARRIO, COL_PUB, CLINIC123, DENSIDAD, AREA_CONSTRUIDA, COL_PRIV, EST05, EST04, URI_UPJ, PUNTAJE, UNIVERS, COORDENADA_X, EST06, ZOINFLRUID, PKBOLSIL, PKZONAL, RSDJ, CAI, RFNAL
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M06_123');
QUIT;

DATA FILTRO_M06_123_DUMMY; SET FILTRO_M06_123_DUMMY;
DUMMY_SUB_2020_M06_123=0;
DUMMY_SOB_2020_M06_123=0;

IF ( CODIGO_BARRIO IN ('001204','002311','002415','002537','002540','004402','004406','004621','005665','005670','006502') AND AREA_CONSTRUIDA >= 147.80) THEN DUMMY_SOB_2020_M06_123 = 1 ;
IF ( CODIGO_BARRIO IN ('001402','002519','002572','004204','004412','004597','009212') AND AREA_CONSTRUIDA >= 73.22) THEN DUMMY_SOB_2020_M06_123 = 2 ;
IF ( CODIGO_BARRIO IN ('001204','002311','002415','002537','002540','004402','004406','004621','005665','005670','006502') AND AREA_CONSTRUIDA < 46.25) THEN DUMMY_SOB_2020_M06_123 = 3 ;
IF ( CODIGO_BARRIO IN ('001205','001403','001423','001431','002102','002107','002536','002538','002570','002620','004108','004306','004584','004595','004617','005104','005601','005607','005627','005647','006301','006407','008502','008507','009107','009108','009224','009232','009262')) THEN DUMMY_SOB_2020_M06_123 = 4 ;

IF ( CODIGO_BARRIO IN ('002311','002555','004413','004550','004594','004633','004634','005614','005675','009206') AND 133.96442 <= COL_PUB <= 169.80281 AND AREA_CONSTRUIDA >= 57.85) THEN DUMMY_SUB_2020_M06_123 = 1 ;
IF ( CODIGO_BARRIO IN ('001111','001414','001428','002204','002409','004403','004504','004545','005620') AND COL_PUB >= 210.80479) THEN DUMMY_SUB_2020_M06_123 = 2 ;
IF ( CODIGO_BARRIO IN ('001203','001356','004401','004513','005602','005625','006410','006505','009106')) THEN DUMMY_SUB_2020_M06_123 = 3 ;
RUN;

proc export data=FILTRO_M06_123   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M06_123_BIFAM.txt'   dbms=dlm  replace;  delimiter='|';  RUN;
proc export data=FILTRO_M06_123_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M06_123_BIFAM_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


PROC SQL;    CREATE TABLE FILTRO_M06_456 AS /*M06 - DIFERENCIAS DUMMY*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
PUNTAJE,
EDAD,
IN_MIL_POL,
RELACION_AREA,
B_UNIDOS,
CHAPINERO,
COL_PUB,
CONSERVACION_I,
COORDENADA_Y,
DENSIDAD,
ZHF_1213_22,
ZHF_1213_15,
ZHF_1213_16,
ZHF_1213_13,
ZHF_10_EST_VIA_BUENO,
Tip2,
USAQUEN,
TEUSAQUILLO,
SUBA,
FONTIBON,
ZHF_1213_14,
ZHF_10_EST_VIA_REG,
DUMMY_SOB_2020_M06_456,
DUMMY_SUB_2020_M06_456,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M06_456');
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M06_456_DUMMY AS /*M03 - DIFERENCIAS DUMMY*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
CODIGO_BARRIO, AREA_CONSTRUIDA, PUNTAJE, COL_PRIV, RFREGION, IN_MIL_POL, RFNAL, PKZONAL, DENSIDAD, ZOINFLRUID, PKBOLSIL, COL_PUB, EST01, COORDENADA_X, URI_UPJ, COORDENADA_Y, EST03, RSDJ, CAI, ZHF_12_ACT_ECON_COM, ZHF_12_ACT_ECON_RES, EST02, EDAD, EST05, ZHF_1213_22, UNIVERS, CLINIC123, PKVENCIN
FROM PRUEBA.INCORRECTO_VI_MODEL 
WHERE (COMPARA_VAL_INT='INCORREC' AND LIQUIDACION = 'MODEL' AND MODELO_0 = 'M06_456');
QUIT;

DATA FILTRO_M06_456_DUMMY; SET FILTRO_M06_456_DUMMY;
DUMMY_SUB_2020_M06_456=0;
DUMMY_SOB_2020_M06_456=0;

IF ( CODIGO_BARRIO IN('005304','005401','005507','006208','008414','008415','008418','008508','008513','008519','009111','009112','009118','009124','009129') AND PKBOLSIL < 160.46471 AND COL_PUB < 1143.6857 AND RFREGION < 2978.3055) THEN DUMMY_SOB_2020_M06_456 = 1 ;
IF ( CODIGO_BARRIO IN('006201','008302','008304','008407','008417','009113','009116') AND ZHF_12_ACT_ECON_COM = 0 AND DENSIDAD < 0.0087562357 AND COL_PRIV < 306.94611) THEN DUMMY_SOB_2020_M06_456 = 2 ;
IF ( CODIGO_BARRIO IN('005304','005401','005507','006208','008414','008415','008418','008508','008513','008519','009111','009112','009118','009124','009129') AND PKBOLSIL >= 160.46471 AND EST05 < 1238.5969 AND PKVENCIN >= 198.66313 AND EDAD < 30) THEN DUMMY_SOB_2020_M06_456 = 3 ;
IF ( CODIGO_BARRIO IN('005304','005401','005507','006208','008414','008415','008418','008508','008513','008519','009111','009112','009118','009124','009129') AND PKBOLSIL >= 160.46471 AND EST05 < 1238.5969 AND PKVENCIN>= 49.48523 AND PKVENCIN <=198.66313 AND PUNTAJE < 73 AND PKZONAL < 395.46215 AND CLINIC123 >= 1022.88) THEN DUMMY_SOB_2020_M06_456 = 4 ;
IF ( CODIGO_BARRIO IN('005304','005401','005507','006208','008414','008415','008418','008508','008513','008519','009111','009112','009118','009124','009129') AND PKBOLSIL >= 160.46471 AND EST05 < 1238.5969 AND PKVENCIN < 49.48523 AND PUNTAJE < 50) THEN DUMMY_SOB_2020_M06_456 = 5 ;
IF ( CODIGO_BARRIO IN('005304','005401','005507','006208','008414','008415','008418','008508','008513','008519','009111','009112','009118','009124','009129') AND PKBOLSIL >= 160.46471 AND EST05 < 1238.5969 AND PKVENCIN >= 198.66313 AND PUNTAJE < 49 AND EDAD >= 30) THEN DUMMY_SOB_2020_M06_456 = 6 ;
IF ( CODIGO_BARRIO IN('005111','006201','006216','007104','008207','008302','008304','008407','008417','008530','009113','009116','009210','009222') AND ZHF_12_ACT_ECON_COM = 1) THEN DUMMY_SOB_2020_M06_456 = 7 ;
IF ( CODIGO_BARRIO IN('005304','005401','005507','006208','008414','008415','008418','008508','008513','008519','009111','009112','009118','009124','009129') AND PKBOLSIL < 160.46471 AND COL_PUB >= 1143.6857) THEN DUMMY_SOB_2020_M06_456 = 8 ;
IF ( CODIGO_BARRIO IN('005111','008207','009210','009222') AND ZHF_12_ACT_ECON_COM = 0 AND DENSIDAD < 0.0087562357) THEN DUMMY_SOB_2020_M06_456 = 9 ;

IF ( CODIGO_BARRIO IN('005507','005606','006312','008415','008417','008512','008514','009111','009123','009129') AND AREA_CONSTRUIDA>= 143.100 AND AREA_CONSTRUIDA<=183.450 AND DENSIDAD >= 0.0027890749 AND COL_PUB < 1564.4259 AND PKBOLSIL >= 378.76056 AND EST06 < 5388.5793 AND PKVENCIN >= 241.57514 AND CAI >= 332.43277) THEN DUMMY_SUB_2020_M06_456 = 1 ;
IF ( CODIGO_BARRIO IN('005507','005606','006312','008415','008417','008512','008514','009111','009123','009129') AND AREA_CONSTRUIDA < 410.625 AND DENSIDAD >= 0.0027890749 AND COL_PUB < 1564.4259 AND PKBOLSIL >= 378.76056 AND EST06 < 5388.5793 AND CAI < 332.43277 AND CLINIC123 < 1023.5847) THEN DUMMY_SUB_2020_M06_456 = 2 ;
IF ( CODIGO_BARRIO IN('005507','005606','006312','008415','008417','008512','008514','009111','009123','009129') AND AREA_CONSTRUIDA >= 410.625) THEN DUMMY_SUB_2020_M06_456 = 3 ;
IF ( CODIGO_BARRIO IN('005106','005401','008403','008404','008418','008510','008515','009112','009113','009116','009124') AND AREA_CONSTRUIDA >= 174.950 AND PUNTAJE < 56) THEN DUMMY_SUB_2020_M06_456 = 4 ;
IF ( CODIGO_BARRIO IN('008401','008538','009125') AND AREA_CONSTRUIDA >= 174.950) THEN DUMMY_SUB_2020_M06_456 = 5 ;
IF ( CODIGO_BARRIO IN('005106','005401','006302','008401','008403','008404','008418','008510','008515','008538','009112','009113','009116','009124','009125') AND AREA_CONSTRUIDA < 174.950 AND DENSIDAD >= 0.0027867295 AND PKVENCIN < 273.59353 AND EDAD >= 45) THEN DUMMY_SUB_2020_M06_456 = 6 ;
IF ( CODIGO_BARRIO IN('005106','005401','006302','008401','008403','008404','008418','008510','008515','008538','009112','009113','009116','009124','009125') AND AREA_CONSTRUIDA < 174.950 AND DENSIDAD >= 0.0027867295 AND PKVENCIN >= 273.59353) THEN DUMMY_SUB_2020_M06_456 = 7 ;
IF ( CODIGO_BARRIO IN('005106','005401','006302','008401','008403','008404','008418','008510','008515','008538','009112','009113','009116','009124','009125') AND AREA_CONSTRUIDA < 174.950 AND DENSIDAD < 0.0027867295) THEN DUMMY_SUB_2020_M06_456 = 8 ;

RUN;


proc export data=FILTRO_M06_456   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M06_456_BIFAM.txt'   dbms=dlm  replace;  delimiter='|';  RUN;
proc export data=FILTRO_M06_456_DUMMY   outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\DIFRENCIAS VALORES MODELOS PH\DIF_M06_456_BIFAM_DUMMY.txt'   dbms=dlm  replace;  delimiter='|';  RUN;


/*-------------------------------------------------------------------------------------------------------------------------------------
											RESUMEN DIFERENCIAS
/*-------------------------------------------------------------------------------------------------------------------------------------*/

/*-------------------------------------------------------------------------------------------------------------------------------------
											RESUMEN DIFERENCIAS
/*-------------------------------------------------------------------------------------------------------------------------------------*/
PROC SQL;  CREATE TABLE NRO_MODELO AS SELECT  /*CANTIDAD DE PREDIOS BASE PREDIAL URBANA X MODELO*/
LIQUIDACION, NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS
FROM COMUN.PREDIO_Y_UM_FINAL_&FECHA_CORTE. 
/*FROM PRUEBA.PREDIO_VISTA_2020_MODELOS*/
WHERE (ID_UR_RU IN ('0') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY LIQUIDACION, NOMBRE_MODELO_0;
QUIT;


PROC SQL;  CREATE TABLE NRO_MODELO_ACT AS SELECT  /*CANTIDAD DE PREDIOS "ACTUALIZADOS" BASE PREDIAL URBANA X MODELO*/
LIQUIDACION, NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS
FROM PRUEBA.VISTA_MODELO_UNID_LIQ_ACTUALI 
WHERE (ID_UR_RU IN ('0') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY LIQUIDACION, NOMBRE_MODELO_0;
QUIT;

PROC SQL;	CREATE TABLE RES_PREDIOS_DIFER_MODEL_0  AS
		SELECT A.*, B.N_PREDIOS AS PREDIOS_ACTUALIZADOS
				FROM NRO_MODELO AS A LEFT JOIN NRO_MODELO_ACT AS B  
				ON	A.NOMBRE_MODELO_0 = B.NOMBRE_MODELO_0;
QUIT;

PROC SQL;  CREATE TABLE NRO_MODELO_COMUN AS SELECT  /*CANTIDAD DE PREDIOS "ACTUALIZADOS" BASE PREDIAL URBANA X MODELO*/
LIQUIDACION, NOMBRE_MODELO_0, COUNT(distinct llave) AS N_PREDIOS
FROM PRUEBA.MODELOSIS_VACIOS 
WHERE (ID_UR_RU IN ('0') /*AND  UNIDAD_LIQUIDACION IN (1)*/)
GROUP BY LIQUIDACION, NOMBRE_MODELO_0;
QUIT;

PROC SQL;	CREATE TABLE RES_PREDIOS_DIFER_MODEL_1  AS
		SELECT A.*, B.N_PREDIOS AS PREDIOS_COMPARADOS_SIS_EST
FROM RES_PREDIOS_DIFER_MODEL_0 AS A LEFT JOIN NRO_MODELO_COMUN AS B  
				ON	A.NOMBRE_MODELO_0 = B.NOMBRE_MODELO_0;
QUIT;


/* RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO*/
PROC SQL; CREATE TABLE NRO_VAR_MODELO_DIFERENCIAS AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO*/
NOMBRE_MODELO_0, COUNT(DISTINCT LLAVE) AS N_PREDIOS
FROM INCORRECTO_MODELO 
/*WHERE (/*ID_UR_RU IN ('0') AND*/  /*FASE_EST IN (1))*/
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL;	CREATE TABLE RES_PREDIOS_DIFER_MODEL  AS
		SELECT A.*, B.N_PREDIOS AS DIFERENCIA_VARIABLE_MODELO
				FROM RES_PREDIOS_DIFER_MODEL_1 AS A LEFT JOIN NRO_VAR_MODELO_DIFERENCIAS AS B  
				ON	A.NOMBRE_MODELO_0 = B.NOMBRE_MODELO_0;
QUIT;



/*  RESUMEN PREDIOS DIFERENCIAS VALORES TABLA NPH*/
PROC SQL; CREATE TABLE NRO_TABLA_DIFERENCIAS AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALORES TABLA NPH*/
NOMBRE_MODELO_0, COUNT(DISTINCT LLAVE) AS N_PREDIOS
FROM INCORRECTO_VR_TABL_NPH 
/*WHERE (/*ID_UR_RU IN ('0') AND*/  /*FASE_EST IN (1))*/
GROUP BY NOMBRE_MODELO_0;
QUIT;


PROC SQL; CREATE TABLE NRO_AVES_DIFERENCIAS AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALORES TABLA NPH*/
NOMBRE_MODELO_0, COUNT(DISTINCT LLAVE) AS N_PREDIOS
FROM INCORRECTO_AVES
/*WHERE (/*ID_UR_RU IN ('0') AND*/  /*FASE_EST IN (1))*/
GROUP BY NOMBRE_MODELO_0;
QUIT;



DATA NRO_TABLA_DIFERENCIAS; SET NRO_TABLA_DIFERENCIAS NRO_AVES_DIFERENCIAS; RUN;

/*  RESUMEN PREDIOS DIFERENCIAS VALOR INTEGRAL PH*/
PROC SQL; CREATE TABLE NRO_VIMODELO_DIFERENCIAS AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALOR INTEGRAL MODELO PH*/
NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS
FROM  PRUEBA.INCORRECTO_VI_MODEL
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_VI_T23DEPOSPH_DIFERENCIAS AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALOR INTEGRAL T23 DEPOSITO TABLA PH*/
NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS
FROM  INCORRECTO_VI_DEPOSITOS
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_VI_T21T22PARQPH_DIFERENCIAS AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALORE INTEGRAL T21 Y T22 PARQUEADERO PH*/
NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS
FROM  INCORRECTO_T21T22_PARQ_VI
GROUP BY NOMBRE_MODELO_0;
QUIT;

DATA TDIFERENCIAS_VI; /*CONSOLIDADO DIFERENCIA VALOR INTEGRAL*/
SET NRO_VIMODELO_DIFERENCIAS NRO_VI_T23DEPOSPH_DIFERENCIAS NRO_VI_T21T22PARQPH_DIFERENCIAS; RUN;


PROC SQL;	CREATE TABLE RESUMEN_PREDIOS_DIF1  AS
		SELECT A.*, B.N_PREDIOS AS DIFERENCIA_VALOR_TABLA
				FROM RES_PREDIOS_DIFER_MODEL AS A LEFT JOIN NRO_TABLA_DIFERENCIAS AS B  
				ON	A.NOMBRE_MODELO_0 = B.NOMBRE_MODELO_0;
QUIT;

PROC SQL;	CREATE TABLE RESUMEN_PREDIOS_DIF2  AS
		SELECT A.*, B.N_PREDIOS AS DIFERENCIA_VALOR_INTEGRAL
				FROM RESUMEN_PREDIOS_DIF1 AS A LEFT JOIN TDIFERENCIAS_VI  AS B  
				ON	A.NOMBRE_MODELO_0 = B.NOMBRE_MODELO_0
ORDER BY LIQUIDACION, NOMBRE_MODELO_0;
QUIT;


/*********************************************************************
RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO===>  USOS MULTIPLES
**********************************************************************/

PROC SQL; CREATE TABLE NRO_MODELO_UM AS SELECT
LIQUIDACION, MODELO_USO, COUNT(*) AS N_UNIDADESC
FROM COMUN.PREDIO_Y_UM_FINAL_&FECHA_CORTE. /*PRUEBA.PREDIO_VISTA_2020_MODELOS*/ 
WHERE (ID_UR_RU IN ('0') AND  NOMBRE_MODELO_0 IN('Usos Múltiples'))
GROUP BY LIQUIDACION, MODELO_USO;
QUIT;

PROC SQL; CREATE TABLE NRO_VAR_MODELO_DIFERENCIAS_UM AS SELECT
MODELO_USO, COUNT(*) AS N_UNIDADESC
FROM INCORRECTO_MODELO
WHERE (NOMBRE_MODELO_0 IN('Usos Múltiples') )
GROUP BY MODELO_USO;
QUIT;

PROC SQL;	CREATE TABLE RES_UNIDADES_DIFERENCIAS_UM  AS
		SELECT A.*, B.N_UNIDADESC AS DIFERENCIA_VAR_MODELO
				FROM NRO_MODELO_UM AS A LEFT JOIN NRO_VAR_MODELO_DIFERENCIAS_UM AS B  
				ON	A.MODELO_USO = B.MODELO_USO;
QUIT;


/*  RESUMEN PREDIOS DIFERENCIAS VALORES TABLA*/
PROC SQL;
CREATE TABLE NRO_TABLA_DIFERENCIAS_UM AS SELECT
MODELO_APLICADO_EST, COUNT(*) AS N_UNIDADESC
FROM INCORRECTO_VR_TABL_NPH 
WHERE (NOMBRE_MODELO_0 IN('Usos Múltiples') )
GROUP BY MODELO_APLICADO_EST;
QUIT;

PROC SQL;	CREATE TABLE RESUMEN_DIFERENCIAS_UM  AS
		SELECT A.*, B.N_UNIDADESC AS DIFERENCIA_VALOR_TABLA
				FROM RES_UNIDADES_DIFERENCIAS_UM  AS A LEFT JOIN NRO_TABLA_DIFERENCIAS_UM AS B  
				ON	A.MODELO_USO = B.MODELO_APLICADO_EST;
QUIT;

PROC EXPORT DATA= RESUMEN_PREDIOS_DIF2 
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\RESUMEN_DIFERENCIAS.xlsx" 
			dbms=xlsx replace;
			sheet="Resumen Diferencia Predios";
			RUN;

PROC EXPORT DATA= RESUMEN_DIFERENCIAS_UM
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\RESUMEN_DIFERENCIAS.xlsx" 
			dbms=xlsx replace;
			sheet="Diferencia Uso Multiples-UNCal";
			RUN;

PROC EXPORT DATA= INCORRECTO_MODELO
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\BD_DIFERENCIAS_VARIABLE_MODELO.xlsx" 
			dbms=xlsx replace;
			sheet="Diferencia Uso Multiples-UNCal";
			RUN;
/*************************************************************
  TABLA VALORES TERRENO:

  COMPARACIÓN VALORES COMERCIALES Y CATASTRALES A NIVEL PREDIO 
***************************************************************/

PROC SQL; CREATE TABLE PRUEBA.PREDIOS_AVALUO_SIIC AS SELECT * FROM ODBCLIB.VALORES_TERRENO 
WHERE VIGENCIA=2020;
QUIT; 

DATA PREDIO_FINAL_&FECHA_CORTE.; SET COMUN.PREDIO_Y_UM_FINAL_&FECHA_CORTE.; IF UNIDAD_LIQUIDACION =1; 
IF VALOR_AVALUO_COM_2020 = . THEN VALOR_AVALUO_COM_2020 = 0;
IF VALOR_M2_CONSTRUCCION_2020 = . THEN VALOR_M2_CONSTRUCCION_2020 = 0;
IF VALOR_M2_TERRENO_COR_20 = . THEN VALOR_M2_TERRENO_COR_20 = 0;
IF VALOR_AVALUO_CAT = . THEN VALOR_AVALUO_CAT = 0;
IF VALOR_M2_CONSTRUCCION_CAT_2020 = . THEN VALOR_M2_CONSTRUCCION_CAT_2020 = 0;
IF VALOR_M2_TERRENO_CAT_2020 = . THEN VALOR_M2_TERRENO_CAT_2020 = 0;
RUN;

PROC SQL; CREATE TABLE AVALUO_SIS_EST2  AS /* TABLA VALORES_TERRENO*/
		SELECT A.*, B.MODELO_USO, B.NOMBRE_MODELO_0, B.UNIDAD_LIQUIDACION, B.ID_UR_RU
		FROM  PRUEBA.PREDIOS_AVALUO_SIIC AS A LEFT JOIN PREDIO_FINAL_&FECHA_CORTE. AS B
				ON A.CODIGO_BARRIO =B.CODIGO_BARRIO &
				   A.CODIGO_MANZANA=B.CODIGO_MANZANA &
				   A.CODIGO_PREDIO=B.CODIGO_PREDIO &
				   A.CODIGO_CONSTRUCCION=B.CODIGO_CONSTRUCCION &
				   A.CODIGO_RESTO=B.CODIGO_RESTO;
QUIT;


PROC SQL; CREATE TABLE AVALUO_SIS_EST  AS /* TABLA VALORES_TERRENO*/
		SELECT A.CHIP, A.CODIGO_BARRIO,A.CODIGO_MANZANA, A.CODIGO_PREDIO, A.CODIGO_CONSTRUCCION, A.CODIGO_RESTO, A.MODELO_0,
		A.NOMBRE_MODELO_0, A.MODELO_USO, A.UNIDAD_LIQUIDACION, A.ID_UR_RU,
	   
A.VALOR_UNITARIO_2020,
A.VALOR_UNITARIO_AVESP_2020,
A.VALOR_INTEGRAL_2020, A.PRODUCTO_&VIGENCIA.,

B.AREA_TERR_SIIC, A.AREA_TERRENO,  B.AREA_TERR_TRAN,
B.AREA_CONS_SIIC, A.AREA_CONSTRUIDA, B.AREA_CONS_TRAN,

B.AVLO_TOTL_SIIC, A.VALOR_AVALUO_COM_2020,  B.AVLO_TOTL_TRAN,

CASE /*WHEN ABS((AVLO_TOTL_TRAN/AREA_CONS_TRAN)-(VALOR_AVALUO_COM_2020/AREA_CONSTRUIDA))<5000 THEN 'CORRECTO'*/
	 WHEN (MODELO_0 IN ('M01_1', 'M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6', 'M03', 'M04', 'M05', 'M06_123',  'M06_456') AND ABS((AVLO_TOTL_TRAN/AREA_CONS_TRAN)-(VALOR_AVALUO_COM_2020/AREA_CONSTRUIDA))<5000) THEN 'CORRECTO'
	 WHEN (MODELO_0 IN ('M01_1', 'M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6', 'M03', 'M04', 'M05', 'M06_123',  'M06_456') AND (ABS(A.VALOR_AVALUO_COM_2020-B.AVLO_TOTL_TRAN)) < 50000) THEN 'CORRECTO' 
     WHEN (MODELO_0 NOT IN ('M01_1', 'M01_2', 'M01_3', 'M02_4', 'M02_5', 'M02_6', 'M03', 'M04', 'M05', 'M06_123',  'M06_456') AND (ABS(A.VALOR_AVALUO_COM_2020-B.AVLO_TOTL_TRAN)) < 50000) THEN 'CORRECTO' ELSE 'INCORREC' END AS DIF_AVCOM,

A.VALOR_M2_CONSTRUCCION_2020, B.VALR_CONS_TRAN,
CASE  WHEN (ABS(A.VALOR_M2_CONSTRUCCION_2020-B.VALR_CONS_TRAN)) < 5000 THEN 'CORRECTO' ELSE 'INCORREC' END AS DIF_VRM2CONSCOM,

A.VALOR_M2_TERRENO_COR_20, B.VALR_TERR_TRAN,
CASE  WHEN (ABS(A.VALOR_M2_TERRENO_COR_20-B.VALR_TERR_TRAN)) < 1 THEN 'CORRECTO' ELSE 'INCORREC' END AS DIF_VRM2TERRCOR,

A.VALOR_AVALUO_CAT, B.AVLO_TOTL_PORC, 
CASE  WHEN (ABS(A.VALOR_AVALUO_CAT-B.AVLO_TOTL_PORC)) < 50000 THEN 'CORRECTO' ELSE 'INCORREC' END AS DIF_AVCAT,
	
A.VALOR_M2_CONSTRUCCION_CAT_2020, B.VALR_CONS_PORC,
CASE  WHEN (ABS(A.VALOR_M2_CONSTRUCCION_CAT_2020-B.VALR_CONS_PORC)) < 5000 THEN 'CORRECTO' ELSE 'INCORREC' END AS DIF_VRM2CONSCAT,

A.VALOR_M2_TERRENO_CAT_2020, B.VALR_TERR_PORC,
CASE   WHEN (ABS(A.VALOR_M2_TERRENO_CAT_2020-B.VALR_TERR_PORC)) < 1 THEN 'CORRECTO' ELSE 'INCORREC' END AS DIF_VRM2TERRCAT,

B.FECHA_CORRIDA

			FROM PREDIO_FINAL_&FECHA_CORTE. AS A LEFT JOIN PRUEBA.PREDIOS_AVALUO_SIIC AS B
				ON A.CODIGO_BARRIO =B.CODIGO_BARRIO &
				   A.CODIGO_MANZANA=B.CODIGO_MANZANA &
				   A.CODIGO_PREDIO=B.CODIGO_PREDIO &
				   A.CODIGO_CONSTRUCCION=B.CODIGO_CONSTRUCCION &
				   A.CODIGO_RESTO=B.CODIGO_RESTO;
QUIT; 

PROC SQL; CREATE TABLE NROTOT_PREDIOS_X_MODELO AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO*/
NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS
FROM AVALUO_SIS_EST 
WHERE (/*ID_UR_RU IN ('0') AND*/    UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NROTOT_PREDIOS_URB AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO*/
NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS_URB
FROM AVALUO_SIS_EST 
WHERE (ID_UR_RU IN ('0') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_PRED_TAB_TERREN AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO*/
NOMBRE_MODELO_0, COUNT(*) AS N_TAB_TERRENO_SIS
FROM AVALUO_SIS_EST2 
/*WHERE (/*ID_UR_RU IN ('0') AND   UNIDAD_LIQUIDACION IN (1))*/
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_VALORESAV_DIFERENCIAS1 AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS AVALUO COMERCIAL*/
NOMBRE_MODELO_0, COUNT(*) AS N_DIF_AVCOM
FROM AVALUO_SIS_EST
WHERE (/*ID_UR_RU IN ('0') AND*/  DIF_AVCOM IN ('INCORREC') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_VALORESAV_DIFERENCIAS2 AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALOR M2 DE LA CONSTRUCCION COMERCIAL*/
NOMBRE_MODELO_0, COUNT(*) AS N_DIF_VRM2CONSCOM
FROM AVALUO_SIS_EST
WHERE (/*ID_UR_RU IN ('0') AND*/  DIF_VRM2CONSCOM IN ('INCORREC') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_VALORESAV_DIFERENCIAS3 AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALOR M2 TERRENO CORREGIDO COMERCIAL */
NOMBRE_MODELO_0, COUNT(*) AS N_DIF_VRM2TERRCOR
FROM AVALUO_SIS_EST
WHERE (/*ID_UR_RU IN ('0') AND*/  DIF_VRM2TERRCOR IN ('INCORREC') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_VALORESAV_DIFERENCIAS4 AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS AVALUO CATASTRAL*/
NOMBRE_MODELO_0, COUNT(*) AS N_DIF_AVCAT
FROM AVALUO_SIS_EST
WHERE (/*ID_UR_RU IN ('0') AND*/  DIF_AVCAT IN ('INCORREC') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_VALORESAV_DIFERENCIAS5 AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALOR M2 DE LA CONSTRUCCION CATASTRAL*/
NOMBRE_MODELO_0, COUNT(*) AS N_DIF_VRM2CONSCAT
FROM AVALUO_SIS_EST
WHERE (/*ID_UR_RU IN ('0') AND*/  DIF_VRM2CONSCAT IN ('INCORREC') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_VALORESAV_DIFERENCIAS6 AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VALOR M2 TERRENO CATASTRAL */
NOMBRE_MODELO_0, COUNT(*) AS N_DIF_VRM2TERRCAT
FROM AVALUO_SIS_EST
WHERE (/*ID_UR_RU IN ('0') AND*/  DIF_VRM2TERRCAT IN ('INCORREC') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;





DATA PRUEBA.DIF_TABLA_VALORES_TERRENO;
MERGE NROTOT_PREDIOS_X_MODELO (IN=A0) NROTOT_PREDIOS_URB (IN=A1) NRO_PRED_TAB_TERREN (IN=A2) NRO_VALORESAV_DIFERENCIAS1 (IN=A3) NRO_VALORESAV_DIFERENCIAS2 (IN=A4) NRO_VALORESAV_DIFERENCIAS3 (IN=A5)
NRO_VALORESAV_DIFERENCIAS4 (IN=A6) NRO_VALORESAV_DIFERENCIAS5 (IN=A7) NRO_VALORESAV_DIFERENCIAS6 (IN=A8);
BY NOMBRE_MODELO_0;  RUN;

PROC EXPORT DATA= PRUEBA.DIF_TABLA_VALORES_TERRENO
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\RESUMEN_DIFERENCIAS_TABLA_VALORES_TERRENO.xlsx" 
			dbms=xlsx replace;
			sheet="Diferencia Valores Terreno";
			RUN;

PROC SQL; CREATE TABLE BASE_DIF_VALORESTERR AS SELECT  /* BASE PREDIOS CON DIFERENCIAS AVALUO COMERCIAL*/
CHIP, CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, MODELO_0, NOMBRE_MODELO_0,  
VALOR_AVALUO_COM_2020, AVLO_TOTL_TRAN, DIF_AVCOM,
VALOR_M2_CONSTRUCCION_2020, VALR_CONS_TRAN, DIF_VRM2CONSCOM, 
VALOR_M2_TERRENO_COR_20, VALR_TERR_TRAN, DIF_VRM2TERRCOR,
VALOR_AVALUO_CAT, AVLO_TOTL_PORC, DIF_AVCAT,
VALOR_M2_CONSTRUCCION_CAT_2020, VALR_CONS_PORC, DIF_VRM2CONSCAT,
VALOR_M2_TERRENO_CAT_2020, VALR_TERR_PORC, DIF_VRM2TERRCAT
FROM AVALUO_SIS_EST
WHERE (DIF_AVCOM IN ('INCORREC') or DIF_VRM2CONSCOM IN ('INCORREC') or DIF_VRM2TERRCOR IN ('INCORREC') or DIF_AVCAT IN ('INCORREC') 
       or DIF_VRM2CONSCAT IN ('INCORREC') or  DIF_VRM2TERRCAT IN ('INCORREC') );
QUIT;

proc export data=BASE_DIF_VALORESTERR outfile='\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\BASE_DIF_VALORESTERR.txt'   dbms=dlm  replace;  delimiter='|';  
RUN;

PROC EXPORT DATA= BASE_DIF_VALORESTERR  
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\BASE_DIF_VALORESTERR.xlsx" 
			dbms=xlsx replace;
			sheet="Resumen Diferencia";
			RUN;



PROC SQL; CREATE TABLE NROTOT_PREDIOS_X_MODELO AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO*/
NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS
FROM AVALUO_SIS_EST 
WHERE (/*ID_UR_RU IN ('0') AND*/    UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NROTOT_PREDIOS_URB AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO*/
NOMBRE_MODELO_0, COUNT(*) AS N_PREDIOS_URB
FROM AVALUO_SIS_EST 
WHERE (ID_UR_RU IN ('0') AND  UNIDAD_LIQUIDACION IN (1))
GROUP BY NOMBRE_MODELO_0;
QUIT;

PROC SQL; CREATE TABLE NRO_PRED_TAB_TERREN AS SELECT  /* RESUMEN PREDIOS CON DIFERENCIAS VARIABLE MODELO*/
NOMBRE_MODELO_0, COUNT(*) AS N_TAB_TERRENO_SIS
FROM AVALUO_SIS_EST2 
/*WHERE (/*ID_UR_RU IN ('0') AND   UNIDAD_LIQUIDACION IN (1))*/
GROUP BY NOMBRE_MODELO_0;
QUIT;



PROC SQL;    CREATE TABLE t2 AS 
   SELECT t1.* 
         FROM /*prueba.PREDIO_VISTA_2018_PRODUC_USOP_MZ PREDIOS_MODELO VISTA_NUEVO_MODELO*/PRUEBA.BD_PREDIOS_MAS_USOMU_V3/*VISTA_NUEVO_MODELO_A*/ t1
      WHERE t1.CODIGO_BARRIO = '002453' AND t1.CODIGO_MANZANA = '01' AND t1.CODIGO_PREDIO = '01' AND 
           t1.CODIGO_CONSTRUCCION = '000' AND CODIGO_RESTO = '00009';
QUIT;

PROC SQL;   CREATE TABLE t3 AS 
   SELECT t1.* 
         FROM /*prueba.PREDIO_VISTA_2018_PRODUC_USOP_MZ PREDIOS_MODELO VISTA_NUEVO_MODELO*/PRUEBA.BD_PREDIOS_MAS_USOMU_V3/*VISTA_NUEVO_MODELO_A*/ t1
      WHERE t1.CODIGO_BARRIO = '001315' AND t1.CODIGO_MANZANA = '19' AND t1.CODIGO_PREDIO = '01' AND 
           t1.CODIGO_CONSTRUCCION = '000' AND CODIGO_RESTO = '00000';
QUIT;

PROC SQL;    CREATE TABLE t4 AS 
   SELECT t1.* 
         FROM /*prueba.PREDIO_VISTA_2018_PRODUC_USOP_MZ PREDIOS_MODELO VISTA_NUEVO_MODELO*/COMUN.PREDIO_Y_UM_FINAL_181217/*VISTA_NUEVO_MODELO_A*/ t1
      WHERE t1.CODIGO_BARRIO = '001315' AND t1.CODIGO_MANZANA = '19' AND t1.CODIGO_PREDIO = '01' AND 
           t1.CODIGO_CONSTRUCCION = '000' AND CODIGO_RESTO = '00000';
QUIT;



PROC SQL;	CREATE TABLE t2 AS 
   SELECT t1.* 
         FROM /*prueba.PREDIO_VISTA_2018_PRODUC_USOP_MZ PREDIOS_MODELO VISTA_NUEVO_MODELO*/ PRUEBA.AVALUOS_ESPECIALES_OR_2019/*VISTA_NUEVO_MODELO_A*/ t1
      WHERE t1.CODIGO_BARRIO = '002508' AND t1.CODIGO_MANZANA = '26' AND t1.CODIGO_PREDIO = '18' AND 
           t1.CODIGO_CONSTRUCCION = '000' AND CODIGO_RESTO = '00000';
QUIT;

PROC SQL;    CREATE TABLE FILTRO_M05_SISEST AS /*M05 - DIFERENCIAS*/
   SELECT CODIGO_BARRIO, CODIGO_MANZANA, CODIGO_PREDIO, CODIGO_CONSTRUCCION, CODIGO_RESTO, UNIDAD_CALIFICADA, CODIGO_USO, MODELO_0,
VALOR_REFERENCIA_2020,
AREA_CONSTRUIDA,
COORDENADA_Y,
USO_091,
USAQUEN,
SUBA,
SANTAFE,
SAN_CRISTOBAL,
RAFAEL_U_U,
P_ARANDA,
MARTIRES,
KENNEDY,
FONTIBON,
ENGATIVA,
BOSA,
B_UNIDOS,
CENT_CLL_72_CLL_100,
CENT_SUBA,
CENT_RESTREPO_SANT,
ZHF_1213_33,
ARMAZON_FERROCONCRETO,
DUMMY_STABARBAR,
DUMMY_SALITHAYU,
AREA_TERRENO,
PUNTAJE,
USME,
DUMMY_SOB_2020_M05,
DUMMY_SUB_2020_M05,
VALOR_INTEGRAL_SIS, VALOR_INTEGRAL_2020,/*,  VALOR_AVALUO_COM_2020*/
COMPLEMENTO_INDUSTRIA,
CERCHA_LIVIANA,
CERCHA_MEDIANA
FROM PRUEBA.MODELOSIS_VACIOS 
WHERE (MODELO_0 = 'M05');
QUIT;


DATA /*M05. Bodegas + Industria PH*/ t1; set FILTRO_M05_COMUN;
 
/*IF MODELO_0='M05';*/

CERCHA_LIVIANA =0;
CERCHA_MEDIANA =0;
CERCHA_PESADA =0;
IF COMPLEMENTO_INDUSTRIA IN ('514') AND 0<AREA_CONSTRUIDA <= 10000 THEN CERCHA_MEDIANA =1;ELSE DO;
IF COMPLEMENTO_INDUSTRIA NOT IN ('514') AND 0<AREA_CONSTRUIDA <= 1000 THEN CERCHA_LIVIANA =1;ELSE DO;
IF COMPLEMENTO_INDUSTRIA IN ('000','') AND   AREA_CONSTRUIDA > 10000  THEN CERCHA_PESADA =1;ELSE DO;
IF COMPLEMENTO_INDUSTRIA IN ('000','') AND 0<AREA_CONSTRUIDA <= 10000 THEN CERCHA_LIVIANA =1;ELSE DO;
IF COMPLEMENTO_INDUSTRIA IN ('511','512') THEN CERCHA_LIVIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('513') AND   AREA_CONSTRUIDA > 10000 THEN CERCHA_MEDIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('514','515') AND AREA_CONSTRUIDA > 10000 THEN CERCHA_PESADA =1;
END; END; END; END;

CERCHA_LIVIANA =0;
CERCHA_MEDIANA =0;
CERCHA_PESADA =0;
IF COMPLEMENTO_INDUSTRIA IN ('514') AND 0<AREA_CONSTRUIDA <= 10000 THEN CERCHA_MEDIANA =1;
IF COMPLEMENTO_INDUSTRIA NOT IN ('514') AND 0<AREA_CONSTRUIDA <= 1000 THEN CERCHA_LIVIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('000','') AND   AREA_CONSTRUIDA > 10000  THEN CERCHA_PESADA =1;
IF COMPLEMENTO_INDUSTRIA IN ('000','') AND 0<AREA_CONSTRUIDA <= 10000 THEN CERCHA_LIVIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('511','512') THEN CERCHA_LIVIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('513') AND   AREA_CONSTRUIDA > 10000 THEN CERCHA_MEDIANA =1;
IF COMPLEMENTO_INDUSTRIA IN ('514','515') AND AREA_CONSTRUIDA > 10000 THEN CERCHA_PESADA =1;

RUN;




DATA mejora; set EGTASK.FILTER_FOR_PREDIO_Y_UM_FINAL_191;  
IF VALOR_M2_CONSTRUCCION_2020 = 0 THEN VALOR_M2_CONSTRUCCION_2020=.;
IF VALOR_AVALUO_COM_2020 = 0 THEN VALOR_AVALUO_COM_2020 =.;
RUN;

PROC EXPORT DATA= EGTASK.FILTER_FOR_PREDIO_Y_UM_FINAL_191
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\MEJORAS_191111.xlsx" 
			dbms=xlsx replace;
			sheet="MEJORAS";
			RUN;


%LET _CLIENTTASKFILTER = UNIDAD_LIQUIDACION = 1;
TITLE;
TITLE1 "Tablas de sumarización";
FOOTNOTE;
FOOTNOTE1 "Generado por el Sistema SAS (&_SASSERVERNAME, &SYSSCPL) el %TRIM(%QSYSFUNC(DATE(), NLDATE20.)) a las %TRIM(%SYSFUNC(TIME(), TIMEAMPM12.))";
/* -------------------------------------------------------------------
   Código generado por una Tarea SAS

   Generado el: miércoles, 13 de noviembre de 2019 a las 11:04:15
   Por la tarea: Tablas de sumarización (2)

   Datos de entrada: SASApp:EGTASK.FILTER_FOR_PREDIO_Y_UM_FINAL_191
   Servidor:  SASApp
   ------------------------------------------------------------------- */


/* -------------------------------------------------------------------
   Ejecutar el procedimiento tabulate
   ------------------------------------------------------------------- */
PROC TABULATE
DATA=MEJORA
	
	;
	WHERE( UNIDAD_LIQUIDACION = 1);
	
	VAR VALOR_M2_CONSTRUCCION_2020 VALOR_AVALUO_COM_2020;
	CLASS PRED_URB /	ORDER=UNFORMATTED MISSING;
	CLASS MODELO_0 /	ORDER=UNFORMATTED MISSING;
	CLASS NOMBRE_MODELO_0 /	ORDER=UNFORMATTED MISSING;
	TABLE /* Dimensión de la fila */
MODELO_0*
  NOMBRE_MODELO_0,
/* Dimensión de la columna */
PRED_URB*(
  VALOR_M2_CONSTRUCCION_2020*(
    N 
    NMiss) 
  VALOR_AVALUO_COM_2020*(
    N 
    NMiss)) 		;
	;

RUN;
/* -------------------------------------------------------------------
   Fin de código de la tarea
   ------------------------------------------------------------------- */
RUN; QUIT;
TITLE; FOOTNOTE;
%SYMDEL _CLIENTTASKFILTER;


PROC SQL;
   CREATE TABLE EGTASK.FILTER_FOR_PREDIO_Y_UM_FINA AS 
   SELECT t1.CHIP, 
          t1.CODIGO_LOCALIDAD, 
          t1.NOMBRE_BARRIO, 
          t1.CODIGO_BARRIO, 
          t1.CODIGO_MANZANA, 
          t1.CODIGO_PREDIO, 
          t1.CODIGO_CONSTRUCCION, 
          t1.CODIGO_RESTO, 
          t1.AREA_TERRENO, 
          t1.AREA_CONSTRUIDA, 
          t1.ZHF_2020, 
          t1.VALOR_M2_CONSTRUCCION_2020, 
          t1.VALOR_AVALUO_COM_2020, 
          t1.MODELO_0, 
          t1.NOMBRE_MODELO_0, 
          t1.CODIGO_DESTINO, 
          t1.EDAD, 
          t1.PUNTAJE, 
          t1.ACTUALIZADO,
		  t1.VALOR_REFERENCIA_2020,
		  t1.VALOR_M2_TERRENO_COR_20
      FROM COMUN.PREDIO_Y_UM_FINAL_191115 t1
      WHERE t1.ACTUALIZADO = 1 AND t1.UNIDAD_LIQUIDACION = 1 AND t1.PRED_RUR=1;
QUIT;


DATA FILTRO_rural; SET COMUN.PREDIO_Y_UM_FINAL_191204;
IF PRED_RUR IN (1);
/*DROP AVALUO_TOTAL_PUNTUAL_COM_2019 VALOR_INTEGRAL_COM_2019;*/
KEEP CHIP	CODIGO_LOCALIDAD	NOMBRE_BARRIO	CODIGO_BARRIO	CODIGO_MANZANA	CODIGO_PREDIO	CODIGO_CONSTRUCCION	CODIGO_RESTO	
AREA_TERRENO	AREA_CONSTRUIDA	ZHF_2020	VALOR_M2_CONSTRUCCION_2020	VALOR_AVALUO_COM_2020	MODELO_0	NOMBRE_MODELO_0	CODIGO_DESTINO	EDAD	
PUNTAJE	ACTUALIZADO;
RUN;


PROC SQL; CREATE TABLE CONSULTA_RURAL /*PEGADO INFORMACION 2018 PARA COMPARACION Y VARIACIONES*/
AS SELECT A.*, B.AVALUO_TOTAL_PUNTUAL_COM_2019, B.VALOR_INTEGRAL_COM_2019, B.VALOR_M2_CONS_COM_2019, B.VALOR_M2_TERRENO_COM_2019, B.VALOR_M2_CONS_COM_2019
FROM FILTRO_rural AS A LEFT JOIN PRUEBA.PREDIO_FINAL_2019 AS B ON
cat(A.CODIGO_BARRIO,A.CODIGO_MANZANA,A.CODIGO_PREDIO,A.CODIGO_CONSTRUCCION,A.CODIGO_RESTO) =
cat(B.CODIGO_BARRIO,B.CODIGO_MANZANA,B.CODIGO_PREDIO,B.CODIGO_CONSTRUCCION,B.CODIGO_RESTO);
QUIT;

PROC SQL; CREATE TABLE CONSULTA_RURAL2 /*PEGADO INFORMACION 2018 PARA COMPARACION Y VARIACIONES*/
AS SELECT A.*, B.AVALUO_TOTAL_PUNTUAL_COM_2019 AS AVALUO_TOTAL_PUNTUAL_COM_2019_C, /*B.VALOR_INTEGRAL_COM_2019 AS VALOR_INTEGRAL_COM_2019_C, */
B.VALOR_M2_CONS_COM_2019 AS VALOR_M2_CONS_COM_2019_C
FROM CONSULTA_RURAL AS A LEFT JOIN PRUEBA.PREDIO_FINAL_2019 AS B ON
A.CHIP = B.CHIP;
QUIT;

DATA CONSULTA_RURAL3; SET CONSULTA_RURAL2;
variacion_com = (VALOR_AVALUO_COM_2020 - AVALUO_TOTAL_PUNTUAL_COM_2019) /AVALUO_TOTAL_PUNTUAL_COM_2019;
variacion_vconst_com = (VALOR_M2_CONSTRUCCION_2020 -VALOR_M2_CONS_COM_2019) /VALOR_M2_CONS_COM_2019;

variacion_com_CHIP = (VALOR_AVALUO_COM_2020 - AVALUO_TOTAL_PUNTUAL_COM_2019_C) /AVALUO_TOTAL_PUNTUAL_COM_2019_C;
variacion_vconst_com_CHIP = (VALOR_M2_CONSTRUCCION_2020 -VALOR_M2_CONS_COM_2019_C) /VALOR_M2_CONS_COM_2019_C;
KEEP CHIP	CODIGO_LOCALIDAD	NOMBRE_BARRIO	CODIGO_BARRIO	CODIGO_MANZANA	CODIGO_PREDIO	CODIGO_CONSTRUCCION	CODIGO_RESTO	
AREA_TERRENO	AREA_CONSTRUIDA	ZHF_2020	VALOR_M2_CONSTRUCCION_2020	VALOR_AVALUO_COM_2020	MODELO_0	NOMBRE_MODELO_0	CODIGO_DESTINO	EDAD	
PUNTAJE	ACTUALIZADO	AVALUO_TOTAL_PUNTUAL_COM_2019	VALOR_INTEGRAL_COM_2019	VALOR_M2_CONS_COM_2019	AVALUO_TOTAL_PUNTUAL_COM_2019_C	VALOR_M2_CONS_COM_2019_C	variacion_com	variacion_vconst_com	variacion_com_CHIP	variacion_vconst_com_CHIP
VALOR_M2_TERRENO_COM_2019;
RUN;



PROC EXPORT DATA= CONSULTA_RURAL3
			outfile= "\\prowin02\dospina\SASFILES\Verificacion_Calculos_2020\EXPORT\RURAL_191203.xls" 
			dbms=xls replace;
			sheet="RURALES";
			RUN;



PROC SQL;
   CREATE TABLE t1 AS 
   SELECT t1.* 
         FROM comun.PREDIO_Y_UM_FINAL_191210/*VISTA_NUEVO_MODELO_A*/ t1
      WHERE t1.CHIP IN ('AAA0131YDPP');
QUIT;

PROC SQL;
   CREATE TABLE t1 AS 
   SELECT t1.* 
         FROM PRUEBA.PREDIO_2020_COMERCIAL_A/*VISTA_NUEVO_MODELO_A*/ t1
      WHERE t1.CHIP IN ('AAA0131YDPP');
QUIT;

DATA TX; SET T1; 
/*IF AREA_CONSTRUIDA = . THEN AREA_CONSTRUIDA =0;*/
VALOR_AVALUO_CAT=AREA_TERRENO*VALOR_M2_TERRENO_CAT_2020 + AREA_CONSTRUIDA*VALOR_M2_CONSTRUCCION_CAT_2020;
KEEP CHIP AREA_TERRENO VALOR_M2_TERRENO_CAT_2020 AREA_CONSTRUIDA VALOR_M2_CONSTRUCCION_CAT_2020 VALOR_AVALUO_CAT;
RUN;
 
DATA TX; SET COMUN.PREDIO_Y_UM_FINAL_&FECHA_CORTE.; 
IF VALOR_AVALUO_CAT=.;
/*IF AREA_CONSTRUIDA = . THEN AREA_CONSTRUIDA =0;*/
VALOR_AVALUO_CAT=AREA_TERRENO*VALOR_M2_TERRENO_CAT_2020 + AREA_CONSTRUIDA*VALOR_M2_CONSTRUCCION_CAT_2020;
KEEP CHIP actualizado CODIGO_BARRIO CODIGO_MANZANA CODIGO_PREDIO CODIGO_CONSTRUCCION CODIGO_RESTO VALOR_REFERENCIA_2020 MODELO_0 AREA_TERRENO VALOR_M2_TERRENO_CAT_2020 AREA_CONSTRUIDA VALOR_M2_CONSTRUCCION_CAT_2020 VALOR_AVALUO_CAT;
RUN;



data _null_;
  dur = datetime() - &_timer_start;
  put 30*'-' / ' TOTAL DURATION:' dur time13.2 / 30*'-';
run;